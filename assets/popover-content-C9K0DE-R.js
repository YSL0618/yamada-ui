import{r}from"./index-BwDkhjyp.js";import{j as O}from"./extends-CwFRzn3r.js";import{b as le}from"./index-B8YQiu_Q.js";import{u as ae,a as ce}from"./index-CFjuI6Rx.js";import{u as fe,a as me,b as pe}from"./index-CuMoPEvO.js";import{u as de}from"./index-B1LlGrRz.js";import{o as ve,a as H,h as l,z as ge,ae as L,W as _,c as Z,p as Pe,ah as Ce,b as he,X as ye}from"./factory-CYpx3TMG.js";import{a as be}from"./use-component-style-CfUS8Ki1.js";import{o as xe}from"./theme-provider-BZKkW4ID.js";import{C as Be}from"./close-button-CZR8M-ik.js";import{f as _e}from"./forward-ref-BWI-Phbn.js";import{s as S}from"./slide-fade-RjiVa2b9.js";import{s as Re}from"./scale-fade-1_0-ywnN.js";import{m as Te}from"./forward-ref-scR1bmHx.js";import{m as we}from"./factory-CY7vhjKt.js";const[Ee,U]=ve({strict:!1,name:"PopoverContext"}),$=m=>{const[c,s]=be("Popover",m),{children:R,initialFocusRef:g,restoreFocus:P=!0,autoFocus:T=!0,closeOnBlur:f=!0,closeOnEsc:M=!0,closeOnButton:w=!0,trigger:a="click",openDelay:b=200,closeDelay:x=200,isLazy:D,lazyBehavior:z="unmount",animation:A="scale",duration:X,relatedRef:C,...I}=xe(s),{isOpen:t,onOpen:h,onClose:i,onToggle:j}=ae(s),E=r.useRef(null),B=r.useRef(null),p=r.useRef(null),{present:K,onAnimationComplete:e}=le({isOpen:t,ref:p}),d=r.useRef(void 0),Y=r.useRef(void 0),F=r.useRef(!1),W=r.useRef(!1);t&&(W.current=!0);const{referenceRef:N,getPopperProps:te,forceUpdate:q,transformOrigin:G}=de({...I,enabled:t});r.useEffect(()=>()=>{d.current&&clearTimeout(d.current),Y.current&&clearTimeout(Y.current)},[]),fe({enabled:t,ref:B}),me(p,{focusRef:B,visible:t,shouldFocus:P&&(a==="click"||a==="contextmenu")}),pe(p,{focusRef:g,visible:t,shouldFocus:T&&(a==="click"||a==="contextmenu")});const J=ce({wasSelected:W.current,enabled:D,mode:z,isSelected:K}),ne=r.useCallback((o={},k=null)=>{const u={...o,style:{...o.style,transformOrigin:G},ref:H(p,k),children:J?o.children:null,tabIndex:-1,onKeyDown:l(o.onKeyDown,n=>{M&&n.key==="Escape"&&i()}),onBlur:l(o.onBlur,n=>{const v=L(n),y=_(p.current,v),ie=_(B.current,v),ue=C!=null&&C.current?_(C.current,v):!1;t&&f&&(!y&&!ie&&!ue)&&i()})};return a==="hover"&&(u.onMouseEnter=l(o.onMouseEnter,()=>{F.current=!0}),u.onMouseLeave=l(o.onMouseLeave,n=>{n.nativeEvent.relatedTarget!==null&&(F.current=!1,f&&setTimeout(i,x))})),u},[x,f,M,t,i,J,G,a,C]),Q=r.useCallback(o=>{E.current==null&&N(o)},[N]),re=r.useCallback((o={},k=null)=>{const u={...o,ref:H(B,k,Q)};return a==="click"&&(u.onClick=l(o.onClick,j),u.onBlur=l(o.onBlur,n=>{const v=L(n),y=!_(p.current,v);t&&f&&y&&i()})),a==="contextmenu"&&(u.onContextMenu=l(o.onContextMenu,n=>{n.preventDefault(),h()}),u.onBlur=l(o.onBlur,n=>{const v=L(n),y=!_(p.current,v);t&&f&&y&&i()})),a==="hover"&&(u.onFocus=l(o.onFocus,()=>{d.current===void 0&&h()}),u.onBlur=l(o.onBlur,n=>{const v=L(n),y=!_(p.current,v);t&&f&&y&&i()}),u.onKeyDown=l(o.onKeyDown,n=>{n.key==="Escape"&&i()}),u.onMouseEnter=l(o.onMouseEnter,()=>{F.current=!0,d.current=window.setTimeout(h,b)}),u.onMouseLeave=l(o.onMouseLeave,()=>{F.current=!1,d.current&&(clearTimeout(d.current),d.current=void 0),Y.current=window.setTimeout(()=>{F.current||i()},x)})),u},[x,f,t,Q,i,h,j,b,a]),se=r.useCallback((o={},k=null)=>({...o,ref:H(k,E,N)}),[E,N]);return O.jsx(Ee,{value:{isOpen:t,onClose:i,closeOnButton:w,onAnimationComplete:e,forceUpdate:q,getTriggerProps:re,getAnchorProps:se,getPopperProps:te,getPopoverProps:ne,animation:A,duration:X,styles:c},children:ge(R,{isOpen:t,onClose:i,forceUpdate:q})})};$.displayName="Popover";$.__ui__="Popover";const ee=({children:m})=>{const c=r.Children.only(m),{getTriggerProps:s}=U();return r.cloneElement(c,s(c.props,c.ref))};ee.displayName="PopoverTrigger";ee.__ui__="PopoverTrigger";const V=_e(({onClick:m,...c},s)=>{const{styles:R,onClose:g}=U(),P={position:"absolute",...R.closeButton};return O.jsx(Be,{ref:s,className:Z("ui-popover__close-button"),__css:P,onClick:l(m,T=>{T.stopPropagation(),g==null||g()}),size:"sm",...c})});V.displayName="PopoverCloseButton";V.__ui__="PopoverCloseButton";const Fe=(m="scale",c)=>{const s={reverse:!0,duration:c,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(m){case"scale":return{...Re,custom:{...s,scale:.95}};case"top":return{...S,custom:{...s,offsetX:0,offsetY:-16}};case"right":return{...S,custom:{...s,offsetX:16,offsetY:0}};case"left":return{...S,custom:{...s,offsetX:-16,offsetY:0}};case"bottom":return{...S,custom:{...s,offsetX:0,offsetY:16}}}},oe=Te(({as:m="section",className:c,containerProps:s,children:R,w:g,width:P,minW:T,minWidth:f,maxW:M,maxWidth:w,z:a,zIndex:b,__css:x,...D},z)=>{const{isOpen:A,closeOnButton:X,getPopperProps:C,getPopoverProps:I,onAnimationComplete:t,animation:h,duration:i,styles:j}=U(),E=Pe(R),[B,...p]=Ce(E,V),K=r.useMemo(()=>we(m),[m]),e=x??j.container??{},d={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...e};return P??(P=g),P??(P=(e==null?void 0:e.width)??(e==null?void 0:e.w)),f??(f=T),f??(f=(e==null?void 0:e.minWidth)??(e==null?void 0:e.minW)),w??(w=M),w??(w=(e==null?void 0:e.maxWidth)??(e==null?void 0:e.maxW)),b??(b=a),b??(b=(e==null?void 0:e.zIndex)??(e==null?void 0:e.z)),O.jsx(he.div,{...C({style:{visibility:A?"visible":"hidden"}}),className:"ui-popover",outline:"none",width:P,minWidth:f,maxWidth:w,zIndex:b,...s,children:O.jsxs(K,{className:Z("ui-popover__content",c),...h!=="none"?Fe(h,i):{},...I(D,z),initial:"exit",animate:A?"enter":"exit",exit:"exit",onAnimationComplete:ye(t,D.onAnimationComplete),__css:d,children:[B??(X?O.jsx(V,{}):null),p]})})});oe.displayName="PopoverContent";oe.__ui__="PopoverContent";export{$ as P,ee as a,oe as b,V as c,U as u};
