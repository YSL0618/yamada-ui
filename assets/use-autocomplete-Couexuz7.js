import{j as f}from"./extends-CwFRzn3r.js";import{f as ie}from"./forward-ref-BWI-Phbn.js";import{o as Bt,p as yt,b as D,c as Z,j as Ht,A as Qe,a1 as zt,g as Gt,f as xe,a as Le,t as Jt,d as Ce,h as J,aP as Ut,F as Y,z as bt,V as vt,a6 as At,W as Kt,af as $t,X as Wt,S as Yt,Y as Me}from"./factory-uBtAHRUq.js";import{r as t}from"./index-BwDkhjyp.js";import{b as Xt}from"./popover-trigger-CiVhXs2R.js";import{u as qt}from"./index-B_fkAghs.js";import{u as Qt}from"./index-CdVvibsY.js";import{u as Zt}from"./index-B1JaSA3I.js";import{c as es}from"./index-DSunIB56.js";import{u as ts}from"./index-CMM3kl6L.js";import{c as ss,a as os}from"./icon-fUKD81HD.js";import{u as ns,f as ls}from"./form-control-k6ikkRb0.js";const{DescendantsContextProvider:js,useDescendant:is,useDescendants:as,useDescendantsContext:Ze}=es(),[Es,F]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),et=ie(({className:l,children:i,__css:n,...s},c)=>{const{styles:r}=F(),m={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...r.icon,...n},_=yt(i).map(v=>t.cloneElement(v,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return f.jsx(D.div,{ref:c,className:Z("ui-autocomplete__icon",l),__css:m,...s,children:Ht(i)?_:f.jsx(ss,{})})});et.displayName="AutocompleteIcon";et.__ui__="AutocompleteIcon";const It=({className:l,children:i,...n})=>{const s=t.useRef(null),{styles:c}=F(),r=n.disabled,m=ts({ref:s,isDisabled:r,...n});return f.jsx(et,{className:Z("ui-autocomplete__icon--clear",l),"aria-label":"Clear value",__css:c.clearIcon,...m,children:i??f.jsx(os,{h:"0.5em",w:"0.5em"})})};It.displayName="AutocompleteClearIcon";It.__ui__="AutocompleteClearIcon";const Ae=ie(({className:l,...i},n)=>{const{styles:s}=F(),c={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...s.itemIcon};return f.jsx(D.span,{ref:n,className:Z("ui-autocomplete__item__icon",l),__css:c,...i})});Ae.displayName="AutocompleteItemIcon";Ae.__ui__="AutocompleteItemIcon";const cs=l=>{var i;return Ut(l)&&!!((i=l.getAttribute("role"))!=null&&i.startsWith("option"))},rs=l=>{var ke;const{closeOnSelect:i,focusedIndex:n,inputRef:s,omitSelectedValues:c,setFocusedIndex:r,value:m,optionProps:p,onChange:_,onChangeLabel:v,onClose:y,onFocusNext:O}=F(),j=t.useId();let{children:C,closeOnSelect:R,icon:A,isDisabled:x,isFocusable:E,value:I,...L}={...p,...l};const ae=!!x&&!E,B=t.useRef(null),{descendants:Ie,index:X,register:ce}=is({disabled:ae}),Se=Ie.values().slice(0,X),P=Y(m);Qe(I)&&(zt(C)||Gt(C)?I=C.toString():console.warn(`${P?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`));const q=!(P?!1:Se.some(({node:U})=>U.dataset.value===(I??"")))&&(P?m.includes(I??""):(I??"")===m),ge="target"in(((ke=B.current)==null?void 0:ke.dataset)??{}),re=X===n,he=t.useCallback(U=>{if(U.stopPropagation(),x){s.current&&s.current.focus();return}if(!cs(U.currentTarget)){s.current&&s.current.focus();return}r(X),_(I??""),s.current&&s.current.focus(),(R??i)&&y(),c&&O(X)},[O,c,x,I,r,X,_,R,i,y,s]);xe(()=>{q&&v(I??"",{runOmit:!1})},[I]);const ze=t.useCallback((U={},Ge=null)=>{const ue={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{id:j,ref:Le(B,Ge,ce),role:"option",...L,...U,style:!ge||c&&q?ue:void 0,"aria-checked":q,"aria-disabled":Jt(x),"data-disabled":Ce(x),"data-focus":Ce(re),"data-target":Ce(!0),"data-value":I??"",tabIndex:-1,onClick:J(L.onClick,U.onClick,he)}},[j,I,L,x,re,q,ge,c,he,ce]);return{children:C,customIcon:A,isFocused:re,isSelected:q,getOptionProps:ze}},us=()=>{const{isHit:l,onCreate:i}=F();return{getCreateProps:t.useCallback((s={},c=null)=>({ref:c,...s,style:l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"data-focus":Ce(!l),tabIndex:-1,onClick:J(s.onClick,i)}),[l,i])}},ds=()=>{const{isEmpty:l,isHit:i}=F();return{getEmptyProps:t.useCallback((s={},c=null)=>({ref:c,...s,style:i&&!l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,tabIndex:-1}),[i,l])}},St=ie(({className:l,children:i,icon:n,...s},c)=>{const{inputValue:r,styles:m}=F(),{getCreateProps:p}=us();i??(i=r);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...m.item};return f.jsxs(D.li,{className:Z("ui-autocomplete__item--create",l),__css:_,...p(s,c),children:[n!==null?f.jsx(Ae,{children:n||f.jsx(tt,{})}):null,n?f.jsx(D.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:bt(i,r)}):bt(i,r)]})});St.displayName="AutocompleteCreate";St.__ui__="AutocompleteCreate";const tt=()=>f.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:f.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});tt.displayName="AutocompletePlusIcon";tt.__ui__="AutocompletePlusIcon";const kt=ie(({className:l,children:i,icon:n,...s},c)=>{const{emptyMessage:r,styles:m}=F(),{getEmptyProps:p}=ds();i??(i=r);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...m.item};return f.jsxs(D.li,{className:Z("ui-autocomplete__item--empty",l),__css:_,...p(s,c),children:[n!==null?f.jsx(Ae,{children:n||f.jsx(st,{})}):null,n?f.jsx(D.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:i}):i]})});kt.displayName="AutocompleteEmpty";kt.__ui__="AutocompleteEmpty";const st=()=>f.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:f.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});st.displayName="AutocompleteMinusIcon";st.__ui__="AutocompleteMinusIcon";const ps=()=>{const l=t.useId(),{focusedIndex:i,isOpen:n,listRef:s,rebirthOptions:c}=F(),r=Ze(),m=t.useRef(-1),p=r.value(i),_=t.useCallback(()=>{n||c(!1)},[n,c]);return t.useEffect(()=>{if(!s.current||!p||m.current===p.index)return;const y=s.current,O=p.node,j=y.clientHeight,C=y.scrollTop,R=C+j,A=O.clientHeight,x=O.offsetTop,E=x+A,I=C<=x&&E<=R,L=m.current<p.index;I||(E<=j?s.current.scrollTo({top:0}):L?s.current.scrollTo({top:E-j}):s.current.scrollTo({top:x+1})),m.current=p.index},[s,p]),xe(()=>{n||(m.current=-1)},[n]),{getListProps:t.useCallback((y={},O=null)=>({id:y.id??l,ref:Le(s,O),as:"ul",position:"relative",role:"listbox",tabIndex:-1,...y}),[s,l]),onAnimationComplete:_}},Ot=ie(({className:l,children:i,footer:n,header:s,maxW:c,maxWidth:r,minW:m,minWidth:p,w:_,width:v,contentProps:y,...O},j)=>{var x,E,I,L,ae,B;const{styles:C}=F(),{getListProps:R,onAnimationComplete:A}=ps();return v??(v=_),v??(v=((x=C.list)==null?void 0:x.width)??((E=C.list)==null?void 0:E.w)),p??(p=m),p??(p=((I=C.list)==null?void 0:I.minWidth)??((L=C.list)==null?void 0:L.minW)),r??(r=c),r??(r=((ae=C.list)==null?void 0:ae.maxWidth)??((B=C.list)==null?void 0:B.maxW)),f.jsxs(Xt,{as:"div",className:"ui-autocomplete__popover",maxWidth:r,minWidth:p,width:v,__css:{...C.content,maxWidth:r,minWidth:p,width:v},...y,onAnimationComplete:J(y==null?void 0:y.onAnimationComplete,A),children:[s?f.jsx(D.div,{className:"ui-autocomplete__header",__css:{...C.header},children:s}):null,f.jsx(D.ul,{className:Z("ui-autocomplete__list",l),__css:{...C.list},...R(O,j),children:i}),n?f.jsx(D.div,{className:"ui-autocomplete__footer",__css:{...C.footer},children:n}):null]})});Ot.displayName="AutocompleteList";Ot.__ui__="AutocompleteList";const Te=ie(({className:l,icon:i,...n},s)=>{const{styles:c}=F(),{children:r,customIcon:m,isSelected:p,getOptionProps:_}=rs(n);i??(i=m);const v={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...c.item};return f.jsxs(D.li,{className:Z("ui-autocomplete__item",l),__css:v,..._({},s),children:[i!==null?f.jsx(Ae,{opacity:p?1:0,children:i||f.jsx(ot,{})}):null,f.jsx(D.span,{style:{flex:1},"data-label":!0,children:r})]})});Te.displayName="AutocompleteOption";Te.__ui__="AutocompleteOption";const ot=()=>f.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:f.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});ot.displayName="AutocompleteCheckIcon";ot.__ui__="AutocompleteCheckIcon";const ms=({label:l,...i})=>{const{omitSelectedValues:n,value:s}=F(),c=Y(s),r=Ze(),m=r.values(),_=(c&&n?r.values(({node:A})=>s.includes(A.dataset.value??"")):[]).map(({index:A})=>A),y=!m.filter(({index:A,node:x})=>{var E;return((E=x.parentElement)==null?void 0:E.dataset.label)===l&&!_.includes(A)&&"target"in x.dataset}).length,[O,j]=vt(i,At),C=t.useCallback((A={},x=null)=>({ref:x,...A,...O,style:y?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"data-label":l,role:"autocomplete-group-container"}),[O,y,l]),R=t.useCallback((A={},x=null)=>({ref:x,...A,...j,"data-label":l,role:"autocomplete-group"}),[j,l]);return{label:l,getContainerProps:C,getGroupProps:R}},nt=ie(({className:l,children:i,color:n,h:s,height:c,minH:r,minHeight:m,labelProps:p,..._},v)=>{const{styles:y}=F(),{label:O,getContainerProps:j,getGroupProps:C}=ms(_);return s??(s=c),r??(r=m),f.jsxs(D.li,{className:Z("ui-autocomplete__item","ui-autocomplete__item--group",l),__css:{color:n,h:"fit-content",w:"100%"},...j(),children:[f.jsx(D.span,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:y.groupLabel,...p,children:O}),f.jsx(D.ul,{...C({},v),className:"ui-autocomplete__item__group",__css:{h:s,minH:r,...y.group},children:i})]})});nt.displayName="AutocompleteOptionGroup";nt.__ui__="AutocompleteOptionGroup";const _t={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},fs=l=>{l=l.replace(/[！-～]/g,n=>String.fromCharCode(n.charCodeAt(0)-65248));const i=new RegExp("("+Object.keys(_t).join("|")+")","g");return l=l.replace(i,n=>_t[n]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),l=l.toUpperCase(),l},xs=l=>{const i=n=>n.map(s=>{const{isDisabled:c,isFocusable:r}=s;if(!(c&&!r))return"items"in s?i(s.items??[]):s}).filter(Boolean);return i(l).flat(1/0)},Ns=l=>{const{allowCreate:i=!1,allowFree:n=!1,animation:s,boundary:c,children:r,closeDelay:m,closeOnBlur:p=!0,closeOnEsc:_=!0,closeOnSelect:v=!0,defaultIsOpen:y,defaultValue:O,duration:j=.2,emptyMessage:C="No results found",eventListeners:R,flip:A,format:x=fs,gutter:E,insertPositionItem:I="first",isLazy:L,isOpen:ae,items:B,lazyBehavior:Ie,matchWidth:X=!0,maxSelectValues:ce,modifiers:Be,offset:Se,omitSelectedValues:P=!1,openDelay:He,placeholder:q,placement:ge="bottom-start",preventOverflow:re,strategy:he,value:ze,optionProps:ke,onChange:U,onClose:Ge,onCreate:ue,onKeyDown:lt,onOpen:Pt,onSearch:Oe,...de}=ns(l),{"aria-readonly":Cs,onFocus:it,...H}=Kt(de,ls),[at,wt]=vt(de,At),{id:jt}=de,b=as(),Je=t.useRef(null),ct=t.useRef(null),ee=t.useRef(null),te=t.useRef(new Set([])),Ue=t.useRef(!1),Pe=t.useRef(void 0),[se,rt]=t.useState(B?JSON.parse(JSON.stringify(B)):void 0),[k,we]=qt({defaultValue:O,value:ze,onChange:U}),[Ke,je]=t.useState(void 0),[N,pe]=t.useState(""),[K,w]=t.useState(-1),[oe,ut]=t.useState(!1),[me,dt]=t.useState(!0),{isOpen:g,onClose:M,onOpen:pt}=Qt({defaultIsOpen:y,isOpen:ae,onClose:Ge,onOpen:Pt}),be=K>-1,$e=K===-2&&i,h=Y(k),Ee=h?!k.length:!k,[_e,mt]=t.useMemo(()=>Y(I)?I:[I,"first"],[I]);i&&!Qe(r)&&console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: ${h?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const $=b.enabledValues(({node:e})=>h&&k.includes(e.dataset.value??"")).map(({index:e})=>e),G=b.enabledValues(({index:e,node:o})=>"target"in o.dataset&&!$.includes(e)),Et=yt(r),Ne=t.useMemo(()=>se==null?void 0:se.map((e,o)=>{if("value"in e){const{label:a,value:u,...d}=e;return f.jsx(Te,{value:u,...d,children:a},o)}else if("items"in e){const{items:a=[],label:u,...d}=e;return f.jsx(nt,{label:u,...d,children:a.map(({label:S,value:z,...le},Lt)=>f.jsx(Te,{value:z,...le,children:S},Lt))},o)}}),[se]),ne=!Et.length&&!(Ne!=null&&Ne.length),V=t.useCallback(()=>{H.disabled||H.readOnly||!i&&(ne||oe)||(pt(),ee.current&&ee.current.focus())},[i,H,oe,ne,pt]),fe=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const o=b.enabledFirstValue(({node:a})=>"target"in a.dataset);if(o)if(!h||!P)w(o.index);else if($.includes(o.index)){const a=G[0];w((a==null?void 0:a.index)??-1)}else w(o.index)});te.current.add(e)},[b,G,oe,ne,h,P,$]),Ve=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const o=b.enabledLastValue(({node:a})=>"target"in a.dataset);if(o)if(!h||!P)w(o.index);else if($.includes(o.index)){const a=G.reverse()[0];w((a==null?void 0:a.index)??-1)}else w(o.index)});te.current.add(e)},[b,G,oe,ne,h,P,$]),We=t.useCallback(()=>{const e=setTimeout(()=>{const a=b.enabledValues().find(({node:u})=>h?k.includes(u.dataset.value??""):u.dataset.value===k);a&&w(a.index)});te.current.add(e)},[b,h,k]),ye=t.useCallback((e=K)=>{const o=setTimeout(()=>{const a=b.enabledNextValue(e,({node:u})=>"target"in u.dataset);if(a)if(!h||!P)w(a.index);else if($.includes(a.index)){const u=G.find(({index:d})=>a.index<d)??G[0];w((u==null?void 0:u.index)??-1)}else w(a.index)});te.current.add(o)},[b,G,K,h,P,$]),Ye=t.useCallback((e=K)=>{const o=setTimeout(()=>{const a=b.enabledPrevValue(e,({node:u})=>"target"in u.dataset);if(a)if(!h||!P)w(a.index);else if($.includes(a.index)){const u=G.reverse().find(({index:d})=>d<a.index)??G[0];w((u==null?void 0:u.index)??-1)}else w(a.index)});te.current.add(o)},[b,G,K,h,P,$]),Q=Ee||P?fe:We,ft=Ee||P?Ve:We,Xe=t.useCallback(e=>{const o=b.values();let a=!1,u=!1;o.forEach(({index:d,node:S})=>{if(x(S.textContent??"").includes(e)){a=!0;const z="disabled"in S.dataset;S.dataset.target="",!u&&!z&&(u=!0,w(d))}else delete S.dataset.target}),dt(a)},[b,x]),W=t.useCallback((e=!0)=>{b.values().forEach(({node:a})=>{a.dataset.target=""}),e&&fe(),dt(!0)},[b,fe]),De=t.useCallback(e=>{const o=b.enabledValues();return(Y(e)?e:[e]).map(d=>{const{node:S}=o.find(({node:z})=>z.dataset.value===d)??{};if(S){const z=Array.from(S.children).find(le=>le.getAttribute("data-label")!==null);return(z==null?void 0:z.textContent)??void 0}else return n?d:void 0}).filter(Boolean)},[n,b]),ve=t.useCallback((e,{forceUpdate:o,runOmit:a=!0}={})=>{const u=De(e);!o&&!u.length||je(d=>h?(u.forEach(S=>{Y(d)&&d.includes(S)?a&&(d=Y(d)?d.filter(le=>le!==S):void 0):d=[...Y(d)?d:[],S]}),d):u[0])},[De,h]),T=t.useCallback((e,{forceUpdate:o,runRebirth:a=!0}={})=>{we(d=>{let S;return Y(d)?d.includes(e)?S=d.filter(le=>le!==e):S=[...d,e]:S=e,Pe.current=S,S});const u=b.values().filter(({node:d})=>x(d.textContent??"").includes(e)).length>0;ve(e,{forceUpdate:o}),(n||u)&&pe(""),h&&a&&W(!1)},[n,h,ve,W,we,b,x]),qe=t.useCallback(()=>{let e=b.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const o=e.node.dataset.value??"";T(o),v&&M(),P&&ye()},[v,b,K,P,T,M,ye]),Nt=t.useCallback(e=>{g||V(),Oe==null||Oe(e);const o=e.target.value,a=x(o);a?Xe(a):W(),pe(o)},[g,V,x,Oe,Xe,W]),Vt=t.useCallback(()=>{Ue.current=!0},[]),Dt=t.useCallback(()=>{Ue.current=!1},[]),Fe=t.useCallback(()=>{if(!ct.current)return;const e={label:N,value:N};let o=[];if(se&&(o=[...se]),_e==="first")o=[e,...o];else if(_e==="last")o=[...o,e];else{const u=o.findIndex(({label:S})=>S===_e),d=o[u];u!==-1&&d&&"items"in d?(mt==="first"?d.items=[e,...d.items??[]]:d.items=[...d.items??[],e],o[u]=d):console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: '${_e}' specified in insertPositionItem does not exist in the option group.`)}rt(o),T(N),W(!1);const a=xs(o).findIndex(({value:u})=>u===N);w(a),ue==null||ue(e,o)},[N,se,_e,T,W,ue,mt,h]),xt=t.useCallback(()=>{g?ee.current&&ee.current.focus():(V(),Q())},[g,Q,V]),Re=t.useCallback(()=>{g||(V(),Q())},[g,Q,V]),Ct=t.useCallback(e=>{const o=$t(e);Wt(Je.current,o)||!p&&me||(n&&N&&T(N,{runRebirth:!1}),pe(""),g&&M())},[p,me,g,N,n,M,T]),gt=t.useCallback(()=>{h?T(k[k.length-1]):T("",{forceUpdate:!0}),g||Re()},[h,g,T,Re,k]),Ft=t.useCallback(e=>{e.stopPropagation(),Pe.current=[],we([]),je(void 0),pe(""),W(),g&&ee.current&&ee.current.focus()},[g,je,pe,we,W]),ht=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),H.disabled||H.readOnly||Ue.current)return;const o=Ke===N||!N.length,u={ArrowDown:be?()=>ye():g?void 0:Me(V,Q),ArrowUp:be?()=>Ye():g?void 0:Me(V,ft),Backspace:!Ee&&o?gt:void 0,End:g?Ve:void 0,Enter:$e?Fe:be?qe:g?n&&h?()=>{N&&T(N),w(0)}:void 0:Me(V,Q),Escape:_?M:void 0,Home:g?fe:void 0,Space:$e?Fe:be?qe:g?void 0:Me(V,Q)}[e.key];u&&(e.preventDefault(),e.stopPropagation(),u(e))},[n,H,Ke,N,V,be,h,Q,ye,ft,Ye,$e,Fe,qe,g,fe,Ve,_,M,Ee,gt,T]);t.useEffect(()=>{if(!h||!P&&Qe(ce))return;const e=k.length>0&&k.length===b.count(),o=k.length===ce;e||o?(M(),ut(!0)):ut(!1)},[P,k,b,h,M,ce]),t.useEffect(()=>{if(h){if(JSON.stringify(Pe.current??[])===JSON.stringify(k))return;const e=De(k);je(e)}else{if(Pe.current===k)return;ve(k,{runOmit:!1})}},[h,k,ve,De]),xe(()=>{g||n||(w(-1),pe(""))},[g]),xe(()=>{me||w(-2)},[me]),xe(()=>{rt(B?JSON.parse(JSON.stringify(B)):void 0)},[B]),Yt(()=>{te.current.forEach(e=>clearTimeout(e)),te.current.clear()}),Zt({ref:Je,enabled:g&&(p||!me),handler:M});const Rt=t.useCallback(e=>({animation:s,boundary:c,closeDelay:m,closeOnBlur:p,duration:j,eventListeners:R,flip:A,gutter:E,isLazy:L,lazyBehavior:Ie,matchWidth:X,modifiers:Be,offset:Se,openDelay:He,placement:ge,preventOverflow:re,strategy:he,...e,closeOnButton:!1,isOpen:g,trigger:"never",onClose:M,onOpen:V}),[p,He,m,L,Ie,s,j,Se,E,re,A,X,c,R,he,ge,Be,g,V,M]),Mt=t.useCallback((e={},o=null)=>({ref:Le(Je,o),...at,...e,...H,onBlur:J(e.onBlur,de.onBlur,Ct),onClick:J(e.onClick,de.onClick,xt)}),[at,H,Ct,xt,de]),Tt=t.useCallback((e={},o=null)=>({ref:o,tabIndex:-1,...e,...H,"aria-expanded":Ce(g),"data-active":Ce(g),placeholder:q,onFocus:J(e.onFocus,it,Re),onKeyDown:J(e.onKeyDown,lt,ht)}),[H,q,g,it,Re,lt,ht]);return{id:jt,allowCreate:i,allowFree:n,closeOnSelect:v,computedChildren:Ne,descendants:b,emptyMessage:C,focusedIndex:K,inputRef:ee,inputValue:N,isAllSelected:oe,isEmpty:ne,isHit:me,isOpen:g,label:Ke,listRef:ct,omitSelectedValues:P,pickOptions:Xe,rebirthOptions:W,setFocusedIndex:w,value:k,formControlProps:H,getContainerProps:Mt,getFieldProps:Tt,getPopoverProps:Rt,inputProps:wt,optionProps:ke,onChange:T,onChangeLabel:ve,onClear:Ft,onClose:M,onCompositionEnd:Dt,onCompositionStart:Vt,onCreate:Fe,onFocusFirst:fe,onFocusLast:Ve,onFocusNext:ye,onFocusPrev:Ye,onFocusSelected:We,onOpen:V,onSearch:Nt}},Vs=()=>{const{id:l,focusedIndex:i,inputRef:n,isAllSelected:s,isOpen:c,listRef:r,formControlProps:m,inputProps:p,onCompositionEnd:_,onCompositionStart:v,onSearch:y}=F(),{value:O}=Ze();return xe(()=>{s&&n.current&&n.current.blur()},[s]),{getInputProps:t.useCallback((C={},R=null)=>{var A,x;return{ref:Le(n,R),...m,"aria-activedescendant":(A=O(i))==null?void 0:A.node.id,"aria-autocomplete":"list","aria-controls":(x=r.current)==null?void 0:x.id,"aria-expanded":c,"aria-haspopup":"listbox",autoCapitalize:"none",autoComplete:"off",role:"combobox",spellCheck:"false",...p,...C,id:l,cursor:m.readOnly?"default":"text",pointerEvents:m.disabled||s?"none":"auto",tabIndex:s?-1:0,onChange:J(C.onChange,y),onCompositionEnd:J(C.onCompositionEnd,p.onCompositionEnd,_),onCompositionStart:J(C.onCompositionStart,p.onCompositionStart,v)}},[r,i,c,p,n,m,l,s,O,y,v,_])}};export{js as A,Es as a,et as b,Ot as c,St as d,kt as e,F as f,Vs as g,Te as h,nt as i,It as j,Ns as u};
