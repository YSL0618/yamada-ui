import{j as m}from"./jsx-runtime-CfatFE5O.js";import{f as ce}from"./forward-ref-D13m8o2p.js";import{p as Bt,a as R,c as Z,q as _t,j as Ht,J as ae,E as Me,a4 as zt,g as Gt,aq as $t,h as $,d as Ce,w as ye,b as Ae,C as ht,f as ve,Y as vt,a9 as yt,Z as Jt,am as Kt,_ as Ut,$ as Re,u as qt,X as Yt}from"./factory-BPYpkDor.js";import{r as t}from"./index-ClcD9ViR.js";import{b as Wt}from"./popover-trigger-BK228ndd.js";import{u as Xt}from"./index-5_K1p_ZM.js";import{u as Zt}from"./index-CZjm_Dlq.js";import{u as Qt}from"./index-B6_HQi_x.js";import{c as es}from"./index-LBOEXu_2.js";import{u as ts}from"./index-B-CNuTHF.js";import{c as ss,a as os}from"./icon-DT11Nal8.js";import{c as ns,f as ls}from"./form-control-BcwAaE7G.js";const{DescendantsContextProvider:js,useDescendant:is,useDescendants:as,useDescendantsContext:Ze}=es(),[Es,M]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),Qe=ce(({className:l,children:o,__css:s,...i},u)=>{const{styles:c}=M(),d={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...c.icon,...s},x=_t(o).map(_=>t.cloneElement(_,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return m.jsx(R.div,{ref:u,className:Z("ui-autocomplete__icon",l),__css:d,...i,children:Ht(o)?x:m.jsx(ss,{})})});Qe.displayName="AutocompleteIcon";Qe.__ui__="AutocompleteIcon";const At=({className:l,children:o,...s})=>{const i=t.useRef(null),{styles:u}=M(),c=s.disabled,d=ts({ref:i,isDisabled:c,...s});return m.jsx(Qe,{className:Z("ui-autocomplete__icon--clear",l),"aria-label":"Clear value",__css:u.clearIcon,...d,children:o??m.jsx(os,{h:"0.5em",w:"0.5em"})})};At.displayName="AutocompleteClearIcon";At.__ui__="AutocompleteClearIcon";const Ie=ce(({className:l,...o},s)=>{const{styles:i}=M(),u={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...i.itemIcon};return m.jsx(R.span,{ref:s,className:Z("ui-autocomplete__item__icon",l),__css:u,...o})});Ie.displayName="AutocompleteItemIcon";Ie.__ui__="AutocompleteItemIcon";const cs=l=>{var o;return $t(l)&&!!((o=l.getAttribute("role"))!=null&&o.startsWith("option"))},rs=l=>{var Pe;const{closeOnSelect:o,focusedIndex:s,inputRef:i,omitSelectedValues:u,setFocusedIndex:c,value:d,optionProps:p,onChange:x,onClose:_,onFocusNext:S}=M(),z=t.useId(),k=t.useRef(null);let{id:f,children:A,closeOnSelect:D,icon:E,isDisabled:I,isFocusable:g,value:C,...w}={...p,...l};const N=!!I&&!g,{descendants:ke,index:Y,register:re}=is({disabled:N}),Se=ke.values().slice(0,Y),O=ae(d),W=Se.some(({node:J})=>J.dataset.value===(C??"")),Q=!W&&(O?d.includes(C??""):(C??"")===d),ue="target"in(((Pe=k.current)==null?void 0:Pe.dataset)??{}),de=Y===s;f??(f=z),Me(C)&&(zt(A)||Gt(A)?C=A.toString():console.warn(`${O?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`));const ge=t.useCallback(J=>{if(J.stopPropagation(),I||!cs(J.currentTarget)){i.current&&i.current.focus();return}W||c(Y),x(C??""),i.current&&i.current.focus(),(D??o)&&_(),u&&S(Y)},[W,S,u,I,C,c,Y,x,D,o,_,i]),Be=t.useCallback((J={},He=null)=>{const ee=!ue||u&&Q,Oe={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:Ae(k,He,re),role:"option",...w,...J,id:f,style:ee?Oe:void 0,"aria-disabled":ye(I),"aria-hidden":ye(ee),"aria-selected":Q,"data-disabled":Ce(I),"data-duplicated":Ce(W),"data-focus":Ce(de),"data-target":Ce(!0),"data-value":C??"",tabIndex:-1,onClick:$(w.onClick,J.onClick,ge)}},[f,W,C,w,I,de,Q,ue,u,ge,re]);return{children:A,customIcon:E,isFocused:de,isSelected:Q,isTarget:ue,omitSelectedValues:u,getOptionProps:Be}},us=()=>{const{isHit:l,onCreate:o}=M();return{getCreateProps:t.useCallback((i={},u=null)=>({ref:u,role:"option",...i,style:l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":ye(l),"data-focus":Ce(!l),tabIndex:-1,onClick:$(i.onClick,o)}),[l,o])}},ds=()=>{const{isEmpty:l,isHit:o}=M();return{getEmptyProps:t.useCallback((i={},u=null)=>{const c=o&&!l;return{ref:u,role:"presentation",...i,style:c?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":ye(c),tabIndex:-1}},[o,l])}},It=ce(({className:l,children:o,icon:s,...i},u)=>{const{inputValue:c,styles:d}=M(),{getCreateProps:p}=us();o??(o=c);const x={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return m.jsxs(R.div,{className:Z("ui-autocomplete__item--create",l),__css:x,...p(i,u),children:[s!==null?m.jsx(Ie,{children:s||m.jsx(et,{})}):null,s?m.jsx(R.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:ht(o,c)}):ht(o,c)]})});It.displayName="AutocompleteCreate";It.__ui__="AutocompleteCreate";const et=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:m.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});et.displayName="AutocompletePlusIcon";et.__ui__="AutocompletePlusIcon";const kt=ce(({className:l,children:o,icon:s,...i},u)=>{const{emptyMessage:c,styles:d}=M(),{getEmptyProps:p}=ds();o??(o=c);const x={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return m.jsxs(R.div,{className:Z("ui-autocomplete__item--empty",l),__css:x,...p(i,u),children:[s!==null?m.jsx(Ie,{children:s||m.jsx(tt,{})}):null,s?m.jsx(R.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:o}):o]})});kt.displayName="AutocompleteEmpty";kt.__ui__="AutocompleteEmpty";const tt=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:m.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});tt.displayName="AutocompleteMinusIcon";tt.__ui__="AutocompleteMinusIcon";const ps=()=>{const{focusedIndex:l,isOpen:o,listRef:s,rebirthOptions:i,value:u}=M(),c=Ze(),d=t.useId(),p=t.useRef(-1),x=c.value(l),_=ae(u),S=t.useCallback(()=>{o||i(!1)},[o,i]);return t.useEffect(()=>{if(!s.current||!x||p.current===x.index)return;const k=s.current,f=x.node,A=k.clientHeight,D=k.scrollTop,E=D+A,I=f.clientHeight,g=f.offsetTop,C=g+I,w=D<=g&&C<=E,N=p.current<x.index;w||(C<=A?s.current.scrollTo({top:0}):N?s.current.scrollTo({top:C-A}):s.current.scrollTo({top:g+1})),p.current=x.index},[s,x]),ve(()=>{o||(p.current=-1)},[o]),{getListProps:t.useCallback(({id:k,...f}={},A=null)=>({id:k??d,ref:Ae(s,A),"aria-multiselectable":ye(_),position:"relative",role:"listbox",tabIndex:-1,...f}),[s,d,_]),onAnimationComplete:S}},St=ce(({className:l,children:o,footer:s,header:i,maxW:u,maxWidth:c,minW:d,minWidth:p,w:x,width:_,contentProps:S,...z},k)=>{var E,I,g,C,w,N;const{styles:f}=M(),{getListProps:A,onAnimationComplete:D}=ps();return _??(_=x),_??(_=((E=f.list)==null?void 0:E.width)??((I=f.list)==null?void 0:I.w)),p??(p=d),p??(p=((g=f.list)==null?void 0:g.minWidth)??((C=f.list)==null?void 0:C.minW)),c??(c=u),c??(c=((w=f.list)==null?void 0:w.maxWidth)??((N=f.list)==null?void 0:N.maxW)),m.jsxs(Wt,{className:"ui-autocomplete__popover",maxWidth:c,minWidth:p,width:_,__css:{...f.content,maxWidth:c,minWidth:p,width:_},...S,onAnimationComplete:$(S==null?void 0:S.onAnimationComplete,D),children:[i?m.jsx(R.header,{className:"ui-autocomplete__header",__css:{...f.header},children:i}):null,m.jsx(R.div,{className:Z("ui-autocomplete__list",l),__css:{...f.list},...A(z,k),children:o}),s?m.jsx(R.footer,{className:"ui-autocomplete__footer",__css:{...f.footer},children:s}):null]})});St.displayName="AutocompleteList";St.__ui__="AutocompleteList";const Le=ce(({className:l,icon:o,...s},i)=>{const{styles:u}=M(),{children:c,customIcon:d,isSelected:p,getOptionProps:x}=rs(s);o??(o=d);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...u.item};return m.jsxs(R.div,{className:Z("ui-autocomplete__item",l),__css:_,...x({},i),children:[o!==null?m.jsx(Ie,{opacity:p?1:0,children:o||m.jsx(st,{})}):null,m.jsx(R.span,{style:{flex:1},"data-label":!0,children:c})]})});Le.displayName="AutocompleteOption";Le.__ui__="AutocompleteOption";const st=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:m.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});st.displayName="AutocompleteCheckIcon";st.__ui__="AutocompleteCheckIcon";const ms=({label:l,...o})=>{const{omitSelectedValues:s,value:i}=M(),u=Ze(),c=t.useRef(null),d=t.useId(),p=u.values(),S=(ae(i)&&s?u.values(({node:g})=>i.includes(g.dataset.value??"")):[]).map(({index:g})=>g),k=!p.filter(({index:g,node:C})=>{var w;return((w=C.parentElement)==null?void 0:w.dataset.label)===l&&!S.includes(g)&&"target"in C.dataset}).length,[f,A]=vt(o,yt),D=t.useCallback((g={},C=null)=>{var N;const w={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:C,"aria-labelledby":(N=c.current)==null?void 0:N.id,role:"group",...g,...f,style:k?w:void 0}},[f,k]),E=t.useCallback(({id:g,...C}={},w=null)=>({id:g??d,ref:Ae(w,c),role:"presentation",...C}),[d]),I=t.useCallback((g={},C=null)=>({ref:C,...g,...A,"data-label":l}),[A,l]);return{label:l,getContainerProps:D,getGroupProps:I,getLabelProps:E}},ot=ce(({className:l,children:o,color:s,h:i,height:u,minH:c,minHeight:d,labelProps:p,...x},_)=>{const{styles:S}=M(),{label:z,getContainerProps:k,getGroupProps:f,getLabelProps:A}=ms(x);return i??(i=u),c??(c=d),m.jsxs(R.section,{className:Z("ui-autocomplete__item","ui-autocomplete__item--group",l),__css:{color:s,h:"fit-content",w:"100%"},...k(),children:[m.jsx(R.header,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:S.groupLabel,...A(p),children:z}),m.jsx(R.div,{...f({},_),className:"ui-autocomplete__item__group",__css:{h:i,minH:c,...S.group},children:o})]})});ot.displayName="AutocompleteOptionGroup";ot.__ui__="AutocompleteOptionGroup";const bt={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},fs=l=>{l=l.replace(/[！-～]/g,s=>String.fromCharCode(s.charCodeAt(0)-65248));const o=new RegExp("("+Object.keys(bt).join("|")+")","g");return l=l.replace(o,s=>bt[s]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),l=l.toUpperCase(),l},xs=l=>{const o=s=>s.map(i=>{const{isDisabled:u,isFocusable:c}=i;if(!(u&&!c))return"items"in i?o(i.items??[]):i}).filter(Boolean);return o(l).flat(1/0)},Ds=l=>{const{allowCreate:o=!1,allowFree:s=!1,animation:i,boundary:u,children:c,closeDelay:d,closeOnBlur:p=!0,closeOnEsc:x=!0,closeOnSelect:_=!0,defaultIsOpen:S,defaultValue:z,duration:k=.2,emptyMessage:f="No results found",eventListeners:A,flip:D,format:E=fs,gutter:I,insertPositionItem:g="first",isLazy:C,isOpen:w,items:N,lazyBehavior:ke,matchWidth:Y=!0,maxSelectValues:re,modifiers:Te,offset:Se,omitSelectedValues:O=!1,openDelay:W,placeholder:Q,placement:ue="bottom-start",preventOverflow:de,strategy:ge,value:Be,optionProps:Pe,onChange:J,onClose:He,onCreate:ee,onKeyDown:Oe,onOpen:Pt,onSearch:we,...pe}=ns(l),{"aria-readonly":Cs,onFocus:nt,...H}=Jt(pe,ls),[lt,Ot]=vt(pe,yt),{id:wt}=pe,v=as(),ze=t.useRef(null),it=t.useRef(null),te=t.useRef(null),se=t.useRef(new Set([])),Ge=t.useRef(!1),at=t.useRef(void 0),[oe,ct]=t.useState(N?JSON.parse(JSON.stringify(N)):void 0),[j,je]=Xt({defaultValue:z,value:Be,onChange:J}),[$e,Je]=t.useState(void 0),[V,me]=t.useState(""),[K,P]=t.useState(-1),[ne,rt]=t.useState(!1),[fe,ut]=t.useState(!0),{isOpen:h,onClose:T,onOpen:dt}=Zt({defaultIsOpen:S,isOpen:w,onClose:He,onOpen:Pt}),he=K>-1,Ke=K===-2&&o,b=ae(j),Ee=b?!j.length:!j,[be,pt]=t.useMemo(()=>ae(g)?g:[g,"first"],[g]);o&&!Me(c)&&console.warn(`${b?"MultiAutocomplete":"Autocomplete"}: ${b?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const U=v.enabledValues(({node:e})=>b&&j.includes(e.dataset.value??"")).map(({index:e})=>e),G=v.enabledValues(({index:e,node:n})=>"target"in n.dataset&&!U.includes(e)),jt=_t(c),De=t.useMemo(()=>oe==null?void 0:oe.map((e,n)=>{if("value"in e){const{label:a,value:r,...y}=e;return m.jsx(Le,{value:r,...y,children:a},n)}else if("items"in e){const{items:a=[],label:r,...y}=e;return m.jsx(ot,{label:r,...y,children:a.map(({label:L,value:ie,...Xe},Tt)=>m.jsx(Le,{value:ie,...Xe,children:L},Tt))},n)}}).filter(Boolean),[oe]),le=!jt.length&&!(De!=null&&De.length),F=t.useCallback(()=>{H.disabled||H.readOnly||!o&&(le||ne)||(dt(),te.current&&te.current.focus())},[o,H,ne,le,dt]),xe=t.useCallback(()=>{const e=setTimeout(()=>{if(le||ne)return;const n=v.enabledFirstValue(({node:a})=>"target"in a.dataset);if(n)if(!b||!O)P(n.index);else if(U.includes(n.index)){const a=G[0];P((a==null?void 0:a.index)??-1)}else P(n.index)});se.current.add(e)},[v,G,ne,le,b,O,U]),Ne=t.useCallback(()=>{const e=setTimeout(()=>{if(le||ne)return;const n=v.enabledLastValue(({node:a})=>"target"in a.dataset);if(n)if(!b||!O)P(n.index);else if(U.includes(n.index)){const a=G.reverse()[0];P((a==null?void 0:a.index)??-1)}else P(n.index)});se.current.add(e)},[v,G,ne,le,b,O,U]),Ue=t.useCallback(()=>{const e=setTimeout(()=>{const a=v.enabledValues().find(({node:r})=>b?j.includes(r.dataset.value??""):r.dataset.value===j);a&&P(a.index)});se.current.add(e)},[v,b,j]),_e=t.useCallback((e=K)=>{const n=setTimeout(()=>{const a=v.enabledNextValue(e,({node:r})=>"target"in r.dataset);if(a)if(!b||!O)P(a.index);else if(U.includes(a.index)){const r=G.find(({index:y})=>a.index<y)??G[0];P((r==null?void 0:r.index)??-1)}else P(a.index)});se.current.add(n)},[v,G,K,b,O,U]),qe=t.useCallback((e=K)=>{const n=setTimeout(()=>{const a=v.enabledPrevValue(e,({node:r})=>"target"in r.dataset);if(a)if(!b||!O)P(a.index);else if(U.includes(a.index)){const r=G.reverse().find(({index:y})=>y<a.index)??G[0];P((r==null?void 0:r.index)??-1)}else P(a.index)});se.current.add(n)},[v,G,K,b,O,U]),X=Ee||O?xe:Ue,mt=Ee||O?Ne:Ue,Ye=t.useCallback(e=>{const n=v.values();let a=!1,r=!1;n.forEach(({index:y,node:L})=>{if(E(L.textContent??"").includes(e)){a=!0;const ie="disabled"in L.dataset;L.dataset.target="",!r&&!ie&&(r=!0,P(y))}else delete L.dataset.target}),ut(a)},[v,E]),q=t.useCallback((e=!0)=>{v.values().forEach(({node:a})=>{a.dataset.target=""}),e&&xe(),ut(!0)},[v,xe]),Et=t.useCallback(e=>{const n=v.values();if(!n.length)return;const r=(ae(e)?e:[e]).map(y=>{const{node:L}=n.find(({node:ie})=>ie.dataset.value===y)??{};if(L){const{textContent:ie}=Array.from(L.children).find(Xe=>Xe.getAttribute("data-label")!==null)??{};return ie}else return s?y:void 0}).filter(y=>!Me(y));Je(b?r:r[0])},[s,v,b]),B=t.useCallback((e,n=!0)=>{je(a=>{let r;return ae(a)?a.includes(e)?r=a.filter(L=>L!==e):r=[...a,e]:r=e,at.current=r,r}),me(""),b&&n&&q(!1)},[b,q,je]),We=t.useCallback(()=>{let e=v.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const n=e.node.dataset.value??"";B(n),_&&T(),O&&_e()},[_,v,K,O,B,T,_e]),Dt=t.useCallback(e=>{h||F(),we==null||we(e);const n=e.target.value,a=E(n);a?Ye(a):q(),me(n)},[h,F,E,we,Ye,q]),Nt=t.useCallback(()=>{Ge.current=!0},[]),Vt=t.useCallback(()=>{Ge.current=!1},[]),Ve=t.useCallback(()=>{if(!it.current)return;const e={label:V,value:V};let n=[];if(oe&&(n=[...oe]),be==="first")n=[e,...n];else if(be==="last")n=[...n,e];else{const r=n.findIndex(({label:L})=>L===be),y=n[r];r!==-1&&y&&"items"in y?(pt==="first"?y.items=[e,...y.items??[]]:y.items=[...y.items??[],e],n[r]=y):console.warn(`${b?"MultiAutocomplete":"Autocomplete"}: '${be}' specified in insertPositionItem does not exist in the option group.`)}ct(n),B(V),q(!1);const a=xs(n).findIndex(({value:r})=>r===V);P(a),ee==null||ee(e,n)},[V,oe,be,B,q,ee,pt,b]),ft=t.useCallback(()=>{h?te.current&&te.current.focus():(F(),X())},[h,X,F]),Fe=t.useCallback(()=>{h||(F(),X())},[h,X,F]),xt=t.useCallback(e=>{const n=Kt(e);Ut(ze.current,n)||!p&&fe||(s&&V&&B(V,!1),me(""),h&&T())},[p,fe,h,V,s,T,B]),Ct=t.useCallback(()=>{B(b?j[j.length-1]:""),h||Fe()},[b,h,B,Fe,j]),Ft=t.useCallback(e=>{e.stopPropagation(),at.current=[],je([]),Je(void 0),me(""),q(),h&&te.current&&te.current.focus()},[h,Je,me,je,q]),gt=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),H.disabled||H.readOnly||Ge.current)return;const n=$e===V||!V.length,r={ArrowDown:he?()=>_e():h?void 0:Re(F,X),ArrowUp:he?()=>qe():h?void 0:Re(F,mt),Backspace:!Ee&&n?Ct:void 0,End:h?Ne:void 0,Enter:Ke?Ve:he?We:h?s&&b?()=>{V&&B(V),P(0)}:void 0:Re(F,X),Escape:x?T:void 0,Home:h?xe:void 0,Space:Ke?Ve:he?We:h?void 0:Re(F,X)}[e.key];r&&(e.preventDefault(),e.stopPropagation(),r(e))},[s,H,$e,V,F,he,b,X,_e,mt,qe,Ke,Ve,We,h,xe,Ne,x,T,Ee,Ct,B]);t.useEffect(()=>{if(!b||!O&&Me(re))return;const e=j.length>0&&j.length===v.count(),n=j.length===re;e||n?(T(),rt(!0)):rt(!1)},[O,j,v,b,T,re]),qt(()=>{Et(j)},[j]),ve(()=>{h||s||(P(-1),me(""))},[h]),ve(()=>{fe||P(-2)},[fe]),ve(()=>{ct(N?JSON.parse(JSON.stringify(N)):void 0)},[N]),Yt(()=>{se.current.forEach(e=>clearTimeout(e)),se.current.clear()}),Qt({ref:ze,enabled:h&&(p||!fe),handler:T});const Rt=t.useCallback(e=>({animation:i,boundary:u,closeDelay:d,closeOnBlur:p,duration:k,eventListeners:A,flip:D,gutter:I,isLazy:C,lazyBehavior:ke,matchWidth:Y,modifiers:Te,offset:Se,openDelay:W,placement:ue,preventOverflow:de,strategy:ge,...e,closeOnButton:!1,isOpen:h,trigger:"never",onClose:T,onOpen:F}),[p,W,d,C,ke,i,k,Se,I,de,D,Y,u,A,ge,ue,Te,h,F,T]),Mt=t.useCallback((e={},n=null)=>({ref:Ae(ze,n),...lt,...e,...H,onBlur:$(e.onBlur,pe.onBlur,xt),onClick:$(e.onClick,pe.onClick,ft)}),[lt,H,xt,ft,pe]),Lt=t.useCallback((e={},n=null)=>({ref:n,tabIndex:-1,...e,...H,"data-active":Ce(h),placeholder:Q,onFocus:$(e.onFocus,nt,Fe),onKeyDown:$(e.onKeyDown,Oe,gt)}),[H,Q,h,nt,Fe,Oe,gt]);return{id:wt,allowCreate:o,allowFree:s,children:c??De,closeOnSelect:_,descendants:v,emptyMessage:f,focusedIndex:K,inputRef:te,inputValue:V,isAllSelected:ne,isEmpty:le,isHit:fe,isOpen:h,label:$e,listRef:it,omitSelectedValues:O,pickOptions:Ye,rebirthOptions:q,setFocusedIndex:P,value:j,formControlProps:H,getContainerProps:Mt,getFieldProps:Lt,getPopoverProps:Rt,inputProps:Ot,optionProps:Pe,onChange:B,onClear:Ft,onClose:T,onCompositionEnd:Vt,onCompositionStart:Nt,onCreate:Ve,onFocusFirst:xe,onFocusLast:Ne,onFocusNext:_e,onFocusPrev:qe,onFocusSelected:Ue,onOpen:F,onSearch:Dt}},Ns=()=>{var D,E;const{id:l,focusedIndex:o,inputRef:s,isAllSelected:i,isOpen:u,listRef:c,formControlProps:d,inputProps:p,onCompositionEnd:x,onCompositionStart:_,onSearch:S}=M(),k=(D=Ze().value(o))==null?void 0:D.node.id,f=(E=c.current)==null?void 0:E.id;return ve(()=>{i&&s.current&&s.current.blur()},[i]),{getInputProps:t.useCallback((I={},g=null)=>({ref:Ae(s,g),...d,"aria-activedescendant":k,"aria-autocomplete":"list","aria-controls":f,"aria-expanded":u,"aria-haspopup":"listbox",autoCapitalize:"none",autoComplete:"off",role:"combobox",spellCheck:"false",tabIndex:i?-1:0,...p,...I,id:l,cursor:d.readOnly?"default":"text",pointerEvents:d.disabled||i?"none":"auto",onChange:$(I.onChange,S),onCompositionEnd:$(I.onCompositionEnd,p.onCompositionEnd,x),onCompositionStart:$(I.onCompositionStart,p.onCompositionStart,_)}),[f,k,u,p,s,d,l,i,S,_,x])}};export{js as A,Es as a,M as b,Ns as c,Qe as d,St as e,It as f,kt as g,Le as h,ot as i,At as j,Ds as u};
