import{j as O}from"./extends-CwFRzn3r.js";import{r as t}from"./index-BwDkhjyp.js";import{C as fe}from"./close-button-CAt6lTNE.js";import{f as me}from"./forward-ref-BWI-Phbn.js";import{p as de,a as q,h as c,C as pe,am as L,_,c as Z,q as ve,ap as ge,b as Pe,$ as Ce}from"./factory-CBW6YcbY.js";import{s as V}from"./slide-fade-BtzrfF3F.js";import{s as be}from"./scale-fade-ChN5nit0.js";import{m as ye}from"./forward-ref-scR1bmHx.js";import{m as he}from"./factory-B6ZnNkK9.js";import{b as xe}from"./index-Du-PXOJx.js";import{u as _e,b as Be}from"./index-D7MGIgCi.js";import{u as Re,a as Te,b as we}from"./index-Cyo00D5l.js";import{u as Ee}from"./index-B1KvLq6v.js";import{a as Fe}from"./use-component-style-Givb0biW.js";import{o as ke}from"./theme-provider-B8NHi_rL.js";const[Me,U]=de({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),ee=m=>{const[l,r]=Fe("Popover",m),{animation:B="scale",autoFocus:P=!0,children:C,closeDelay:d=200,closeOnBlur:f=!0,closeOnButton:R=!0,closeOnEsc:D=!0,duration:T,initialFocusRef:K,isLazy:X,lazyBehavior:I="unmount",openDelay:A=200,relatedRef:g,restoreFocus:Y=!0,trigger:a="click",...j}=ke(r),b=t.useId(),w=t.useId(),E=t.useId(),{isOpen:o,onClose:s,onOpen:x,onToggle:N}=_e(r),F=t.useRef(null),i=t.useRef(null),p=t.useRef(null),{present:ne,onAnimationComplete:re}=xe({ref:p,isOpen:o}),y=t.useRef(void 0),H=t.useRef(void 0),k=t.useRef(!1),$=t.useRef(!1),{forceUpdate:G,referenceRef:S,transformOrigin:J,getPopperProps:se}=Ee({...j,enabled:o});o&&($.current=!0),t.useEffect(()=>()=>{y.current&&clearTimeout(y.current),H.current&&clearTimeout(H.current)},[]),Re({ref:i,enabled:o}),Te(p,{focusRef:i,shouldFocus:Y&&(a==="click"||a==="contextmenu"),visible:o}),we(p,{focusRef:K,shouldFocus:P&&(a==="click"||a==="contextmenu"),visible:o});const Q=Be({enabled:X,isSelected:ne,mode:I,wasSelected:$.current}),ie=t.useCallback((e={},M=null)=>{const u={id:b,"aria-describedby":E,"aria-hidden":!o,"aria-labelledby":w,role:"dialog",...e,ref:q(p,M),style:{...e.style,transformOrigin:J},children:Q?e.children:null,tabIndex:-1,onBlur:c(e.onBlur,n=>{const v=L(n),h=_(p.current,v),ae=_(i.current,v),le=g!=null&&g.current?_(g.current,v):!1;o&&f&&(!h&&!ae&&!le)&&s()}),onKeyDown:c(e.onKeyDown,n=>{D&&n.key==="Escape"&&s()})};return a==="hover"&&(u.onMouseEnter=c(e.onMouseEnter,()=>{k.current=!0}),u.onMouseLeave=c(e.onMouseLeave,n=>{n.nativeEvent.relatedTarget!==null&&(k.current=!1,f&&setTimeout(s,d))})),u},[d,f,D,o,s,Q,J,a,g,b,w,E]),W=t.useCallback(e=>{F.current==null&&S(e)},[S]),ue=t.useCallback((e={},M=null)=>{const u={"aria-controls":o?b:void 0,"aria-expanded":o,role:"button",...e,ref:q(i,M,W)};return a==="click"&&(u.onClick=c(e.onClick,N),u.onBlur=c(e.onBlur,n=>{const v=L(n),h=!_(p.current,v);o&&f&&h&&s()})),a==="contextmenu"&&(u.onContextMenu=c(e.onContextMenu,n=>{n.preventDefault(),x()}),u.onBlur=c(e.onBlur,n=>{const v=L(n),h=!_(p.current,v);o&&f&&h&&s()})),a==="hover"&&(u.onFocus=c(e.onFocus,()=>{y.current===void 0&&x()}),u.onBlur=c(e.onBlur,n=>{const v=L(n),h=!_(p.current,v);o&&f&&h&&s()}),u.onKeyDown=c(e.onKeyDown,n=>{n.key==="Escape"&&s()}),u.onMouseEnter=c(e.onMouseEnter,()=>{k.current=!0,y.current=window.setTimeout(x,A)}),u.onMouseLeave=c(e.onMouseLeave,()=>{k.current=!1,y.current&&(clearTimeout(y.current),y.current=void 0),H.current=window.setTimeout(()=>{k.current||s()},d)})),u},[d,f,o,W,s,x,N,A,a,b]),ce=t.useCallback((e={},M=null)=>({...e,ref:q(M,F,S)}),[F,S]);return O.jsx(Me,{value:{id:b,animation:B,closeOnButton:R,describedbyId:E,duration:T,forceUpdate:G,isOpen:o,labelledbyId:w,styles:l,getAnchorProps:ce,getPopoverProps:ie,getPopperProps:se,getTriggerProps:ue,onAnimationComplete:re,onClose:s},children:pe(C,{forceUpdate:G,isOpen:o,onClose:s})})};ee.displayName="Popover";ee.__ui__="Popover";const z=me(({onClick:m,...l},r)=>{const{id:B,styles:P,onClose:C}=U(),d={position:"absolute",...P.closeButton};return O.jsx(fe,{ref:r,className:Z("ui-popover__close-button"),size:"sm","aria-controls":B,"aria-label":"Close popover",onClick:c(m,f=>{f.stopPropagation(),C==null||C()}),__css:d,...l})});z.displayName="PopoverCloseButton";z.__ui__="PopoverCloseButton";const Oe=(m="scale",l)=>{const r={duration:l,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(m){case"scale":return{...be,custom:{...r,scale:.95}};case"top":return{...V,custom:{...r,offsetX:0,offsetY:-16}};case"right":return{...V,custom:{...r,offsetX:16,offsetY:0}};case"left":return{...V,custom:{...r,offsetX:-16,offsetY:0}};case"bottom":return{...V,custom:{...r,offsetX:0,offsetY:16}}}},oe=ye(({as:m="section",className:l,children:r,maxW:B,maxWidth:P,minW:C,minWidth:d,w:f,width:R,z:D,zIndex:T,containerProps:K,__css:X,...I},A)=>{const{animation:g,closeOnButton:Y,duration:a,isOpen:j,styles:b,getPopoverProps:w,getPopperProps:E,onAnimationComplete:o}=U(),s=ve(r),[x,...N]=ge(s,z),F=t.useMemo(()=>he(m),[m]),i=X??b.container??{},p={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...i};return R??(R=f),R??(R=i.width??i.w),d??(d=C),d??(d=i.minWidth??i.minW),P??(P=B),P??(P=i.maxWidth??i.maxW),T??(T=D),T??(T=i.zIndex??i.z),O.jsx(Pe.div,{...E({style:{visibility:j?"visible":"hidden"}}),className:"ui-popover",maxWidth:P,minWidth:d,outline:"none",width:R,zIndex:T,...K,children:O.jsxs(F,{className:Z("ui-popover__content",l),...g!=="none"?Oe(g,a):{},...w(I,A),animate:j?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:Ce(o,I.onAnimationComplete),__css:p,children:[x??(Y?O.jsx(z,{}):null),N]})})});oe.displayName="PopoverContent";oe.__ui__="PopoverContent";const te=({children:m})=>{const l=t.Children.only(m),{getTriggerProps:r}=U();return t.cloneElement(l,r(l.props,l.ref))};te.displayName="PopoverTrigger";te.__ui__="PopoverTrigger";export{ee as P,te as a,oe as b,z as c,U as u};
