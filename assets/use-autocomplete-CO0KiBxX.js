import{j as m}from"./extends-CwFRzn3r.js";import{f as ce}from"./forward-ref-BWI-Phbn.js";import{p as Bt,q as _t,b as R,c as Q,j as Ht,E as Me,a4 as zt,g as Gt,a as Ae,x as ye,d as Ce,h as $,aq as $t,J as ae,C as ht,f as ve,Y as vt,a9 as yt,Z as Jt,am as Kt,_ as Ut,u as qt,X as Yt,$ as Re}from"./factory-CBW6YcbY.js";import{r as s}from"./index-BwDkhjyp.js";import{b as Wt}from"./popover-trigger-BfTl05Lo.js";import{u as Xt}from"./index-DAOPkzwd.js";import{u as Zt}from"./index-D7MGIgCi.js";import{u as Qt}from"./index-DbHNzxol.js";import{c as es}from"./index-BOsfR7XW.js";import{u as ts}from"./index-BEwlKK2P.js";import{a as ss,C as os}from"./icon-C1fg-h9m.js";import{u as ns,f as ls}from"./form-control-Cr_hm2rR.js";const{DescendantsContextProvider:js,useDescendant:is,useDescendants:as,useDescendantsContext:Ze}=es(),[Es,M]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),Qe=ce(({className:l,children:o,__css:t,...i},u)=>{const{styles:r}=M(),d={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...r.icon,...t},x=_t(o).map(y=>s.cloneElement(y,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return m.jsx(R.div,{ref:u,className:Q("ui-autocomplete__icon",l),__css:d,...i,children:Ht(o)?x:m.jsx(ss,{})})});Qe.displayName="AutocompleteIcon";Qe.__ui__="AutocompleteIcon";const At=({className:l,children:o,...t})=>{const i=s.useRef(null),{styles:u}=M(),r=t.disabled,d=ts({ref:i,isDisabled:r,...t});return m.jsx(Qe,{className:Q("ui-autocomplete__icon--clear",l),"aria-label":"Clear value",__css:u.clearIcon,...d,children:o??m.jsx(os,{h:"0.5em",w:"0.5em"})})};At.displayName="AutocompleteClearIcon";At.__ui__="AutocompleteClearIcon";const Ie=ce(({className:l,...o},t)=>{const{styles:i}=M(),u={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...i.itemIcon};return m.jsx(R.span,{ref:t,className:Q("ui-autocomplete__item__icon",l),__css:u,...o})});Ie.displayName="AutocompleteItemIcon";Ie.__ui__="AutocompleteItemIcon";const cs=l=>{var o;return $t(l)&&!!((o=l.getAttribute("role"))!=null&&o.startsWith("option"))},rs=l=>{var Pe;const{closeOnSelect:o,focusedIndex:t,inputRef:i,omitSelectedValues:u,setFocusedIndex:r,value:d,optionProps:p,onChange:x,onClose:y,onFocusNext:S}=M(),z=s.useId(),k=s.useRef(null);let{id:f,children:A,closeOnSelect:D,icon:O,isDisabled:I,isFocusable:h,value:C,...j}={...p,...l};const N=!!I&&!h,{descendants:ke,index:W,register:re}=is({disabled:N}),Se=ke.values().slice(0,W),w=ae(d),X=Se.some(({node:J})=>J.dataset.value===(C??"")),ee=!X&&(w?d.includes(C??""):(C??"")===d),ue="target"in(((Pe=k.current)==null?void 0:Pe.dataset)??{}),de=W===t;f??(f=z),Me(C)&&(zt(A)||Gt(A)?C=A.toString():console.warn(`${w?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`));const ge=s.useCallback(J=>{if(J.stopPropagation(),I||!cs(J.currentTarget)){i.current&&i.current.focus();return}X||r(W),x(C??""),i.current&&i.current.focus(),(D??o)&&y(),u&&S(W)},[X,S,u,I,C,r,W,x,D,o,y,i]),Be=s.useCallback((J={},He=null)=>{const te=!ue||u&&ee,Oe={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:Ae(k,He,re),role:"option",...j,...J,id:f,style:te?Oe:void 0,"aria-disabled":ye(I),"aria-hidden":ye(te),"aria-selected":ee,"data-disabled":Ce(I),"data-duplicated":Ce(X),"data-focus":Ce(de),"data-target":Ce(!0),"data-value":C??"",tabIndex:-1,onClick:$(j.onClick,J.onClick,ge)}},[f,X,C,j,I,de,ee,ue,u,ge,re]);return{children:A,customIcon:O,isFocused:de,isSelected:ee,isTarget:ue,omitSelectedValues:u,getOptionProps:Be}},us=()=>{const{isHit:l,onCreate:o}=M();return{getCreateProps:s.useCallback((i={},u=null)=>({ref:u,role:"option",...i,style:l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":ye(l),"data-focus":Ce(!l),tabIndex:-1,onClick:$(i.onClick,o)}),[l,o])}},ds=()=>{const{isEmpty:l,isHit:o}=M();return{getEmptyProps:s.useCallback((i={},u=null)=>{const r=o&&!l;return{ref:u,role:"presentation",...i,style:r?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":ye(r),tabIndex:-1}},[o,l])}},It=ce(({className:l,children:o,icon:t,...i},u)=>{const{inputValue:r,styles:d}=M(),{getCreateProps:p}=us();o??(o=r);const x={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return m.jsxs(R.div,{className:Q("ui-autocomplete__item--create",l),__css:x,...p(i,u),children:[t!==null?m.jsx(Ie,{children:t||m.jsx(et,{})}):null,t?m.jsx(R.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:ht(o,r)}):ht(o,r)]})});It.displayName="AutocompleteCreate";It.__ui__="AutocompleteCreate";const et=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:m.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});et.displayName="AutocompletePlusIcon";et.__ui__="AutocompletePlusIcon";const kt=ce(({className:l,children:o,icon:t,...i},u)=>{const{emptyMessage:r,styles:d}=M(),{getEmptyProps:p}=ds();o??(o=r);const x={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return m.jsxs(R.div,{className:Q("ui-autocomplete__item--empty",l),__css:x,...p(i,u),children:[t!==null?m.jsx(Ie,{children:t||m.jsx(tt,{})}):null,t?m.jsx(R.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:o}):o]})});kt.displayName="AutocompleteEmpty";kt.__ui__="AutocompleteEmpty";const tt=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:m.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});tt.displayName="AutocompleteMinusIcon";tt.__ui__="AutocompleteMinusIcon";const ps=()=>{const{focusedIndex:l,isOpen:o,listRef:t,rebirthOptions:i,value:u}=M(),r=Ze(),d=s.useId(),p=s.useRef(-1),x=r.value(l),y=ae(u),S=s.useCallback(()=>{o||i(!1)},[o,i]);return s.useEffect(()=>{if(!t.current||!x||p.current===x.index)return;const k=t.current,f=x.node,A=k.clientHeight,D=k.scrollTop,O=D+A,I=f.clientHeight,h=f.offsetTop,C=h+I,j=D<=h&&C<=O,N=p.current<x.index;j||(C<=A?t.current.scrollTo({top:0}):N?t.current.scrollTo({top:C-A}):t.current.scrollTo({top:h+1})),p.current=x.index},[t,x]),ve(()=>{o||(p.current=-1)},[o]),{getListProps:s.useCallback(({id:k,...f}={},A=null)=>({id:k??d,ref:Ae(t,A),"aria-multiselectable":ye(y),position:"relative",role:"listbox",tabIndex:-1,...f}),[t,d,y]),onAnimationComplete:S}},St=ce(({className:l,children:o,footer:t,header:i,maxW:u,maxWidth:r,minW:d,minWidth:p,w:x,width:y,contentProps:S,...z},k)=>{var O,I,h,C,j,N;const{styles:f}=M(),{getListProps:A,onAnimationComplete:D}=ps();return y??(y=x),y??(y=((O=f.list)==null?void 0:O.width)??((I=f.list)==null?void 0:I.w)),p??(p=d),p??(p=((h=f.list)==null?void 0:h.minWidth)??((C=f.list)==null?void 0:C.minW)),r??(r=u),r??(r=((j=f.list)==null?void 0:j.maxWidth)??((N=f.list)==null?void 0:N.maxW)),m.jsxs(Wt,{className:"ui-autocomplete__popover",maxWidth:r,minWidth:p,width:y,__css:{...f.content,maxWidth:r,minWidth:p,width:y},...S,onAnimationComplete:$(S==null?void 0:S.onAnimationComplete,D),children:[i?m.jsx(R.header,{className:"ui-autocomplete__header",__css:{...f.header},children:i}):null,m.jsx(R.div,{className:Q("ui-autocomplete__list",l),__css:{...f.list},...A(z,k),children:o}),t?m.jsx(R.footer,{className:"ui-autocomplete__footer",__css:{...f.footer},children:t}):null]})});St.displayName="AutocompleteList";St.__ui__="AutocompleteList";const Le=ce(({className:l,icon:o,...t},i)=>{const{styles:u}=M(),{children:r,customIcon:d,isSelected:p,getOptionProps:x}=rs(t);o??(o=d);const y={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...u.item};return m.jsxs(R.div,{className:Q("ui-autocomplete__item",l),__css:y,...x({},i),children:[o!==null?m.jsx(Ie,{opacity:p?1:0,children:o||m.jsx(st,{})}):null,m.jsx(R.span,{style:{flex:1},"data-label":!0,children:r})]})});Le.displayName="AutocompleteOption";Le.__ui__="AutocompleteOption";const st=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:m.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});st.displayName="AutocompleteCheckIcon";st.__ui__="AutocompleteCheckIcon";const ms=({label:l,...o})=>{const{omitSelectedValues:t,value:i}=M(),u=Ze(),r=s.useRef(null),d=s.useId(),p=u.values(),S=(ae(i)&&t?u.values(({node:h})=>i.includes(h.dataset.value??"")):[]).map(({index:h})=>h),k=!p.filter(({index:h,node:C})=>{var j;return((j=C.parentElement)==null?void 0:j.dataset.label)===l&&!S.includes(h)&&"target"in C.dataset}).length,[f,A]=vt(o,yt),D=s.useCallback((h={},C=null)=>{var N;const j={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:C,"aria-labelledby":(N=r.current)==null?void 0:N.id,role:"group",...h,...f,style:k?j:void 0}},[f,k]),O=s.useCallback(({id:h,...C}={},j=null)=>({id:h??d,ref:Ae(j,r),role:"presentation",...C}),[d]),I=s.useCallback((h={},C=null)=>({ref:C,...h,...A,"data-label":l}),[A,l]);return{label:l,getContainerProps:D,getGroupProps:I,getLabelProps:O}},ot=ce(({className:l,children:o,color:t,h:i,height:u,minH:r,minHeight:d,labelProps:p,...x},y)=>{const{styles:S}=M(),{label:z,getContainerProps:k,getGroupProps:f,getLabelProps:A}=ms(x);return i??(i=u),r??(r=d),m.jsxs(R.section,{className:Q("ui-autocomplete__item","ui-autocomplete__item--group",l),__css:{color:t,h:"fit-content",w:"100%"},...k(),children:[m.jsx(R.header,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:S.groupLabel,...A(p),children:z}),m.jsx(R.div,{...f({},y),className:"ui-autocomplete__item__group",__css:{h:i,minH:r,...S.group},children:o})]})});ot.displayName="AutocompleteOptionGroup";ot.__ui__="AutocompleteOptionGroup";const bt={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},fs=l=>{l=l.replace(/[！-～]/g,t=>String.fromCharCode(t.charCodeAt(0)-65248));const o=new RegExp("("+Object.keys(bt).join("|")+")","g");return l=l.replace(o,t=>bt[t]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),l=l.toUpperCase(),l},xs=l=>{const o=t=>t.map(i=>{const{isDisabled:u,isFocusable:r}=i;if(!(u&&!r))return"items"in i?o(i.items??[]):i}).filter(Boolean);return o(l).flat(1/0)},Ds=l=>{const{allowCreate:o=!1,allowFree:t=!1,animation:i,boundary:u,children:r,closeDelay:d,closeOnBlur:p=!0,closeOnEsc:x=!0,closeOnSelect:y=!0,defaultIsOpen:S,defaultValue:z,duration:k=.2,emptyMessage:f="No results found",eventListeners:A,flip:D,format:O=fs,gutter:I,insertPositionItem:h="first",isLazy:C,isOpen:j,items:N,lazyBehavior:ke,matchWidth:W=!0,maxSelectValues:re,modifiers:Te,offset:Se,omitSelectedValues:w=!1,openDelay:X,placeholder:ee,placement:ue="bottom-start",preventOverflow:de,strategy:ge,value:Be,optionProps:Pe,onChange:J,onClose:He,onCreate:te,onKeyDown:Oe,onOpen:Pt,onSearch:we,...pe}=ns(l),{"aria-readonly":Cs,onFocus:nt,...H}=Jt(pe,ls),[lt,Ot]=vt(pe,yt),{id:wt}=pe,v=as(),ze=s.useRef(null),it=s.useRef(null),se=s.useRef(null),oe=s.useRef(new Set([])),Ge=s.useRef(!1),at=s.useRef(void 0),[ne,ct]=s.useState(N?JSON.parse(JSON.stringify(N)):void 0),[E,je]=Xt({defaultValue:z,value:Be,onChange:J}),[$e,Je]=s.useState(void 0),[V,me]=s.useState(""),[K,P]=s.useState(-1),[le,rt]=s.useState(!1),[fe,ut]=s.useState(!0),{isOpen:b,onClose:L,onOpen:dt}=Zt({defaultIsOpen:S,isOpen:j,onClose:He,onOpen:Pt}),he=K>-1,Ke=K===-2&&o,_=ae(E),Ee=_?!E.length:!E,[be,pt]=s.useMemo(()=>ae(h)?h:[h,"first"],[h]);o&&!Me(r)&&console.warn(`${_?"MultiAutocomplete":"Autocomplete"}: ${_?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const U=v.enabledValues(({node:e})=>_&&E.includes(e.dataset.value??"")).map(({index:e})=>e),G=v.enabledValues(({index:e,node:n})=>"target"in n.dataset&&!U.includes(e)),jt=_t(r),De=s.useMemo(()=>ne==null?void 0:ne.map((e,n)=>{if("value"in e){const{label:a,value:c,...g}=e;return m.jsx(Le,{value:c,...g,children:a},n)}else if("items"in e){const{items:a=[],label:c,...g}=e;return m.jsx(ot,{label:c,...g,children:a.map(({label:B,value:Y,...Xe},Tt)=>m.jsx(Le,{value:Y,...Xe,children:B},Tt))},n)}}).filter(Boolean),[ne]),ie=!jt.length&&!(De!=null&&De.length),F=s.useCallback(()=>{H.disabled||H.readOnly||!o&&(ie||le)||(dt(),se.current&&se.current.focus())},[o,H,le,ie,dt]),xe=s.useCallback(()=>{const e=setTimeout(()=>{if(ie||le)return;const n=v.enabledFirstValue(({node:a})=>"target"in a.dataset);if(n)if(!_||!w)P(n.index);else if(U.includes(n.index)){const a=G[0];P((a==null?void 0:a.index)??-1)}else P(n.index)});oe.current.add(e)},[v,G,le,ie,_,w,U]),Ne=s.useCallback(()=>{const e=setTimeout(()=>{if(ie||le)return;const n=v.enabledLastValue(({node:a})=>"target"in a.dataset);if(n)if(!_||!w)P(n.index);else if(U.includes(n.index)){const a=G.reverse()[0];P((a==null?void 0:a.index)??-1)}else P(n.index)});oe.current.add(e)},[v,G,le,ie,_,w,U]),Ue=s.useCallback(()=>{const e=setTimeout(()=>{const a=v.enabledValues().find(({node:c})=>_?E.includes(c.dataset.value??""):c.dataset.value===E);a&&P(a.index)});oe.current.add(e)},[v,_,E]),_e=s.useCallback((e=K)=>{const n=setTimeout(()=>{const a=v.enabledNextValue(e,({node:c})=>"target"in c.dataset);if(a)if(!_||!w)P(a.index);else if(U.includes(a.index)){const c=G.find(({index:g})=>a.index<g)??G[0];P((c==null?void 0:c.index)??-1)}else P(a.index)});oe.current.add(n)},[v,G,K,_,w,U]),qe=s.useCallback((e=K)=>{const n=setTimeout(()=>{const a=v.enabledPrevValue(e,({node:c})=>"target"in c.dataset);if(a)if(!_||!w)P(a.index);else if(U.includes(a.index)){const c=G.reverse().find(({index:g})=>g<a.index)??G[0];P((c==null?void 0:c.index)??-1)}else P(a.index)});oe.current.add(n)},[v,G,K,_,w,U]),Z=Ee||w?xe:Ue,mt=Ee||w?Ne:Ue,Ye=s.useCallback(e=>{const n=v.values();let a=!1,c=!1;n.forEach(({index:g,node:B})=>{if(O(B.textContent??"").includes(e)){a=!0;const Y="disabled"in B.dataset;B.dataset.target="",!c&&!Y&&(c=!0,P(g))}else delete B.dataset.target}),ut(a)},[v,O]),q=s.useCallback((e=!0)=>{v.values().forEach(({node:a})=>{a.dataset.target=""}),e&&xe(),ut(!0)},[v,xe]),Et=s.useCallback(e=>{const n=v.values();if(!n.length)return;const c=(ae(e)?e:[e]).map(g=>{const{node:B}=n.find(({node:Y})=>Y.dataset.value===g)??{};if(B){const{textContent:Y}=Array.from(B.children).find(Xe=>Xe.getAttribute("data-label")!==null)??{};return Y}else return t?g:void 0}).filter(g=>!Me(g));Je(_?c:c[0])},[t,v,_]),T=s.useCallback((e,n=!0)=>{je(c=>{let g;return ae(c)?c.includes(e)?g=c.filter(Y=>Y!==e):g=[...c,e]:g=e,at.current=g,g});const a=v.values().filter(({node:c})=>O(c.textContent??"").includes(e)).length>0;(o||t||a)&&me(""),_&&n&&q(!1)},[t,o,_,q,je,v,O]),We=s.useCallback(()=>{let e=v.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const n=e.node.dataset.value??"";T(n),y&&L(),w&&_e()},[y,v,K,w,T,L,_e]),Dt=s.useCallback(e=>{b||F(),we==null||we(e);const n=e.target.value,a=O(n);a?Ye(a):q(),me(n)},[b,F,O,we,Ye,q]),Nt=s.useCallback(()=>{Ge.current=!0},[]),Vt=s.useCallback(()=>{Ge.current=!1},[]),Ve=s.useCallback(()=>{if(!it.current)return;const e={label:V,value:V};let n=[];if(ne&&(n=[...ne]),be==="first")n=[e,...n];else if(be==="last")n=[...n,e];else{const c=n.findIndex(({label:B})=>B===be),g=n[c];c!==-1&&g&&"items"in g?(pt==="first"?g.items=[e,...g.items??[]]:g.items=[...g.items??[],e],n[c]=g):console.warn(`${_?"MultiAutocomplete":"Autocomplete"}: '${be}' specified in insertPositionItem does not exist in the option group.`)}ct(n),T(V),q(!1);const a=xs(n).findIndex(({value:c})=>c===V);P(a),te==null||te(e,n)},[V,ne,be,T,q,te,pt,_]),ft=s.useCallback(()=>{b?se.current&&se.current.focus():(F(),Z())},[b,Z,F]),Fe=s.useCallback(()=>{b||(F(),Z())},[b,Z,F]),xt=s.useCallback(e=>{const n=Kt(e);Ut(ze.current,n)||!p&&fe||(t&&V&&T(V,!1),me(""),b&&L())},[p,fe,b,V,t,L,T]),Ct=s.useCallback(()=>{T(_?E[E.length-1]:""),b||Fe()},[_,b,T,Fe,E]),Ft=s.useCallback(e=>{e.stopPropagation(),at.current=[],je([]),Je(void 0),me(""),q(),b&&se.current&&se.current.focus()},[b,Je,me,je,q]),gt=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),H.disabled||H.readOnly||Ge.current)return;const n=$e===V||!V.length,c={ArrowDown:he?()=>_e():b?void 0:Re(F,Z),ArrowUp:he?()=>qe():b?void 0:Re(F,mt),Backspace:!Ee&&n?Ct:void 0,End:b?Ne:void 0,Enter:Ke?Ve:he?We:b?t&&_?()=>{V&&T(V),P(0)}:void 0:Re(F,Z),Escape:x?L:void 0,Home:b?xe:void 0,Space:Ke?Ve:he?We:b?void 0:Re(F,Z)}[e.key];c&&(e.preventDefault(),e.stopPropagation(),c(e))},[t,H,$e,V,F,he,_,Z,_e,mt,qe,Ke,Ve,We,b,xe,Ne,x,L,Ee,Ct,T]);s.useEffect(()=>{if(!_||!w&&Me(re))return;const e=E.length>0&&E.length===v.count(),n=E.length===re;e||n?(L(),rt(!0)):rt(!1)},[w,E,v,_,L,re]),qt(()=>{Et(E)},[E]),ve(()=>{b||t||(P(-1),me(""))},[b]),ve(()=>{fe||P(-2)},[fe]),ve(()=>{ct(N?JSON.parse(JSON.stringify(N)):void 0)},[N]),Yt(()=>{oe.current.forEach(e=>clearTimeout(e)),oe.current.clear()}),Qt({ref:ze,enabled:b&&(p||!fe),handler:L});const Rt=s.useCallback(e=>({animation:i,boundary:u,closeDelay:d,closeOnBlur:p,duration:k,eventListeners:A,flip:D,gutter:I,isLazy:C,lazyBehavior:ke,matchWidth:W,modifiers:Te,offset:Se,openDelay:X,placement:ue,preventOverflow:de,strategy:ge,...e,closeOnButton:!1,isOpen:b,trigger:"never",onClose:L,onOpen:F}),[p,X,d,C,ke,i,k,Se,I,de,D,W,u,A,ge,ue,Te,b,F,L]),Mt=s.useCallback((e={},n=null)=>({ref:Ae(ze,n),...lt,...e,...H,onBlur:$(e.onBlur,pe.onBlur,xt),onClick:$(e.onClick,pe.onClick,ft)}),[lt,H,xt,ft,pe]),Lt=s.useCallback((e={},n=null)=>({ref:n,tabIndex:-1,...e,...H,"data-active":Ce(b),placeholder:ee,onFocus:$(e.onFocus,nt,Fe),onKeyDown:$(e.onKeyDown,Oe,gt)}),[H,ee,b,nt,Fe,Oe,gt]);return{id:wt,allowCreate:o,allowFree:t,children:r??De,closeOnSelect:y,descendants:v,emptyMessage:f,focusedIndex:K,inputRef:se,inputValue:V,isAllSelected:le,isEmpty:ie,isHit:fe,isOpen:b,label:$e,listRef:it,omitSelectedValues:w,pickOptions:Ye,rebirthOptions:q,setFocusedIndex:P,value:E,formControlProps:H,getContainerProps:Mt,getFieldProps:Lt,getPopoverProps:Rt,inputProps:Ot,optionProps:Pe,onChange:T,onClear:Ft,onClose:L,onCompositionEnd:Vt,onCompositionStart:Nt,onCreate:Ve,onFocusFirst:xe,onFocusLast:Ne,onFocusNext:_e,onFocusPrev:qe,onFocusSelected:Ue,onOpen:F,onSearch:Dt}},Ns=()=>{var D,O;const{id:l,focusedIndex:o,inputRef:t,isAllSelected:i,isOpen:u,listRef:r,formControlProps:d,inputProps:p,onCompositionEnd:x,onCompositionStart:y,onSearch:S}=M(),k=(D=Ze().value(o))==null?void 0:D.node.id,f=(O=r.current)==null?void 0:O.id;return ve(()=>{i&&t.current&&t.current.blur()},[i]),{getInputProps:s.useCallback((I={},h=null)=>({ref:Ae(t,h),...d,"aria-activedescendant":k,"aria-autocomplete":"list","aria-controls":f,"aria-expanded":u,"aria-haspopup":"listbox",autoCapitalize:"none",autoComplete:"off",role:"combobox",spellCheck:"false",tabIndex:i?-1:0,...p,...I,id:l,cursor:d.readOnly?"default":"text",pointerEvents:d.disabled||i?"none":"auto",onChange:$(I.onChange,S),onCompositionEnd:$(I.onCompositionEnd,p.onCompositionEnd,x),onCompositionStart:$(I.onCompositionStart,p.onCompositionStart,y)}),[f,k,u,p,t,d,l,i,S,y,x])}};export{js as A,Es as a,Qe as b,St as c,It as d,kt as e,M as f,Ns as g,Le as h,ot as i,At as j,Ds as u};
