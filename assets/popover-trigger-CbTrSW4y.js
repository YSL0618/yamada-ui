import{j as M}from"./jsx-runtime-CfatFE5O.js";import{r as t}from"./index-ClcD9ViR.js";import{C as de}from"./close-button-KaaR9e9n.js";import{f as pe}from"./forward-ref-D13m8o2p.js";import{p as ve,a as U,h as i,C as ge,ai as V,$ as B,c as ee,q as Pe,al as Ce,b as be,a0 as ye}from"./factory-Cp1Ju9mN.js";import{s as I}from"./slide-fade-Sj6o3YZF.js";import{s as he}from"./scale-fade-BQQzZXA1.js";import{m as Re}from"./forward-ref-2BKBy0Yi.js";import{m as xe}from"./factory-CYGsRDnQ.js";import{b as Be}from"./index-CilJ2bIs.js";import{u as _e,b as Te}from"./index-DeQ1wXyQ.js";import{u as we,a as Ee,b as Fe}from"./index-BDaUJiBA.js";import{u as ke}from"./index-BMJcaCPC.js";import{a as Me}from"./use-component-style-BGLOU3Ga.js";import{o as Oe}from"./theme-provider-DMHFYkuw.js";const[De,$]=ve({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),oe=d=>{const[a,n]=Me("Popover",d),{animation:_="scale",autoFocus:C=!0,children:b,closeDelay:p=200,closeOnBlur:f=!0,closeOnButton:T=!0,closeOnEsc:O=!0,duration:w,initialFocusRef:K,isLazy:X,lazyBehavior:D="unmount",openDelay:A=200,relatedRef:g,restoreFocus:Y=!0,trigger:u="click",...j}=Oe(n),y=t.useId(),{isOpen:o,onClose:r,onOpen:R,onToggle:N}=_e(n),E=t.useRef(null),x=t.useRef(null),S=t.useRef(null),c=t.useRef(null),v=t.useRef(null),{present:re,onAnimationComplete:se}=Be({ref:v,isOpen:o}),h=t.useRef(void 0),H=t.useRef(void 0),F=t.useRef(!1),G=t.useRef(!1),{forceUpdate:J,referenceRef:L,transformOrigin:Q,getPopperProps:ie}=ke({...j,enabled:o});o&&(G.current=!0),t.useEffect(()=>()=>{h.current&&clearTimeout(h.current),H.current&&clearTimeout(H.current)},[]),we({ref:x,enabled:o}),Ee(v,{focusRef:x,shouldFocus:Y&&(u==="click"||u==="contextmenu"),visible:o}),Fe(v,{focusRef:K,shouldFocus:C&&(u==="click"||u==="contextmenu"),visible:o});const W=Te({enabled:X,isSelected:re,mode:D,wasSelected:G.current}),ue=t.useCallback((e={},k=null)=>{var l,P;const s={id:y,"aria-describedby":(l=c.current)==null?void 0:l.id,"aria-hidden":!o,"aria-labelledby":(P=S.current)==null?void 0:P.id,role:"dialog",...e,ref:U(v,k),style:{...e.style,transformOrigin:Q},children:W?e.children:null,tabIndex:-1,onBlur:i(e.onBlur,m=>{const q=V(m),ae=B(v.current,q),fe=B(x.current,q),me=g!=null&&g.current?B(g.current,q):!1;o&&f&&(!ae&&!fe&&!me)&&r()}),onKeyDown:i(e.onKeyDown,m=>{O&&m.key==="Escape"&&r()})};return u==="hover"&&(s.onMouseEnter=i(e.onMouseEnter,()=>{F.current=!0}),s.onMouseLeave=i(e.onMouseLeave,m=>{m.nativeEvent.relatedTarget!==null&&(F.current=!1,f&&setTimeout(r,p))})),s},[p,f,O,o,r,W,Q,u,g,y]),Z=t.useCallback(e=>{E.current==null&&L(e)},[L]),ce=t.useCallback((e={},k=null)=>{const s={"aria-controls":o?y:void 0,"aria-expanded":o,role:"button",...e,ref:U(x,k,Z)};return u==="click"&&(s.onClick=i(e.onClick,N),s.onBlur=i(e.onBlur,l=>{const P=V(l),m=!B(v.current,P);o&&f&&m&&r()})),u==="contextmenu"&&(s.onContextMenu=i(e.onContextMenu,l=>{l.preventDefault(),R()}),s.onBlur=i(e.onBlur,l=>{const P=V(l),m=!B(v.current,P);o&&f&&m&&r()})),u==="hover"&&(s.onFocus=i(e.onFocus,()=>{h.current===void 0&&R()}),s.onBlur=i(e.onBlur,l=>{const P=V(l),m=!B(v.current,P);o&&f&&m&&r()}),s.onKeyDown=i(e.onKeyDown,l=>{l.key==="Escape"&&r()}),s.onMouseEnter=i(e.onMouseEnter,()=>{F.current=!0,h.current=window.setTimeout(R,A)}),s.onMouseLeave=i(e.onMouseLeave,()=>{F.current=!1,h.current&&(clearTimeout(h.current),h.current=void 0),H.current=window.setTimeout(()=>{F.current||r()},p)})),s},[p,f,o,Z,r,R,N,A,u,y]),le=t.useCallback((e={},k=null)=>({...e,ref:U(k,E,L)}),[E,L]);return M.jsx(De,{value:{id:y,animation:_,bodyRef:c,closeOnButton:T,duration:w,forceUpdate:J,headerRef:S,isOpen:o,styles:a,getAnchorProps:le,getPopoverProps:ue,getPopperProps:ie,getTriggerProps:ce,onAnimationComplete:se,onClose:r},children:ge(b,{forceUpdate:J,isOpen:o,onClose:r})})};oe.displayName="Popover";oe.__ui__="Popover";const z=pe(({onClick:d,...a},n)=>{const{id:_,styles:C,onClose:b}=$(),p={position:"absolute",...C.closeButton};return M.jsx(de,{ref:n,className:ee("ui-popover__close-button"),size:"sm","aria-controls":_,"aria-label":"Close popover",onClick:i(d,f=>{f.stopPropagation(),b==null||b()}),__css:p,...a})});z.displayName="PopoverCloseButton";z.__ui__="PopoverCloseButton";const Ae=(d="scale",a)=>{const n={duration:a,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(d){case"scale":return{...he,custom:{...n,scale:.95}};case"top":return{...I,custom:{...n,offsetX:0,offsetY:-16}};case"right":return{...I,custom:{...n,offsetX:16,offsetY:0}};case"left":return{...I,custom:{...n,offsetX:-16,offsetY:0}};case"bottom":return{...I,custom:{...n,offsetX:0,offsetY:16}}}},te=Re(({as:d="section",className:a,children:n,maxW:_,maxWidth:C,minW:b,minWidth:p,w:f,width:T,z:O,zIndex:w,containerProps:K,__css:X,...D},A)=>{const{animation:g,closeOnButton:Y,duration:u,isOpen:j,styles:y,getPopoverProps:o,getPopperProps:r,onAnimationComplete:R}=$(),N=Pe(n),[E,...x]=Ce(N,z),S=t.useMemo(()=>xe(d),[d]),c=X??y.container??{},v={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...c};return T??(T=f),T??(T=c.width??c.w),p??(p=b),p??(p=c.minWidth??c.minW),C??(C=_),C??(C=c.maxWidth??c.maxW),w??(w=O),w??(w=c.zIndex??c.z),M.jsx(be.div,{...r({style:{visibility:j?"visible":"hidden"}}),className:"ui-popover",maxWidth:C,minWidth:p,outline:"none",width:T,zIndex:w,...K,children:M.jsxs(S,{className:ee("ui-popover__content",a),...g!=="none"?Ae(g,u):{},...o(D,A),animate:j?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:ye(R,D.onAnimationComplete),__css:v,children:[E??(Y?M.jsx(z,{}):null),x]})})});te.displayName="PopoverContent";te.__ui__="PopoverContent";const ne=({children:d})=>{const a=t.Children.only(d),{getTriggerProps:n}=$();return t.cloneElement(a,n(a.props,a.ref))};ne.displayName="PopoverTrigger";ne.__ui__="PopoverTrigger";export{oe as P,ne as a,te as b,z as c,$ as u};
