import{j as b}from"./extends-CwFRzn3r.js";import{u as dt}from"./index-BEwlKK2P.js";import{r as s}from"./index-BwDkhjyp.js";import{a as pt,C as ft}from"./icon-C1fg-h9m.js";import{f as ie}from"./forward-ref-BWI-Phbn.js";import{E as Ve,a4 as mt,g as xt,a as ce,x as Qe,d as ae,h as le,aq as ht,J as Q,b as M,c as ee,Y as et,a9 as tt,p as bt,Z as vt,a2 as Ct,q as st,am as gt,_ as _t,u as St,f as yt,X as Ot,$ as ge,j as It}from"./factory-CBW6YcbY.js";import{u as Pt}from"./index-DAOPkzwd.js";import{c as kt}from"./index-BOsfR7XW.js";import{u as jt}from"./index-D7MGIgCi.js";import{u as wt}from"./index-DbHNzxol.js";import{u as Dt,f as Et}from"./form-control-Cr_hm2rR.js";import{b as Ft}from"./popover-trigger-BfTl05Lo.js";const Vt=c=>{var n;return ht(c)&&!!((n=c.getAttribute("role"))!=null&&n.startsWith("option"))},Nt=c=>{const{closeOnSelect:n,fieldRef:a,focusedIndex:u,omitSelectedValues:i,placeholder:l,placeholderInOptions:r,setFocusedIndex:m,value:P,optionProps:v,onChange:_,onClose:O,onFocusNext:k}=U(),d=s.useId(),F=s.useRef(null);let{id:w,children:S,closeOnSelect:V,icon:x,isDisabled:h,isFocusable:D,value:I,...g}={...v,...c};const re=!!h&&!D,{descendants:J,index:H,register:te}=Tt({disabled:re}),ue=J.values().slice(0,H),de=!!l&&r,ye=de&&H===0,W=Q(P),z=W?!1:ue.some(({node:A})=>A.dataset.value===(I??"")),X=!z&&(W?P.includes(I??""):(I??"")===P),N=H===u;w??(w=d),!ye&&Ve(I)&&(mt(S)||xt(S)?I=S.toString():console.warn(`${W?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),de&&H>0&&!I&&console.warn(`${W?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const Oe=s.useCallback(A=>{if(A.preventDefault(),A.stopPropagation(),h||!Vt(A.currentTarget)){a.current&&a.current.focus();return}z||m(H),_(I??""),a.current&&a.current.focus(),(V??n)&&O(),i&&k()},[h,z,m,H,_,I,a,V,n,O,i,k]),R=s.useCallback((A={},pe=null)=>{const p={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ce(F,pe,te),role:"option",...g,...A,id:w,style:i&&X?p:void 0,"aria-disabled":Qe(h),"aria-selected":X,"data-disabled":ae(h),"data-duplicated":ae(z),"data-focus":ae(N),"data-value":I??"",tabIndex:-1,onClick:le(g.onClick,A.onClick,Oe)}},[w,I,g,h,N,z,X,i,Oe,te]);return{children:S,customIcon:x,isFocused:N,isSelected:X,getOptionProps:R}},_e=ie(({className:c,icon:n,...a},u)=>{const{styles:i}=U(),{children:l,customIcon:r,isSelected:m,getOptionProps:P}=Nt(a);n??(n=r);const v={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...i.item};return b.jsxs(M.div,{className:ee("ui-select__item",c),__css:v,...P({},u),children:[n!==null?b.jsx(Ne,{opacity:m?1:0,children:n||b.jsx(Rt,{})}):null,b.jsx(M.span,{style:{flex:1},"data-label":!0,children:l})]})});_e.displayName="Option";_e.__ui__="Option";const Ne=ie(({className:c,...n},a)=>{const{styles:u}=U(),i={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...u.itemIcon};return b.jsx(M.span,{ref:a,className:ee("ui-select__item__icon",c),__css:i,...n})});Ne.displayName="OptionIcon";Ne.__ui__="OptionIcon";const Rt=()=>b.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:b.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Lt=({label:c,...n})=>{const{omitSelectedValues:a,value:u}=U(),i=nt(),l=s.useRef(null),r=s.useId(),m=i.values(),_=(Q(u)&&a?i.values(({node:x})=>u.includes(x.dataset.value??"")):[]).map(({index:x})=>x),k=!m.filter(({index:x,node:h})=>{var D;return((D=h.parentElement)==null?void 0:D.dataset.label)===c&&!_.includes(x)}).length,[d,F]=et(n,tt),w=s.useCallback((x={},h=null)=>{var I;const D={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:h,"aria-labelledby":(I=l.current)==null?void 0:I.id,role:"group",...x,...d,style:k?D:void 0}},[d,k]),S=s.useCallback(({id:x,...h}={},D=null)=>({id:x??r,ref:ce(D,l),role:"presentation",...h}),[r]),V=s.useCallback((x={},h=null)=>({ref:h,...x,...F,"data-label":c}),[F,c]);return{label:c,getContainerProps:w,getGroupProps:V,getLabelProps:S}},Re=ie(({className:c,children:n,color:a,h:u,height:i,minH:l,minHeight:r,labelProps:m,...P},v)=>{const{styles:_}=U(),{label:O,getContainerProps:k,getGroupProps:d,getLabelProps:F}=Lt(P);return u??(u=i),l??(l=r),b.jsxs(M.section,{className:ee("ui-select__item","ui-select__item--group",c),__css:{color:a,h:"fit-content",w:"100%"},...k(),children:[b.jsx(M.header,{className:"ui-select__item__group-label",lineClamp:1,__css:_.groupLabel,...F(m),children:O}),b.jsx(M.div,{...d({},v),className:"ui-select__item__group",__css:{h:u,minH:l,..._.group},children:n})]})});Re.displayName="OptionGroup";Re.__ui__="OptionGroup";const{DescendantsContextProvider:Qt,useDescendant:Tt,useDescendants:At,useDescendantsContext:nt}=kt(),[es,U]=bt({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),ts=c=>{var Xe,Ze;const{animation:n,boundary:a,children:u,closeDelay:i,closeOnBlur:l=!0,closeOnEsc:r=!0,closeOnSelect:m=!0,defaultIsOpen:P,defaultValue:v,duration:_=.2,eventListeners:O,flip:k,gutter:d,isLazy:F,isOpen:w,items:S=[],lazyBehavior:V,matchWidth:x=!0,maxSelectValues:h,modifiers:D,offset:I,omitSelectedValues:g=!1,openDelay:re,placeholder:J,placeholderInOptions:H=!0,placement:te="bottom-start",preventOverflow:Se,strategy:ue,value:de,optionProps:ye,onChange:W,onClose:z,onOpen:X,...N}=Dt(c),{"aria-readonly":Oe,...R}=vt(N,Et),[A,pe]=et(Ct(N,["aria-readonly"]),tt),p=At(),[G,y]=s.useState(-1),[Te,Ae]=s.useState(!1),fe=s.useRef(null),Be=s.useRef(null),Me=s.useRef(null),q=s.useRef(new Set([])),[E,me]=Pt({defaultValue:v,value:de,onChange:W}),[Z,Ie]=s.useState(void 0),xe=!!J&&H,se=G>-1,C=Q(E),He=(C?!E.length:!E)&&!xe,K=p.values(({node:e})=>C&&E.includes(e.dataset.value??"")).map(({index:e})=>e),B=p.enabledValues(({index:e})=>!K.includes(e)),Ge=(Xe=p.value(G))==null?void 0:Xe.node.id,Ke=(Ze=Me.current)==null?void 0:Ze.id,he=st(u),Ue=s.useMemo(()=>!he.length&&S.length?S.map((e,t)=>{if("value"in e){const{label:o,value:j,...Y}=e;return b.jsx(_e,{value:j,...Y,children:o},t)}else if("items"in e){const{items:o=[],label:j,...Y}=e;return b.jsx(Re,{label:j,...Y,children:o.map(({label:Ee,value:Ce,...Fe},oe)=>b.jsx(_e,{value:Ce,...Fe,children:Ee},oe))},t)}}).filter(Boolean):he,[he,S]),Pe=!he.length&&!Ue.length&&(C?!0:!xe),be=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledFirstValue();if(t)if(!C||!g)y(t.index);else if(K.includes(t.index)){const o=B[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[p,B,C,g,K]),ve=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledLastValue();if(t)if(!C||!g)y(t.index);else if(K.includes(t.index)){const o=B.reverse()[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[p,B,C,g,K]),ke=s.useCallback(()=>{const e=setTimeout(()=>{const o=p.enabledValues().find(({node:j})=>C?E.includes(j.dataset.value??""):j.dataset.value===E);o&&y(o.index)});q.current.add(e)},[p,C,E]),ne=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledNextValue(G);if(t)if(!C||!g)y(t.index);else if(K.includes(t.index)){const o=B.find(({index:j})=>t.index<j)??B[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[p,B,G,C,g,K,y]),je=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledPrevValue(G);if(t)if(!C||!g)y(t.index);else if(K.includes(t.index)){const o=B.reverse().find(({index:j})=>j<t.index)??B[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[p,B,G,C,g,K,y]),$=He||g?be:ke,$e=He||g?ve:ke,at=s.useCallback(e=>{const t=p.values();if(!t.length)return;const j=(Q(e)?e:[e]).map(Y=>{const{index:Ee,node:Ce}=t.find(({node:oe})=>oe.dataset.value===Y)??{};if(!Ce||xe&&Ee===0)return;const{innerHTML:Fe}=Array.from(Ce.children).find(oe=>oe.getAttribute("data-label")!==null)??{};return Fe}).filter(Y=>!Ve(Y));Ie(C?j:j[0])},[p,C,xe]),we=s.useCallback(e=>{me(t=>Q(t)?t.includes(e)?t.filter(j=>j!==e):[...t,e]:e)},[me]),ct=s.useCallback(e=>{e.stopPropagation(),me([]),Ie(void 0)},[Ie,me]),{isOpen:f,onClose:L,onOpen:ze}=jt({defaultIsOpen:P,isOpen:w,onClose:z,onOpen:X}),T=s.useCallback(()=>{R.disabled||R.readOnly||Pe||Te||ze()},[R,Pe,Te,ze]),De=s.useCallback(()=>{let e=p.value(G);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";we(t),m&&L(),g&&ne()},[m,p,G,g,we,L,ne]),qe=s.useCallback(()=>{f||(T(),$())},[f,$,T]),Ye=s.useCallback(()=>{f||(T(),$())},[f,$,T]),Je=s.useCallback(e=>{const t=gt(e);_t(fe.current,t)||l&&f&&L()},[l,f,L]),We=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),R.disabled||R.readOnly)return;const o={ArrowDown:se?()=>ne():f?void 0:ge(T,$),ArrowUp:se?()=>je():f?void 0:ge(T,$e),End:f?ve:void 0,Enter:se?De:f?void 0:ge(T,$),Escape:r?L:void 0,Home:f?be:void 0,Space:se?De:f?void 0:ge(T,$)}[e.key];o&&(e.preventDefault(),e.stopPropagation(),o())},[R.disabled,R.readOnly,se,f,T,$,$e,De,be,ve,r,L,ne,je]);wt({ref:fe,enabled:f&&l,handler:L}),s.useEffect(()=>{if(!C||!g&&Ve(h))return;const e=E.length>0&&E.length===p.count(),t=E.length===h;e||t?(L(),Ae(!0)):Ae(!1)},[g,E,p,C,L,h]),St(()=>{at(E)},[E]),yt(()=>{f||y(-1)},[f]),Ot(()=>{q.current.forEach(e=>clearTimeout(e)),q.current.clear()});const it=s.useCallback(e=>({animation:n,boundary:a,closeDelay:i,closeOnBlur:l,duration:_,eventListeners:O,flip:k,gutter:d,isLazy:F,lazyBehavior:V,matchWidth:x,modifiers:D,offset:I,openDelay:re,placement:te,preventOverflow:Se,strategy:ue,...e,closeOnButton:!1,isOpen:f,trigger:"never",onClose:L,onOpen:T}),[l,re,i,F,V,n,_,I,d,Se,k,x,a,O,ue,te,D,f,T,L]),rt=s.useCallback((e={},t=null)=>({ref:ce(fe,t),...A,...e,...R,onBlur:le(e.onBlur,N.onBlur,Je),onClick:le(e.onClick,N.onClick,qe)}),[A,R,Je,qe,N]),ut=s.useCallback(({"aria-label":e,...t}={},o=null)=>(e??(e=J??`Select ${C?"one or more options.":"an option."}`),{ref:ce(Be,o),"aria-activedescendant":Ge,"aria-controls":Ke,"aria-expanded":f,"aria-haspopup":"listbox","aria-label":e,role:"combobox",tabIndex:0,...pe,...t,"data-active":ae(f),"data-placeholder":ae(C?!(Z!=null&&Z.length):Z===void 0),onFocus:le(t.onFocus,N.onFocus,Ye),onKeyDown:le(t.onKeyDown,N.onKeyDown,We)}),[Ge,Ke,pe,f,C,Z,J,N,Ye,We]);return{children:Ue,closeOnSelect:m,containerRef:fe,descendants:p,fieldRef:Be,focusedIndex:G,isEmpty:Pe,isOpen:f,label:Z,listRef:Me,omitSelectedValues:g,placeholder:J,placeholderInOptions:H,setFocusedIndex:y,value:E,formControlProps:R,getContainerProps:rt,getFieldProps:ut,getPopoverProps:it,optionProps:ye,onChange:we,onClear:ct,onClose:L,onFocusFirst:be,onFocusLast:ve,onFocusNext:ne,onFocusPrev:je,onFocusSelected:ke,onOpen:T}},Le=ie(({className:c,children:n,__css:a,...u},i)=>{const{styles:l}=U(),r={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...l.icon,...a},P=st(n).map(v=>s.cloneElement(v,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return b.jsx(M.div,{ref:i,className:ee("ui-select__icon",c),__css:r,...u,children:It(n)?P:b.jsx(pt,{})})});Le.displayName="SelectIcon";Le.__ui__="SelectIcon";const ot=({className:c,children:n,...a})=>{const u=s.useRef(null),{styles:i}=U(),l=a.disabled,r=dt({ref:u,isDisabled:l,...a});return b.jsx(Le,{className:ee("ui-select__clear-icon",c),"aria-label":"Clear value",__css:i.clearIcon,...r,children:n??b.jsx(ft,{h:"0.5em",w:"0.5em"})})};ot.displayName="SelectClearIcon";ot.__ui__="SelectClearIcon";const Bt=()=>{const{focusedIndex:c,listRef:n,value:a}=U(),u=nt(),i=s.useId(),l=s.useRef(-1),r=u.value(c),m=Q(a);return s.useEffect(()=>{if(!n.current||!r||l.current===r.index)return;const v=n.current,_=r.node,O=v.clientHeight,k=v.scrollTop,d=k+O,F=_.clientHeight,w=_.offsetTop,S=w+F,V=k<=w&&S<=d,x=l.current<r.index;V||(S<=O?n.current.scrollTo({top:0}):x?n.current.scrollTo({top:S-O}):n.current.scrollTo({top:w+1})),l.current=r.index},[n,r]),{getListProps:s.useCallback(({id:v,..._}={},O=null)=>({id:v??i,ref:ce(n,O),"aria-multiselectable":Qe(m),position:"relative",role:"listbox",tabIndex:-1,..._}),[i,m,n])}},lt=ie(({className:c,children:n,footer:a,header:u,maxW:i,maxWidth:l,minW:r,minWidth:m,w:P,width:v,contentProps:_,...O},k)=>{var w,S,V,x,h,D;const{styles:d}=U(),{getListProps:F}=Bt();return v??(v=P),v??(v=((w=d.list)==null?void 0:w.width)??((S=d.list)==null?void 0:S.w)),m??(m=r),m??(m=((V=d.list)==null?void 0:V.minWidth)??((x=d.list)==null?void 0:x.minW)),l??(l=i),l??(l=((h=d.list)==null?void 0:h.maxWidth)??((D=d.list)==null?void 0:D.maxW)),b.jsxs(Ft,{className:"ui-select__content",maxWidth:l,minWidth:m,width:v,__css:{...d.content,maxWidth:l,minWidth:m,width:v},..._,children:[u?b.jsx(M.header,{className:"ui-select__header",__css:{...d.header},children:u}):null,b.jsx(M.div,{className:ee("ui-select__list",c),__css:{...d.list},...F(O,k),children:n}),a?b.jsx(M.footer,{className:"ui-select__footer",__css:{...d.footer},children:a}):null]})});lt.displayName="SelectList";lt.__ui__="SelectList";export{_e as O,Qt as S,es as a,Le as b,lt as c,U as d,Re as e,ot as f,ts as u};
