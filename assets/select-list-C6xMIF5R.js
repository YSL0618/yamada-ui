import{j as S}from"./extends-CwFRzn3r.js";import{r as s}from"./index-BwDkhjyp.js";import{f as oe}from"./forward-ref-BWI-Phbn.js";import{o as et,W as tt,V as Ge,a6 as Ke,$ as st,F as Y,af as nt,X as ot,A as Ue,f as lt,S as ct,a as xe,h as ne,d as he,a1 as at,g as it,t as ke,aP as rt,Y as me,b as H,c as Q,p as ut,j as dt}from"./factory-uBtAHRUq.js";import{u as pt}from"./index-CMM3kl6L.js";import{c as ft,a as mt}from"./icon-fUKD81HD.js";import{u as xt}from"./index-B_fkAghs.js";import{c as ht}from"./index-DSunIB56.js";import{u as Ct}from"./index-CdVvibsY.js";import{u as _t}from"./index-B1JaSA3I.js";import{u as gt,f as bt}from"./form-control-k6ikkRb0.js";import{b as vt}from"./popover-trigger-CiVhXs2R.js";const St=a=>{var n;return rt(a)&&!!((n=a.getAttribute("role"))!=null&&n.startsWith("option"))},{DescendantsContextProvider:Gt,useDescendant:yt,useDescendants:Ot,useDescendantsContext:$e}=ht(),[Kt,U]=et({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),Ut=a=>{const{animation:n,boundary:o,closeDelay:r,closeOnBlur:l=!0,closeOnEsc:c=!0,closeOnSelect:x=!0,defaultIsOpen:g,defaultValue:P,duration:m=.2,eventListeners:h,flip:b,gutter:j,isEmpty:d,isLazy:D,isOpen:p,lazyBehavior:y,matchWidth:C=!0,maxSelectValues:L,modifiers:v,offset:G,omitSelectedValues:O=!1,openDelay:le,placeholder:$,placeholderInOptions:R=!0,placement:Z="bottom-start",preventOverflow:Ce,strategy:ce,value:ae,optionProps:_e,onChange:q,onClose:De,onOpen:z,...F}=gt(a),{"aria-readonly":ge,...E}=tt(F,bt),[A,ie]=Ge(st(F,["aria-readonly"]),Ke),u=Ot(),[B,I]=s.useState(-1),[Fe,Ee]=s.useState(!1),re=s.useRef(null),Ve=s.useRef(null),Ne=s.useRef(null),X=s.useRef(new Set([])),[V,ue]=xt({defaultValue:P,value:ae,onChange:q}),[J,be]=s.useState(void 0),ee=B>-1,_=Y(V),Te=(_?!V.length:!V)&&!($&&R),K=u.values(({node:e})=>_&&V.includes(e.dataset.value??"")).map(({index:e})=>e),M=u.enabledValues(({index:e})=>!K.includes(e)),de=s.useCallback(()=>{const e=setTimeout(()=>{const t=u.enabledFirstValue();if(t)if(!_||!O)I(t.index);else if(K.includes(t.index)){const i=M[0];I((i==null?void 0:i.index)??-1)}else I(t.index)});X.current.add(e)},[u,M,_,O,K]),pe=s.useCallback(()=>{const e=setTimeout(()=>{const t=u.enabledLastValue();if(t)if(!_||!O)I(t.index);else if(K.includes(t.index)){const i=M.reverse()[0];I((i==null?void 0:i.index)??-1)}else I(t.index)});X.current.add(e)},[u,M,_,O,K]),ve=s.useCallback(()=>{const e=setTimeout(()=>{const i=u.enabledValues().find(({node:w})=>_?V.includes(w.dataset.value??""):w.dataset.value===V);i&&I(i.index)});X.current.add(e)},[u,_,V]),te=s.useCallback(()=>{const e=setTimeout(()=>{const t=u.enabledNextValue(B);if(t)if(!_||!O)I(t.index);else if(K.includes(t.index)){const i=M.find(({index:w})=>t.index<w)??M[0];I((i==null?void 0:i.index)??-1)}else I(t.index)});X.current.add(e)},[u,M,B,_,O,K,I]),Se=s.useCallback(()=>{const e=setTimeout(()=>{const t=u.enabledPrevValue(B);if(t)if(!_||!O)I(t.index);else if(K.includes(t.index)){const i=M.reverse().find(({index:w})=>w<t.index)??M[0];I((i==null?void 0:i.index)??-1)}else I(t.index)});X.current.add(e)},[u,M,B,_,O,K,I]),W=Te||O?de:ve,Re=Te||O?pe:ve,ye=s.useCallback((e,t=!0)=>{const i=u.values();if(!i.length)return;const w=i.filter(({node:k})=>k.dataset.value===e).map(({index:k,node:se})=>{if(!($&&R)||k!==0){const fe=Array.from(se.children).find(Pe=>Pe.getAttribute("data-label")!==null);return(fe==null?void 0:fe.innerHTML)??""}else return});be(k=>_?(w.forEach(se=>{Y(k)&&k.includes(se??"")?t&&(k=Y(k)?k.filter(Pe=>Pe!==se):void 0):k=[...Y(k)?k:[],se]}),k):w[0])},[u,_,$,R]),Oe=s.useCallback(e=>{ue(t=>Y(t)?t.includes(e)?t.filter(w=>w!==e):[...t,e]:e),ye(e)},[ye,ue]),qe=s.useCallback(e=>{e.stopPropagation(),ue([]),be(void 0)},[be,ue]),{isOpen:f,onClose:N,onOpen:Ae}=Ct({defaultIsOpen:g,isOpen:p,onClose:De,onOpen:z}),T=s.useCallback(()=>{E.disabled||E.readOnly||d||Fe||Ae()},[E,d,Fe,Ae]),Ie=s.useCallback(()=>{let e=u.value(B);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";Oe(t),x&&N(),O&&te()},[x,u,B,O,Oe,N,te]),Le=s.useCallback(()=>{f||(T(),W())},[f,W,T]),Be=s.useCallback(()=>{f||(T(),W())},[f,W,T]),Me=s.useCallback(e=>{const t=nt(e);ot(re.current,t)||l&&f&&N()},[l,f,N]),He=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),E.disabled||E.readOnly)return;const i={ArrowDown:ee?()=>te():f?void 0:me(T,W),ArrowUp:ee?()=>Se():f?void 0:me(T,Re),End:f?pe:void 0,Enter:ee?Ie:f?void 0:me(T,W),Escape:c?N:void 0,Home:f?de:void 0,Space:ee?Ie:f?void 0:me(T,W)}[e.key];i&&(e.preventDefault(),e.stopPropagation(),i())},[E.disabled,E.readOnly,ee,f,T,W,Re,Ie,de,pe,c,N,te,Se]);_t({ref:re,enabled:f&&l,handler:N}),s.useEffect(()=>{if(!_||!O&&Ue(L))return;const e=V.length>0&&V.length===u.count(),t=V.length===L;e||t?(N(),Ee(!0)):Ee(!1)},[O,V,u,_,N,L]),lt(()=>{f||I(-1)},[f]),ct(()=>{X.current.forEach(e=>clearTimeout(e)),X.current.clear()});const Je=s.useCallback(e=>({animation:n,boundary:o,closeDelay:r,closeOnBlur:l,duration:m,eventListeners:h,flip:b,gutter:j,isLazy:D,lazyBehavior:y,matchWidth:C,modifiers:v,offset:G,openDelay:le,placement:Z,preventOverflow:Ce,strategy:ce,...e,closeOnButton:!1,isOpen:f,trigger:"never",onClose:N,onOpen:T}),[l,le,r,D,y,n,m,G,j,Ce,b,C,o,h,ce,Z,v,f,T,N]),Qe=s.useCallback((e={},t=null)=>({ref:xe(re,t),...A,...e,...E,onBlur:ne(e.onBlur,F.onBlur,Me),onClick:ne(e.onClick,F.onClick,Le)}),[A,E,Me,Le,F]),Ze=s.useCallback(({"aria-label":e,...t}={},i=null)=>{var w,k;return e??(e=$??`Select ${_?"one or more options.":"an option."}`),{ref:xe(Ve,i),"aria-label":e,role:"combobox",tabIndex:0,...ie,...t,"aria-activedescendant":(w=u.value(B))==null?void 0:w.node.id,"aria-controls":(k=Ne.current)==null?void 0:k.id,"aria-expanded":f,"data-active":he(f),"data-placeholder":he(_?!(J!=null&&J.length):J===void 0),onFocus:ne(t.onFocus,F.onFocus,Be),onKeyDown:ne(t.onKeyDown,F.onKeyDown,He)}},[u,ie,B,f,_,J,$,F,Be,He]);return{closeOnSelect:x,containerRef:re,descendants:u,fieldRef:Ve,focusedIndex:B,isOpen:f,label:J,listRef:Ne,omitSelectedValues:O,placeholder:$,placeholderInOptions:R,setFocusedIndex:I,value:V,formControlProps:E,getContainerProps:Qe,getFieldProps:Ze,getPopoverProps:Je,optionProps:_e,onChange:Oe,onChangeLabel:ye,onClear:qe,onClose:N,onFocusFirst:de,onFocusLast:pe,onFocusNext:te,onFocusPrev:Se,onFocusSelected:ve,onOpen:T}},It=()=>{const{focusedIndex:a,listRef:n,value:o}=U(),r=$e(),l=s.useRef(-1),c=r.value(a),x=Y(o);s.useEffect(()=>{if(!n.current||!c||l.current===c.index)return;const m=n.current,h=c.node,b=m.clientHeight,j=m.scrollTop,d=j+b,D=h.clientHeight,p=h.offsetTop,y=p+D,C=j<=p&&y<=d,L=l.current<c.index;C||(y<=b?n.current.scrollTo({top:0}):L?n.current.scrollTo({top:y-b}):n.current.scrollTo({top:p+1})),l.current=c.index},[n,c]);const g=s.useId();return{getListProps:s.useCallback((m={},h=null)=>({id:g,ref:xe(n,h),"aria-multiselectable":ke(x),position:"relative",role:"listbox",tabIndex:-1,...m}),[g,x,n])}},Pt=({label:a,...n})=>{const{omitSelectedValues:o,value:r}=U(),l=Y(r),c=$e(),x=c.values(),P=(l&&o?c.values(({node:p})=>r.includes(p.dataset.value??"")):[]).map(({index:p})=>p),h=!x.filter(({index:p,node:y})=>{var C;return((C=y.parentElement)==null?void 0:C.dataset.label)===a&&!P.includes(p)}).length,[b,j]=Ge(n,Ke),d=s.useCallback((p={},y=null)=>({ref:y,...p,...b,style:h?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0}),[b,h]),D=s.useCallback(({"aria-label":p,...y}={},C=null)=>(p??(p=a),{ref:C,"aria-label":p,role:"group",...y,...j,"data-label":a}),[j,a]);return{label:a,getContainerProps:d,getGroupProps:D}},kt=a=>{const{closeOnSelect:n,fieldRef:o,focusedIndex:r,omitSelectedValues:l,placeholder:c,placeholderInOptions:x,setFocusedIndex:g,value:P,optionProps:m,onChange:h,onChangeLabel:b,onClose:j,onFocusNext:d}=U();let{children:D,closeOnSelect:p,icon:y,isDisabled:C,isFocusable:L,value:v,...G}={...m,...a};const O=!!C&&!L,le=s.useRef(null),{descendants:$,index:R,register:Z}=yt({disabled:O}),ce=$.values().slice(0,R),ae=!!c&&x,_e=ae&&R===0,q=Y(P);!_e&&Ue(v)&&(at(D)||it(D)?v=D.toString():console.warn(`${q?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),ae&&R>0&&!v&&console.warn(`${q?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const z=!(q?!1:ce.some(({node:A})=>A.dataset.value===(v??"")))&&(q?P.includes(v??""):(v??"")===P),F=R===r,ge=s.useCallback(A=>{if(A.preventDefault(),A.stopPropagation(),C){o.current&&o.current.focus();return}if(!St(A.currentTarget)){o.current&&o.current.focus();return}g(R),h(v??""),o.current&&o.current.focus(),(p??n)&&j(),l&&d()},[C,g,R,h,v,o,p,n,j,l,d]);s.useEffect(()=>{z&&b(v??"",!1)},[v,z,b]);const E=s.useCallback((A={},ie=null)=>{const u={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:xe(le,ie,Z),role:"option",...G,...A,style:l&&z?u:void 0,"aria-checked":ke(z),"aria-disabled":ke(C),"data-disabled":he(C),"data-focus":he(F),"data-value":v??"",tabIndex:-1,onClick:ne(G.onClick,A.onClick,ge)}},[v,G,C,F,z,l,ge,Z]);return{children:D,customIcon:y,isFocused:F,isSelected:z,getOptionProps:E}},ze=oe(({id:a,className:n,icon:o,...r},l)=>{const{styles:c}=U(),{children:x,customIcon:g,isSelected:P,getOptionProps:m}=kt(r),h=s.useId();a??(a=h),o??(o=g);const b={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...c.item};return S.jsxs(H.li,{id:a,className:Q("ui-select__item",n),__css:b,...m({},l),children:[o!==null?S.jsx(je,{opacity:P?1:0,children:o||S.jsx(jt,{})}):null,S.jsx(H.span,{style:{flex:1},"data-label":!0,children:x})]})});ze.displayName="Option";ze.__ui__="Option";const je=oe(({className:a,...n},o)=>{const{styles:r}=U(),l={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...r.itemIcon};return S.jsx(H.span,{ref:o,className:Q("ui-select__item__icon",a),__css:l,...n})});je.displayName="OptionIcon";je.__ui__="OptionIcon";const jt=()=>S.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:S.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),We=oe(({className:a,children:n,color:o,h:r,height:l,minH:c,minHeight:x,labelProps:g,...P},m)=>{const{styles:h}=U(),{label:b,getContainerProps:j,getGroupProps:d}=Pt(P);return r??(r=l),c??(c=x),S.jsxs(H.li,{className:Q("ui-select__item","ui-select__item--group",a),__css:{color:o,h:"fit-content",w:"100%"},...j(),children:[S.jsx(H.span,{className:"ui-select__item__group-label",lineClamp:1,__css:h.groupLabel,...g,children:b}),S.jsx(H.ul,{...d({},m),className:"ui-select__item__group",__css:{h:r,minH:c,...h.group},children:n})]})});We.displayName="OptionGroup";We.__ui__="OptionGroup";const we=oe(({className:a,children:n,__css:o,...r},l)=>{const{styles:c}=U(),x={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...c.icon,...o},P=ut(n).map(m=>s.cloneElement(m,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return S.jsx(H.div,{ref:l,className:Q("ui-select__icon",a),__css:x,...r,children:dt(n)?P:S.jsx(ft,{})})});we.displayName="SelectIcon";we.__ui__="SelectIcon";const Ye=({className:a,children:n,...o})=>{const r=s.useRef(null),{styles:l}=U(),c=o.disabled,x=pt({ref:r,isDisabled:c,...o});return S.jsx(we,{className:Q("ui-select__clear-icon",a),"aria-label":"Clear value",__css:l.clearIcon,...x,children:n??S.jsx(mt,{h:"0.5em",w:"0.5em"})})};Ye.displayName="SelectClearIcon";Ye.__ui__="SelectClearIcon";const Xe=oe(({className:a,children:n,footer:o,header:r,maxW:l,maxWidth:c,minW:x,minWidth:g,w:P,width:m,contentProps:h,...b},j)=>{var p,y,C,L,v,G;const{styles:d}=U(),{getListProps:D}=It();return m??(m=P),m??(m=((p=d.list)==null?void 0:p.width)??((y=d.list)==null?void 0:y.w)),g??(g=x),g??(g=((C=d.list)==null?void 0:C.minWidth)??((L=d.list)==null?void 0:L.minW)),c??(c=l),c??(c=((v=d.list)==null?void 0:v.maxWidth)??((G=d.list)==null?void 0:G.maxW)),S.jsxs(vt,{as:"div",className:"ui-select__content",maxWidth:c,minWidth:g,width:m,__css:{...d.content,maxWidth:c,minWidth:g,width:m},...h,children:[r?S.jsx(H.div,{className:"ui-select__header",__css:{...d.header},children:r}):null,S.jsx(H.ul,{className:Q("ui-select__list",a),__css:{...d.list},...D(b,j),children:n}),o?S.jsx(H.div,{className:"ui-select__footer",__css:{...d.footer},children:o}):null]})});Xe.displayName="SelectList";Xe.__ui__="SelectList";export{ze as O,Gt as S,We as a,Kt as b,we as c,Xe as d,U as e,Ye as f,Ut as u};
