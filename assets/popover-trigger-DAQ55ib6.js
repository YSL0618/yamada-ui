import{j as k}from"./jsx-runtime-CfatFE5O.js";import{r as t}from"./index-ClcD9ViR.js";import{C as ge}from"./close-button-DENBYMYY.js";import{f as Pe}from"./forward-ref-D13m8o2p.js";import{y as Ce,a as J,h as u,I as ye,aq as K,a3 as x,c as ne,A as be,at as he,b as Re,a4 as xe}from"./factory-Dfrbb1EY.js";import{s as X}from"./slide-fade-CQuVyWIS.js";import{s as Be}from"./scale-fade-D-TPukYR.js";import{m as _e}from"./forward-ref-2BKBy0Yi.js";import{m as Te}from"./factory-DeSWW4o7.js";import{b as Oe}from"./index-BN23OaLZ.js";import{u as we,b as Ee}from"./index-DykZTIMV.js";import{u as Fe,a as ke,b as Me}from"./index-BVP762bF.js";import{u as De}from"./index-CFtnIMNb.js";import{a as Ae}from"./use-component-style-fOirb5M1.js";import{o as je}from"./theme-provider-DSx3k1bh.js";const[Ne,Q]=Ce({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),re=p=>{const[c,n]=Ae("Popover",p);let{animation:B="scale",autoFocus:P=!0,children:C,closeDelay:d=200,closeOnBlur:f=!0,closeOnButton:_=!0,closeOnEsc:M=!0,duration:T,initialFocusRef:q,isLazy:H,isOpen:D,lazy:A,lazyBehavior:j="unmount",open:N,openDelay:S=200,relatedRef:y,restoreFocus:O=!0,trigger:l="click",...U}=je(n);A??(A=H),N??(N=D);const b=t.useId(),{isOpen:o,onClose:r,onOpen:R,onToggle:I}=we({...n,isOpen:N}),w=t.useRef(null),s=t.useRef(null),L=t.useRef(null),W=t.useRef(null),v=t.useRef(null),{present:ue,onAnimationComplete:le}=Oe({ref:v,isOpen:o}),h=t.useRef(void 0),V=t.useRef(void 0),E=t.useRef(!1),Z=t.useRef(!1),{forceUpdate:$,referenceRef:z,transformOrigin:ee,getPopperProps:ae}=De({...U,enabled:o});o&&(Z.current=!0),t.useEffect(()=>()=>{h.current&&clearTimeout(h.current),V.current&&clearTimeout(V.current)},[]),Fe({ref:s,enabled:o}),ke(v,{focusRef:s,shouldFocus:O&&(l==="click"||l==="contextmenu"),visible:o}),Me(v,{focusRef:q,shouldFocus:P&&(l==="click"||l==="contextmenu"),visible:o});const oe=Ee({enabled:A,isSelected:ue,mode:j,wasSelected:Z.current}),ce=t.useCallback((e={},F=null)=>{var a,g;const i={id:b,"aria-describedby":(a=W.current)==null?void 0:a.id,"aria-hidden":!o,"aria-labelledby":(g=L.current)==null?void 0:g.id,role:"dialog",...e,ref:J(v,F),style:{...e.style,transformOrigin:ee},children:oe?e.children:null,tabIndex:-1,onBlur:u(e.onBlur,m=>{const G=K(m),pe=x(v.current,G),de=x(s.current,G),ve=y!=null&&y.current?x(y.current,G):!1;o&&f&&(!pe&&!de&&!ve)&&r()}),onKeyDown:u(e.onKeyDown,m=>{M&&m.key==="Escape"&&r()})};return l==="hover"&&(i.onMouseEnter=u(e.onMouseEnter,()=>{E.current=!0}),i.onMouseLeave=u(e.onMouseLeave,m=>{m.nativeEvent.relatedTarget!==null&&(E.current=!1,f&&setTimeout(r,d))})),i},[d,f,M,o,r,oe,ee,l,y,b]),te=t.useCallback(e=>{w.current==null&&z(e)},[z]),fe=t.useCallback((e={},F=null)=>{const i={"aria-controls":o?b:void 0,"aria-expanded":o,role:"button",...e,ref:J(s,F,te)};return l==="click"&&(i.onClick=u(e.onClick,I),i.onBlur=u(e.onBlur,a=>{const g=K(a),m=!x(v.current,g);o&&f&&m&&r()})),l==="contextmenu"&&(i.onContextMenu=u(e.onContextMenu,a=>{a.preventDefault(),R()}),i.onBlur=u(e.onBlur,a=>{const g=K(a),m=!x(v.current,g);o&&f&&m&&r()})),l==="hover"&&(i.onFocus=u(e.onFocus,()=>{h.current===void 0&&R()}),i.onBlur=u(e.onBlur,a=>{const g=K(a),m=!x(v.current,g);o&&f&&m&&r()}),i.onKeyDown=u(e.onKeyDown,a=>{a.key==="Escape"&&r()}),i.onMouseEnter=u(e.onMouseEnter,()=>{E.current=!0,h.current=window.setTimeout(R,S)}),i.onMouseLeave=u(e.onMouseLeave,()=>{E.current=!1,h.current&&(clearTimeout(h.current),h.current=void 0),V.current=window.setTimeout(()=>{E.current||r()},d)})),i},[d,f,o,te,r,R,I,S,l,b]),me=t.useCallback((e={},F=null)=>({...e,ref:J(F,w,z)}),[w,z]);return k.jsx(Ne,{value:{id:b,animation:B,bodyRef:W,closeOnButton:_,duration:T,forceUpdate:$,headerRef:L,open:o,styles:c,getAnchorProps:me,getPopoverProps:ce,getPopperProps:ae,getTriggerProps:fe,onAnimationComplete:le,onClose:r},children:ye(C,{forceUpdate:$,open:o,onClose:r})})};re.displayName="Popover";re.__ui__="Popover";const Y=Pe(({onClick:p,...c},n)=>{const{id:B,styles:P,onClose:C}=Q(),d={position:"absolute",...P.closeButton};return k.jsx(ge,{ref:n,className:ne("ui-popover__close-button"),size:"sm","aria-controls":B,"aria-label":"Close popover",onClick:u(p,f=>{f.stopPropagation(),C==null||C()}),__css:d,...c})});Y.displayName="PopoverCloseButton";Y.__ui__="PopoverCloseButton";const Se=(p="scale",c)=>{const n={duration:c,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(p){case"scale":return{...Be,custom:{...n,scale:.95}};case"top":return{...X,custom:{...n,offsetX:0,offsetY:-16}};case"right":return{...X,custom:{...n,offsetX:16,offsetY:0}};case"left":return{...X,custom:{...n,offsetX:-16,offsetY:0}};case"bottom":return{...X,custom:{...n,offsetX:0,offsetY:16}}}},se=_e(({as:p="section",className:c,children:n,maxW:B,maxWidth:P,minW:C,minWidth:d,w:f,width:_,z:M,zIndex:T,containerProps:q,__css:H,...D},A)=>{let{animation:j,closeOnButton:N,duration:S,isOpen:y,open:O,styles:l,getPopoverProps:U,getPopperProps:b,onAnimationComplete:o}=Q();O??(O=y);const r=be(n),[R,...I]=he(r,Y),w=t.useMemo(()=>Te(p),[p]),s=H??l.container??{},L={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...s};return _??(_=f),_??(_=s.width??s.w),d??(d=C),d??(d=s.minWidth??s.minW),P??(P=B),P??(P=s.maxWidth??s.maxW),T??(T=M),T??(T=s.zIndex??s.z),k.jsx(Re.div,{...b({style:{visibility:O?"visible":"hidden"}}),className:"ui-popover",maxWidth:P,minWidth:d,outline:"none",width:_,zIndex:T,...q,children:k.jsxs(w,{className:ne("ui-popover__content",c),...j!=="none"?Se(j,S):{},...U(D,A),animate:O?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:xe(o,D.onAnimationComplete),__css:L,children:[R??(N?k.jsx(Y,{}):null),I]})})});se.displayName="PopoverContent";se.__ui__="PopoverContent";const ie=({children:p})=>{const c=t.Children.only(p),{getTriggerProps:n}=Q();return t.cloneElement(c,n(c.props,c.ref))};ie.displayName="PopoverTrigger";ie.__ui__="PopoverTrigger";export{re as P,ie as a,se as b,Y as c,Q as u};
