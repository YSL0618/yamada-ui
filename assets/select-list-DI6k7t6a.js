import{j as x}from"./extends-CwFRzn3r.js";import{u as at}from"./index-Dxg_d1YV.js";import{r as s}from"./index-BwDkhjyp.js";import{c as it,a as rt}from"./icon-A2vzomTu.js";import{f as ae}from"./forward-ref-BWI-Phbn.js";import{A as Ve,a1 as ut,g as dt,a as _e,t as Ee,d as ce,h as le,aP as pt,F as Q,b as B,c as Z,V as qe,a6 as Je,o as ft,W as mt,$ as xt,p as Qe,af as ht,X as vt,u as Ct,f as bt,S as gt,Y as ge,j as _t}from"./factory-DkiAY2ad.js";import{u as St}from"./index-DRj4BzjX.js";import{c as yt}from"./index-DqrMJzUo.js";import{u as Ot}from"./index-j2RJanVS.js";import{u as It}from"./index-CZa1003m.js";import{u as Pt,f as kt}from"./form-control-DNyBYrpi.js";import{b as jt}from"./popover-trigger-BG4L6yxJ.js";const wt=a=>{var n;return pt(a)&&!!((n=a.getAttribute("role"))!=null&&n.startsWith("option"))},Dt=a=>{const{closeOnSelect:n,fieldRef:c,focusedIndex:d,omitSelectedValues:i,placeholder:o,placeholderInOptions:g,setFocusedIndex:h,value:P,optionProps:v,onChange:C,onClose:_,onFocusNext:k}=K();let{children:r,closeOnSelect:E,icon:f,isDisabled:u,isFocusable:j,value:S,...N}={...v,...a};const $=!!u&&!j,ie=s.useRef(null),{descendants:O,index:M,register:z}=Et({disabled:$}),re=O.values().slice(0,M),ee=!!o&&g,ue=ee&&M===0,X=Q(P);!ue&&Ve(S)&&(ut(r)||dt(r)?S=r.toString():console.warn(`${X?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),ee&&M>0&&!S&&console.warn(`${X?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const W=X?!1:re.some(({node:H})=>H.dataset.value===(S??"")),q=!W&&(X?P.includes(S??""):(S??"")===P),te=M===d,de=s.useCallback(H=>{if(H.preventDefault(),H.stopPropagation(),u||!wt(H.currentTarget)){c.current&&c.current.focus();return}W||h(M),C(S??""),c.current&&c.current.focus(),(E??n)&&_(),i&&k()},[u,W,h,M,C,S,c,E,n,_,i,k]),T=s.useCallback((H={},D=null)=>{const pe={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:_e(ie,D,z),role:"option",...N,...H,style:i&&q?pe:void 0,"aria-checked":Ee(q),"aria-disabled":Ee(u),"data-disabled":ce(u),"data-duplicated":ce(W),"data-focus":ce(te),"data-value":S??"",tabIndex:-1,onClick:le(N.onClick,H.onClick,de)}},[S,N,u,te,W,q,i,de,z]);return{children:r,customIcon:f,isFocused:te,isSelected:q,getOptionProps:T}},Se=ae(({id:a,className:n,icon:c,...d},i)=>{const{styles:o}=K(),{children:g,customIcon:h,isSelected:P,getOptionProps:v}=Dt(d),C=s.useId();a??(a=C),c??(c=h);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...o.item};return x.jsxs(B.li,{id:a,className:Z("ui-select__item",n),__css:_,...v({},i),children:[c!==null?x.jsx(Ne,{opacity:P?1:0,children:c||x.jsx(Ft,{})}):null,x.jsx(B.span,{style:{flex:1},"data-label":!0,children:g})]})});Se.displayName="Option";Se.__ui__="Option";const Ne=ae(({className:a,...n},c)=>{const{styles:d}=K(),i={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...d.itemIcon};return x.jsx(B.span,{ref:c,className:Z("ui-select__item__icon",a),__css:i,...n})});Ne.displayName="OptionIcon";Ne.__ui__="OptionIcon";const Ft=()=>x.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:x.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Vt=({label:a,...n})=>{const{omitSelectedValues:c,value:d}=K(),i=Q(d),o=Ze(),g=o.values(),P=(i&&c?o.values(({node:f})=>d.includes(f.dataset.value??"")):[]).map(({index:f})=>f),C=!g.filter(({index:f,node:u})=>{var j;return((j=u.parentElement)==null?void 0:j.dataset.label)===a&&!P.includes(f)}).length,[_,k]=qe(n,Je),r=s.useCallback((f={},u=null)=>({ref:u,...f,..._,style:C?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0}),[_,C]),E=s.useCallback(({"aria-label":f,...u}={},j=null)=>(f??(f=a),{ref:j,"aria-label":f,role:"group",...u,...k,"data-label":a}),[k,a]);return{label:a,getContainerProps:r,getGroupProps:E}},Te=ae(({className:a,children:n,color:c,h:d,height:i,minH:o,minHeight:g,labelProps:h,...P},v)=>{const{styles:C}=K(),{label:_,getContainerProps:k,getGroupProps:r}=Vt(P);return d??(d=i),o??(o=g),x.jsxs(B.li,{className:Z("ui-select__item","ui-select__item--group",a),__css:{color:c,h:"fit-content",w:"100%"},...k(),children:[x.jsx(B.span,{className:"ui-select__item__group-label",lineClamp:1,__css:C.groupLabel,...h,children:_}),x.jsx(B.ul,{...r({},v),className:"ui-select__item__group",__css:{h:d,minH:o,...C.group},children:n})]})});Te.displayName="OptionGroup";Te.__ui__="OptionGroup";const{DescendantsContextProvider:Xt,useDescendant:Et,useDescendants:Nt,useDescendantsContext:Ze}=yt(),[qt,K]=ft({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),Jt=a=>{const{animation:n,boundary:c,children:d,closeDelay:i,closeOnBlur:o=!0,closeOnEsc:g=!0,closeOnSelect:h=!0,defaultIsOpen:P,defaultValue:v,duration:C=.2,eventListeners:_,flip:k,gutter:r,isLazy:E,isOpen:f,items:u=[],lazyBehavior:j,matchWidth:S=!0,maxSelectValues:N,modifiers:$,offset:ie,omitSelectedValues:O=!1,openDelay:M,placeholder:z,placeholderInOptions:ye=!0,placement:re="bottom-start",preventOverflow:ee,strategy:ue,value:X,optionProps:W,onChange:q,onClose:te,onOpen:de,...T}=Pt(a),{"aria-readonly":H,...D}=mt(T,kt),[pe,Ae]=qe(xt(T,["aria-readonly"]),Je),m=Nt(),[R,I]=s.useState(-1),[Le,Be]=s.useState(!1),fe=s.useRef(null),Me=s.useRef(null),He=s.useRef(null),Y=s.useRef(new Set([])),[w,me]=St({defaultValue:v,value:X,onChange:q}),[J,Oe]=s.useState(void 0),xe=!!z&&ye,se=R>-1,b=Q(w),Ge=(b?!w.length:!w)&&!xe,G=m.values(({node:e})=>b&&w.includes(e.dataset.value??"")).map(({index:e})=>e),A=m.enabledValues(({index:e})=>!G.includes(e)),he=Qe(d),Ke=s.useMemo(()=>!he.length&&u.length?u.map((e,t)=>{if("value"in e){const{label:l,value:y,...L}=e;return x.jsx(Se,{value:y,...L,children:l},t)}else if("items"in e){const{items:l=[],label:y,...L}=e;return x.jsx(Te,{label:y,...L,children:l.map(({label:De,value:be,...Fe},oe)=>x.jsx(Se,{value:be,...Fe,children:De},oe))},t)}}).filter(Boolean):he,[he,u]),Ie=!he.length&&!Ke.length&&(b?!0:!xe),ve=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledFirstValue();if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=A[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,A,b,O,G]),Ce=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledLastValue();if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=A.reverse()[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,A,b,O,G]),Pe=s.useCallback(()=>{const e=setTimeout(()=>{const l=m.enabledValues().find(({node:y})=>b?w.includes(y.dataset.value??""):y.dataset.value===w);l&&I(l.index)});Y.current.add(e)},[m,b,w]),ne=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledNextValue(R);if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=A.find(({index:y})=>t.index<y)??A[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,A,R,b,O,G,I]),ke=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledPrevValue(R);if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=A.reverse().find(({index:y})=>y<t.index)??A[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,A,R,b,O,G,I]),U=Ge||O?ve:Pe,Ue=Ge||O?Ce:Pe,st=s.useCallback(e=>{const t=m.values();if(!t.length)return;const y=(Q(e)?e:[e]).map(L=>{const{index:De,node:be}=t.find(({node:oe})=>oe.dataset.value===L)??{};if(!be||xe&&De===0)return;const{innerHTML:Fe}=Array.from(be.children).find(oe=>oe.getAttribute("data-label")!==null)??{};return Fe}).filter(L=>!Ve(L));Oe(b?y:y[0])},[m,b,xe]),je=s.useCallback(e=>{me(t=>Q(t)?t.includes(e)?t.filter(y=>y!==e):[...t,e]:e)},[me]),nt=s.useCallback(e=>{e.stopPropagation(),me([]),Oe(void 0)},[Oe,me]),{isOpen:p,onClose:F,onOpen:$e}=Ot({defaultIsOpen:P,isOpen:f,onClose:te,onOpen:de}),V=s.useCallback(()=>{D.disabled||D.readOnly||Ie||Le||$e()},[D,Ie,Le,$e]),we=s.useCallback(()=>{let e=m.value(R);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";je(t),h&&F(),O&&ne()},[h,m,R,O,je,F,ne]),ze=s.useCallback(()=>{p||(V(),U())},[p,U,V]),We=s.useCallback(()=>{p||(V(),U())},[p,U,V]),Ye=s.useCallback(e=>{const t=ht(e);vt(fe.current,t)||o&&p&&F()},[o,p,F]),Xe=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),D.disabled||D.readOnly)return;const l={ArrowDown:se?()=>ne():p?void 0:ge(V,U),ArrowUp:se?()=>ke():p?void 0:ge(V,Ue),End:p?Ce:void 0,Enter:se?we:p?void 0:ge(V,U),Escape:g?F:void 0,Home:p?ve:void 0,Space:se?we:p?void 0:ge(V,U)}[e.key];l&&(e.preventDefault(),e.stopPropagation(),l())},[D.disabled,D.readOnly,se,p,V,U,Ue,we,ve,Ce,g,F,ne,ke]);It({ref:fe,enabled:p&&o,handler:F}),s.useEffect(()=>{if(!b||!O&&Ve(N))return;const e=w.length>0&&w.length===m.count(),t=w.length===N;e||t?(F(),Be(!0)):Be(!1)},[O,w,m,b,F,N]),Ct(()=>{st(w)},[w]),bt(()=>{p||I(-1)},[p]),gt(()=>{Y.current.forEach(e=>clearTimeout(e)),Y.current.clear()});const ot=s.useCallback(e=>({animation:n,boundary:c,closeDelay:i,closeOnBlur:o,duration:C,eventListeners:_,flip:k,gutter:r,isLazy:E,lazyBehavior:j,matchWidth:S,modifiers:$,offset:ie,openDelay:M,placement:re,preventOverflow:ee,strategy:ue,...e,closeOnButton:!1,isOpen:p,trigger:"never",onClose:F,onOpen:V}),[o,M,i,E,j,n,C,ie,r,ee,k,S,c,_,ue,re,$,p,V,F]),lt=s.useCallback((e={},t=null)=>({ref:_e(fe,t),...pe,...e,...D,onBlur:le(e.onBlur,T.onBlur,Ye),onClick:le(e.onClick,T.onClick,ze)}),[pe,D,Ye,ze,T]),ct=s.useCallback(({"aria-label":e,...t}={},l=null)=>{var y,L;return e??(e=z??`Select ${b?"one or more options.":"an option."}`),{ref:_e(Me,l),"aria-label":e,role:"combobox",tabIndex:0,...Ae,...t,"aria-activedescendant":(y=m.value(R))==null?void 0:y.node.id,"aria-controls":(L=He.current)==null?void 0:L.id,"aria-expanded":p,"data-active":ce(p),"data-placeholder":ce(b?!(J!=null&&J.length):J===void 0),onFocus:le(t.onFocus,T.onFocus,We),onKeyDown:le(t.onKeyDown,T.onKeyDown,Xe)}},[m,Ae,R,p,b,J,z,T,We,Xe]);return{children:Ke,closeOnSelect:h,containerRef:fe,descendants:m,fieldRef:Me,focusedIndex:R,isEmpty:Ie,isOpen:p,label:J,listRef:He,omitSelectedValues:O,placeholder:z,placeholderInOptions:ye,setFocusedIndex:I,value:w,formControlProps:D,getContainerProps:lt,getFieldProps:ct,getPopoverProps:ot,optionProps:W,onChange:je,onClear:nt,onClose:F,onFocusFirst:ve,onFocusLast:Ce,onFocusNext:ne,onFocusPrev:ke,onFocusSelected:Pe,onOpen:V}},Re=ae(({className:a,children:n,__css:c,...d},i)=>{const{styles:o}=K(),g={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...o.icon,...c},P=Qe(n).map(v=>s.cloneElement(v,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return x.jsx(B.div,{ref:i,className:Z("ui-select__icon",a),__css:g,...d,children:_t(n)?P:x.jsx(it,{})})});Re.displayName="SelectIcon";Re.__ui__="SelectIcon";const et=({className:a,children:n,...c})=>{const d=s.useRef(null),{styles:i}=K(),o=c.disabled,g=at({ref:d,isDisabled:o,...c});return x.jsx(Re,{className:Z("ui-select__clear-icon",a),"aria-label":"Clear value",__css:i.clearIcon,...g,children:n??x.jsx(rt,{h:"0.5em",w:"0.5em"})})};et.displayName="SelectClearIcon";et.__ui__="SelectClearIcon";const Tt=()=>{const{focusedIndex:a,listRef:n,value:c}=K(),d=Ze(),i=s.useRef(-1),o=d.value(a),g=Q(c);s.useEffect(()=>{if(!n.current||!o||i.current===o.index)return;const v=n.current,C=o.node,_=v.clientHeight,k=v.scrollTop,r=k+_,E=C.clientHeight,f=C.offsetTop,u=f+E,j=k<=f&&u<=r,S=i.current<o.index;j||(u<=_?n.current.scrollTo({top:0}):S?n.current.scrollTo({top:u-_}):n.current.scrollTo({top:f+1})),i.current=o.index},[n,o]);const h=s.useId();return{getListProps:s.useCallback((v={},C=null)=>({id:h,ref:_e(n,C),"aria-multiselectable":Ee(g),position:"relative",role:"listbox",tabIndex:-1,...v}),[h,g,n])}},tt=ae(({className:a,children:n,footer:c,header:d,maxW:i,maxWidth:o,minW:g,minWidth:h,w:P,width:v,contentProps:C,..._},k)=>{var f,u,j,S,N,$;const{styles:r}=K(),{getListProps:E}=Tt();return v??(v=P),v??(v=((f=r.list)==null?void 0:f.width)??((u=r.list)==null?void 0:u.w)),h??(h=g),h??(h=((j=r.list)==null?void 0:j.minWidth)??((S=r.list)==null?void 0:S.minW)),o??(o=i),o??(o=((N=r.list)==null?void 0:N.maxWidth)??(($=r.list)==null?void 0:$.maxW)),x.jsxs(jt,{as:"div",className:"ui-select__content",maxWidth:o,minWidth:h,width:v,__css:{...r.content,maxWidth:o,minWidth:h,width:v},...C,children:[d?x.jsx(B.div,{className:"ui-select__header",__css:{...r.header},children:d}):null,x.jsx(B.ul,{className:Z("ui-select__list",a),__css:{...r.list},...E(_,k),children:n}),c?x.jsx(B.div,{className:"ui-select__footer",__css:{...r.footer},children:c}):null]})});tt.displayName="SelectList";tt.__ui__="SelectList";export{Se as O,Xt as S,qt as a,Re as b,tt as c,K as d,Te as e,et as f,Jt as u};
