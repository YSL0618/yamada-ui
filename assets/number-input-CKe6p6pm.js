import{j as x}from"./jsx-runtime-CfatFE5O.js";import{r}from"./index-ClcD9ViR.js";import{t as Re,a as ke,c as Ye}from"./number-CcP_arM8.js";import{p as F,a2 as $e,l as Je,u as Qe,a as ne,C as Ze,h as _,y as et,b as Q,c as K}from"./factory-Dfrbb1EY.js";import{u as tt}from"./index-DqeO0dAp.js";import{u as nt}from"./index-BkQL7q4y.js";import{u as rt,f as st}from"./form-control-C7lyVmHF.js";import{c as Te}from"./icon-DDeGQYl6.js";import{f as U}from"./forward-ref-D13m8o2p.js";import{a as ot}from"./use-component-style-fOirb5M1.js";import{o as at}from"./theme-provider-DSx3k1bh.js";const ut=({keepWithinRange:n=!0,max:o=Number.MAX_SAFE_INTEGER,min:s=Number.MIN_SAFE_INTEGER,...t}={})=>{const u=F(t.onChange),[f,m]=r.useState(()=>t.defaultValue==null?"":re(t.defaultValue,t.step??1,t.precision)??""),p=typeof t.value<"u",a=p?t.value:f,h=je(V(a),t.step??1),v=t.precision??h,d=r.useCallback(i=>{i!==a&&(p||m(i.toString()),u(i.toString(),V(i)))},[u,p,a]),c=r.useCallback(i=>{let l=i;return n&&(l=Ye(l,s,o)),Re(l,v)},[v,n,o,s]),C=r.useCallback((i=t.step??1)=>{let l;a===""?l=V(i):l=V(a)+i,l=c(l),d(l)},[c,t.step,d,a]),P=r.useCallback((i=t.step??1)=>{let l;a===""?l=V(-i):l=V(a)-i,l=c(l),d(l)},[c,t.step,d,a]),M=r.useCallback(()=>{let i;t.defaultValue==null?i="":i=re(t.defaultValue,t.step??1,t.precision)??s,d(i)},[t.defaultValue,t.precision,t.step,d,s]),O=r.useCallback(i=>{const l=re(i,t.step??1,v)??s;d(l)},[v,t.step,d,s]),b=V(a),B=b<s||o<b;return{cast:O,clamp:c,decrement:P,increment:C,isMax:b===o,isMin:b===s,isOut:B,precision:v,reset:M,setValue:m,update:d,value:a,valueAsNumber:b}},V=n=>parseFloat(n.toString().replace(/[^\w.-]+/g,"")),je=(n,o)=>Math.max(ke(o),ke(n)),re=(n,o,s)=>(n=V(n),Number.isNaN(n)?void 0:Re(n,s??je(n,o))),ct=n=>/^[Ee0-9+\-.]$/.test(n),it=({key:n,altKey:o,ctrlKey:s,metaKey:t},u)=>{const f=s||o||t;return!(n.length===1)||f?!0:u(n)},Ae=({ctrlKey:n,metaKey:o,shiftKey:s})=>{let t=1;return(o||n)&&(t=.1),s&&(t=10),t},lt=(n={})=>{let{id:o,name:s,allowMouseWheel:t,clampValueOnBlur:u=!0,defaultValue:f,focusInputOnChange:m=!0,format:p,getAriaValueText:a,inputMode:h="decimal",isValidCharacter:v,keepWithinRange:d=!0,max:c=Number.MAX_SAFE_INTEGER,min:C=Number.MIN_SAFE_INTEGER,parse:P,pattern:M="[0-9]*(.[0-9]+)?",precision:O,step:b,validCharacter:B,value:ce,onChange:ie,onInvalid:i,...l}=rt(n);const{"aria-invalid":le,disabled:D,readOnly:S,required:R,onBlur:Le,onFocus:Ke,...T}=$e(l,st);B??(B=v);const Ue=R,Be=S,Ge=D,[qe,me]=r.useState(!1),G=!(S||D),w=r.useRef(null),q=r.useRef(null),de=r.useRef(null),fe=r.useRef(null),pe=F(_(Ke,e=>{me(!0),q.current&&(e.target.selectionStart=q.current.start??e.currentTarget.value.length,e.currentTarget.selectionEnd=q.current.end??e.currentTarget.selectionStart)})),be=F(_(Le,()=>{me(!1),u&&ze()})),ee=F(i),Ce=F(a),z=F(B??ct),{cast:ge,isMax:Ne,isMin:Ie,isOut:_e,setValue:te,update:L,value:g,valueAsNumber:I,...W}=ut({defaultValue:f,keepWithinRange:d,max:c,min:C,precision:O,step:b,value:ce,onChange:ie}),xe=r.useMemo(()=>{let e=Ce(g);return e??(e=g.toString(),e||void 0)},[g,Ce]),H=r.useCallback(e=>e.split("").filter(z).join(""),[z]),X=r.useCallback(e=>(P==null?void 0:P(e))??e,[P]),j=r.useCallback(e=>((p==null?void 0:p(e))??e).toString(),[p]),Y=r.useCallback((e=b??1)=>{G&&W.increment(e)},[G,W,b]),$=r.useCallback((e=b??1)=>{G&&W.decrement(e)},[G,W,b]),ze=r.useCallback(()=>{let e=g;if(g==="")return;/^[eE]/.test(g.toString())?te(""):(I<C&&(e=C),I>c&&(e=c),ge(e))},[ge,c,C,te,g,I]),ve=r.useCallback(e=>{if(e.nativeEvent.isComposing)return;const N=X(e.currentTarget.value);L(H(N)),q.current={end:e.currentTarget.selectionEnd,start:e.currentTarget.selectionStart}},[X,L,H]),ye=r.useCallback(e=>{if(e.nativeEvent.isComposing)return;it(e,z)||e.preventDefault();const N=Ae(e)*(b??1),y={ArrowDown:()=>$(N),ArrowUp:()=>Y(N),End:()=>L(c),Home:()=>L(C)}[e.key];y&&(e.preventDefault(),y(e))},[$,Y,z,c,C,b,L]),{down:Se,isSpinning:he,stop:E,up:Pe}=dt(Y,$);Me(de,["disabled"],he,E),Me(fe,["disabled"],he,E);const J=r.useCallback(()=>{m&&requestAnimationFrame(()=>{var e;(e=w.current)==null||e.focus()})},[m]),De=r.useCallback(e=>{e.preventDefault(),Pe(),J()},[J,Pe]),we=r.useCallback(e=>{e.preventDefault(),Se(),J()},[J,Se]);Je(()=>{(I>c||I<C)&&ee("rangeOverflow",j(g),I)},[I,g,j,ee]),Qe(()=>{if(!w.current||!(w.current.value!=g))return;const N=X(w.current.value);te(H(N))},[X,H]),tt(()=>w.current,"wheel",e=>{var Ee;const k=(((Ee=w.current)==null?void 0:Ee.ownerDocument)??document).activeElement===w.current;if(!t||!k)return;e.preventDefault();const y=Ae(e)*(b??1),A=Math.sign(e.deltaY);A===-1?Y(y):A===1&&$(y)},{passive:!1});const We=r.useCallback((e={},N=null)=>({id:o,type:"text",name:s,disabled:D,inputMode:h,pattern:M,readOnly:S,required:R,role:"spinbutton",...T,...e,ref:ne(w,N),"aria-invalid":Ze(le??_e),"aria-valuemax":c,"aria-valuemin":C,"aria-valuenow":Number.isNaN(I)?void 0:I,"aria-valuetext":xe,autoComplete:"off",autoCorrect:"off",max:c,min:C,step:b,value:j(g),onBlur:_(e.onBlur,be),onChange:_(e.onChange,ve),onFocus:_(e.onFocus,pe),onKeyDown:_(e.onKeyDown,ye)}),[o,s,h,M,R,D,S,T,C,c,b,j,g,I,xe,le,_e,ve,ye,pe,be]),He=r.useCallback((e={},N=null)=>{var y;const k=D||d&&Ne;return{"aria-label":"Increase",disabled:k,readOnly:S,required:R,...T,...e,ref:ne(N,de),style:{...e.style,cursor:S?"not-allowed":(y=e.style)==null?void 0:y.cursor},tabIndex:-1,onPointerDown:_(e.onPointerDown,A=>{A.button===0&&!k&&De(A)}),onPointerLeave:_(e.onPointerLeave,E),onPointerUp:_(e.onPointerUp,E)}},[D,d,Ne,R,S,T,E,De]),Xe=r.useCallback((e={},N=null)=>{var y;const k=D||d&&Ie;return{"aria-label":"Decrease",disabled:k,readOnly:S,required:R,...T,...e,ref:ne(N,fe),style:{...e.style,cursor:S?"not-allowed":(y=e.style)==null?void 0:y.cursor},tabIndex:-1,onPointerDown:_(e.onPointerDown,A=>{A.button===0&&!k&&we(A)}),onPointerLeave:_(e.onPointerLeave,E),onPointerUp:_(e.onPointerUp,E)}},[D,d,Ie,R,S,T,E,we]);return{isDisabled:Ge,isFocused:qe,isReadOnly:Be,isRequired:Ue,props:l,value:j(g),valueAsNumber:I,getDecrementProps:Xe,getIncrementProps:He,getInputProps:We}},mt=50,Ve=300,dt=(n,o)=>{const[s,t]=r.useState(!1),[u,f]=r.useState(null),[m,p]=r.useState(!0),a=r.useRef(null),h=()=>clearTimeout(a.current);nt(()=>{u==="increment"&&n(),u==="decrement"&&o()},s?mt:null);const v=r.useCallback(()=>{m&&n(),a.current=setTimeout(()=>{p(!1),t(!0),f("increment")},Ve)},[n,m]),d=r.useCallback(()=>{m&&o(),a.current=setTimeout(()=>{p(!1),t(!0),f("decrement")},Ve)},[o,m]),c=r.useCallback(()=>{p(!0),t(!1),h()},[]);return r.useEffect(()=>()=>h(),[]),{down:d,isSpinning:s,stop:c,up:v}},Me=(n,o,s,t)=>{r.useEffect(()=>{if(!n.current||!s)return;const u=n.current.ownerDocument.defaultView??window,f=new u.MutationObserver(m=>{for(const{type:p,attributeName:a}of m)p==="attributes"&&a&&o.includes(a)&&t()});return f.observe(n.current,{attributeFilter:o,attributes:!0}),()=>f.disconnect()})},[ft,Z]=et({name:"NumberInputContext",errorMessage:`useNumberInputContext returned is 'undefined'. Seems you forgot to wrap the components in "<NumberInput />"`}),Fe=U((n,o)=>{const[s,t]=ot("NumberInput",n);let{className:u,isStepper:f=!0,stepper:m,addonProps:p,containerProps:a,decrementProps:h,incrementProps:v,...d}=at(t);const{props:c,getDecrementProps:C,getIncrementProps:P,getInputProps:M}=lt(d);m??(m=f);const O={position:"relative",zIndex:0,...s.container};return x.jsx(ft,{value:{styles:s,getDecrementProps:C,getIncrementProps:P,getInputProps:M},children:x.jsxs(Q.div,{className:K("ui-number-input",u),role:"group",__css:O,...a,children:[x.jsx(se,{...M(c,o)}),f?x.jsxs(oe,{...p,children:[x.jsx(ae,{...v}),x.jsx(ue,{...h})]}):null]})})});Fe.displayName="NumberInput";Fe.__ui__="NumberInput";const se=U(({className:n,...o},s)=>{const{styles:t}=Z(),u={width:"100%",...t.field};return x.jsx(Q.input,{ref:s,className:K("ui-number-input__field",n),__css:u,...o})});se.displayName="NumberInputField";se.__ui__="NumberInputField";const oe=U(({className:n,...o},s)=>{const{styles:t}=Z(),u={display:"flex",flexDirection:"column",height:"calc(100% - 2px)",insetEnd:"0px",margin:"1px",position:"absolute",top:"0",zIndex:"fallback(yamcha, 1)",...t.addon};return x.jsx(Q.div,{ref:s,className:K("ui-number-input__addon",n),"aria-hidden":!0,__css:u,...o})});oe.displayName="NumberInputAddon";oe.__ui__="NumberInputAddon";const Oe=Q("button",{baseStyle:{alignItems:"center",cursor:"pointer",display:"flex",flex:1,justifyContent:"center",lineHeight:"normal",transitionDuration:"normal",transitionProperty:"common",userSelect:"none"}}),ae=U(({className:n,children:o,...s},t)=>{const{styles:u,getIncrementProps:f}=Z(),m={...u.stepper};return x.jsx(Oe,{className:K("ui-number-input__stepper--up",n),...f(s,t),__css:m,children:o??x.jsx(Te,{__css:{transform:"rotate(180deg)"}})})});ae.displayName="NumberIncrementStepper";ae.__ui__="NumberIncrementStepper";const ue=U(({className:n,children:o,...s},t)=>{const{styles:u,getDecrementProps:f}=Z(),m={...u.stepper};return x.jsx(Oe,{className:K("ui-number-input__stepper--down",n),...f(s,t),__css:m,children:o??x.jsx(Te,{})})});ue.displayName="NumberDecrementStepper";ue.__ui__="NumberDecrementStepper";export{Fe as N,lt as u};
