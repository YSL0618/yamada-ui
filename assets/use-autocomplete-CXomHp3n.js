import{j as p}from"./jsx-runtime-CfatFE5O.js";import{f as ie}from"./forward-ref-D13m8o2p.js";import{A as Bt,g as vt,b as D,c as X,p as Ht,J as Be,a0 as zt,o as Gt,a as ke,C as Ie,d as fe,h as U,au as Jt,P as ae,I as bt,n as Ae,L as yt,af as At,a2 as Kt,aq as Ut,a3 as $t,u as qt,a1 as Wt,a4 as Te}from"./factory-Nur_zO5a.js";import{r as s}from"./index-ClcD9ViR.js";import{b as Yt}from"./popover-trigger-VZ6-C5a8.js";import{u as Qt}from"./index-DKQLNlvR.js";import{u as Xt}from"./index-B1nZG4Mb.js";import{u as Zt}from"./index-BMKmWsig.js";import{c as es}from"./index-hBuKIhm7.js";import{u as ts}from"./index-Ci6jtn_l.js";import{c as ss,a as os}from"./icon-M07mMfJs.js";import{u as ns,f as ls}from"./form-control-CFvK9TXx.js";const{DescendantsContextProvider:js,useDescendant:as,useDescendants:is,useDescendantsContext:It}=es(),[Es,V]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),Ze=ie(({className:n,children:t,__css:l,...c},u)=>{const{styles:a}=V(),d={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...a.icon,...l},C=vt(t).map(_=>s.cloneElement(_,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return p.jsx(D.div,{ref:u,className:X("ui-autocomplete__icon",n),__css:d,...c,children:Ht(t)?C:p.jsx(ss,{})})});Ze.displayName="AutocompleteIcon";Ze.__ui__="AutocompleteIcon";const kt=({className:n,children:t,...l})=>{const c=s.useRef(null),{styles:u}=V(),a=l.disabled,d=ts({ref:c,isDisabled:a,...l});return p.jsx(Ze,{className:X("ui-autocomplete__icon--clear",n),"aria-label":"Clear value",__css:u.clearIcon,...d,children:t??p.jsx(os,{h:"0.5em",w:"0.5em"})})};kt.displayName="AutocompleteClearIcon";kt.__ui__="AutocompleteClearIcon";const Pe=ie(({className:n,...t},l)=>{const{styles:c}=V(),u={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...c.itemIcon};return p.jsx(D.span,{ref:l,className:X("ui-autocomplete__item__icon",n),__css:u,...t})});Pe.displayName="AutocompleteItemIcon";Pe.__ui__="AutocompleteItemIcon";const cs=n=>{var t;return Jt(n)&&!!((t=n.getAttribute("role"))!=null&&t.startsWith("option"))},rs=n=>{var je;const{closeOnSelect:t,focusedIndex:l,inputRef:c,omitSelectedValues:u,setFocusedIndex:a,value:d,optionProps:m,onChange:C,onClose:_,onFocusNext:F}=V(),G=s.useId(),A=s.useRef(null);let{id:f,children:S,closeOnSelect:M,disabled:k,focusable:L,icon:h,isDisabled:I,isFocusable:j,value:v,...ce}={...m,...n};k??(k=I),L??(L=j);const Se=!!k&&!L,{descendants:xe,index:W,register:Ce}=as({disabled:Se}),Oe=xe.values().slice(0,W),ge=ae(d),Y=Oe.some(({node:T})=>T.dataset.value===(v??"")),Z=!Y&&(ge?d.includes(v??""):(v??"")===d),re="target"in(((je=A.current)==null?void 0:je.dataset)??{}),he=W===l;f??(f=G),Be(v)&&(zt(S)||Gt(S)?v=S.toString():console.warn(`${ge?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`));const we=s.useCallback(T=>{if(T.stopPropagation(),k||!cs(T.currentTarget)){c.current&&c.current.focus();return}Y||a(W),C(v??""),c.current&&c.current.focus(),(M??t)&&_(),u&&F(W)},[Y,F,u,k,v,a,W,C,M,t,_,c]),ze=s.useCallback((T={},Ee=null)=>{const Ne=!re||u&&Z,ue={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ke(A,Ee,Ce),role:"option",...ce,...T,id:f,style:Ne?ue:void 0,"aria-disabled":Ie(k),"aria-hidden":Ie(Ne),"aria-selected":Z,"data-disabled":fe(k),"data-duplicated":fe(Y),"data-focus":fe(he),"data-target":fe(!0),"data-value":v??"",tabIndex:-1,onClick:U(ce.onClick,T.onClick,we)}},[f,Y,v,ce,k,he,Z,re,u,we,Ce]);return{children:S,customIcon:h,isFocused:he,isSelected:Z,isTarget:re,omitSelectedValues:u,getOptionProps:ze}},us=()=>{const{isHit:n,onCreate:t}=V();return{getCreateProps:s.useCallback((c={},u=null)=>({ref:u,role:"option",...c,style:n?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":Ie(n),"data-focus":fe(!n),tabIndex:-1,onClick:U(c.onClick,t)}),[n,t])}},ds=()=>{const{isEmpty:n,isHit:t}=V();return{getEmptyProps:s.useCallback((c={},u=null)=>{const a=t&&!n;return{ref:u,role:"presentation",...c,style:a?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":Ie(a),tabIndex:-1}},[t,n])}},Pt=ie(({className:n,children:t,icon:l,...c},u)=>{const{inputValue:a,styles:d}=V(),{getCreateProps:m}=us();t??(t=a);const C={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return p.jsxs(D.div,{className:X("ui-autocomplete__item--create",n),__css:C,...m(c,u),children:[l!==null?p.jsx(Pe,{children:l||p.jsx(et,{})}):null,l?p.jsx(D.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:bt(t,a)}):bt(t,a)]})});Pt.displayName="AutocompleteCreate";Pt.__ui__="AutocompleteCreate";const et=()=>p.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:p.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});et.displayName="AutocompletePlusIcon";et.__ui__="AutocompletePlusIcon";const St=ie(({className:n,children:t,icon:l,...c},u)=>{const{emptyMessage:a,styles:d}=V(),{getEmptyProps:m}=ds();t??(t=a);const C={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return p.jsxs(D.div,{className:X("ui-autocomplete__item--empty",n),__css:C,...m(c,u),children:[l!==null?p.jsx(Pe,{children:l||p.jsx(tt,{})}):null,l?p.jsx(D.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:t}):t]})});St.displayName="AutocompleteEmpty";St.__ui__="AutocompleteEmpty";const tt=()=>p.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:p.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});tt.displayName="AutocompleteMinusIcon";tt.__ui__="AutocompleteMinusIcon";const ps=()=>{const{focusedIndex:n,isOpen:t,rebirthOptions:l,value:c}=V(),u=It(),a=s.useRef(null),d=s.useRef(-1),m=u.value(n),C=ae(c),_=s.useCallback(()=>{t||l(!1)},[t,l]);s.useEffect(()=>{if(!a.current||!m||d.current===m.index)return;const A=a.current,f=m.node,S=A.clientHeight,M=A.scrollTop,k=M+S,L=f.clientHeight,h=f.offsetTop,I=h+L,j=M<=h&&I<=k,v=d.current<m.index;j||(I<=S?a.current.scrollTo({top:0}):v?a.current.scrollTo({top:I-S}):a.current.scrollTo({top:h+1})),d.current=m.index},[a,m]),Ae(()=>{t||(d.current=-1)},[t]);const F=s.useCallback((A={},f=null)=>({ref:f,"aria-multiselectable":Ie(C),role:"listbox",...A,onAnimationComplete:U(A.onAnimationComplete,_)}),[C,_]),G=s.useCallback((A={},f=null)=>({ref:ke(a,f),position:"relative",tabIndex:-1,...A}),[a]);return{getContainerProps:F,getListProps:G}},Ot=ie(({className:n,children:t,footer:l,header:c,maxW:u,maxWidth:a,minW:d,minWidth:m,w:C,width:_,contentProps:F,...G},A)=>{var k,L,h,I,j,v;const{styles:f}=V(),{getContainerProps:S,getListProps:M}=ps();return _??(_=C),_??(_=((k=f.list)==null?void 0:k.width)??((L=f.list)==null?void 0:L.w)),m??(m=d),m??(m=((h=f.list)==null?void 0:h.minWidth)??((I=f.list)==null?void 0:I.minW)),a??(a=u),a??(a=((j=f.list)==null?void 0:j.maxWidth)??((v=f.list)==null?void 0:v.maxW)),p.jsxs(Yt,{as:"div",className:"ui-autocomplete__popover",maxWidth:a,minWidth:m,width:_,__css:{...f.content,maxWidth:a,minWidth:m,width:_},...S(F),children:[c?p.jsx(D.header,{className:"ui-autocomplete__header",__css:{...f.header},children:c}):null,p.jsx(D.div,{className:X("ui-autocomplete__list",n),__css:{...f.list},...M(G,A),children:t}),l?p.jsx(D.footer,{className:"ui-autocomplete__footer",__css:{...f.footer},children:l}):null]})});Ot.displayName="AutocompleteList";Ot.__ui__="AutocompleteList";const He=ie(({className:n,icon:t,...l},c)=>{const{styles:u}=V(),{children:a,customIcon:d,isSelected:m,getOptionProps:C}=rs(l);t??(t=d);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...u.item};return p.jsxs(D.div,{className:X("ui-autocomplete__item",n),__css:_,...C({},c),children:[t!==null?p.jsx(Pe,{opacity:m?1:0,children:t||p.jsx(st,{})}):null,p.jsx(D.span,{style:{flex:1},"data-label":!0,children:a})]})});He.displayName="AutocompleteOption";He.__ui__="AutocompleteOption";const st=()=>p.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:p.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});st.displayName="AutocompleteCheckIcon";st.__ui__="AutocompleteCheckIcon";const ms=({label:n,...t})=>{const{omitSelectedValues:l,value:c}=V(),u=It(),a=s.useRef(null),d=s.useId(),m=u.values(),F=(ae(c)&&l?u.values(({node:h})=>c.includes(h.dataset.value??"")):[]).map(({index:h})=>h),A=!m.filter(({index:h,node:I})=>{var j;return((j=I.parentElement)==null?void 0:j.dataset.label)===n&&!F.includes(h)&&"target"in I.dataset}).length,[f,S]=yt(t,At),M=s.useCallback((h={},I=null)=>{var v;const j={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:I,"aria-labelledby":(v=a.current)==null?void 0:v.id,role:"group",...h,...f,style:A?j:void 0}},[f,A]),k=s.useCallback(({id:h,...I}={},j=null)=>({id:h??d,ref:ke(j,a),role:"presentation",...I}),[d]),L=s.useCallback((h={},I=null)=>({ref:I,...h,...S,"data-label":n}),[S,n]);return{label:n,getContainerProps:M,getGroupProps:L,getLabelProps:k}},ot=ie(({className:n,children:t,color:l,h:c,height:u,minH:a,minHeight:d,labelProps:m,...C},_)=>{const{styles:F}=V(),{label:G,getContainerProps:A,getGroupProps:f,getLabelProps:S}=ms(C);return c??(c=u),a??(a=d),p.jsxs(D.section,{className:X("ui-autocomplete__item","ui-autocomplete__item--group",n),__css:{color:l,h:"fit-content",w:"100%"},...A(),children:[p.jsx(D.header,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:F.groupLabel,...S(m),children:G}),p.jsx(D.div,{...f({},_),className:"ui-autocomplete__item__group",__css:{h:c,minH:a,...F.group},children:t})]})});ot.displayName="AutocompleteOptionGroup";ot.__ui__="AutocompleteOptionGroup";const _t={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},fs=n=>{n=n.replace(/[！-～]/g,l=>String.fromCharCode(l.charCodeAt(0)-65248));const t=new RegExp("("+Object.keys(_t).join("|")+")","g");return n=n.replace(t,l=>_t[l]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),n=n.toUpperCase(),n},xs=n=>{const t=l=>l.map(c=>{const{disabled:u,focusable:a}=c;if(!(u&&!a))return"items"in c?t(c.items??[]):c}).filter(Boolean);return t(n).flat(1/0)},Ns=n=>{var ht;const{allowCreate:t=!1,allowFree:l=!1,animation:c,boundary:u,children:a,closeDelay:d,closeOnBlur:m=!0,closeOnEsc:C=!0,closeOnSelect:_=!0,defaultIsOpen:F,defaultValue:G,duration:A=.2,emptyMessage:f="No results found",eventListeners:S,flip:M,format:k=fs,gutter:L,insertPositionItem:h="first",isLazy:I,isOpen:j,items:v,lazyBehavior:ce,matchWidth:Se=!0,maxSelectValues:xe,modifiers:W,offset:Ce,omitSelectedValues:w=!1,openDelay:Oe,placeholder:ge,placement:Y="bottom-start",preventOverflow:Z,strategy:re,value:he,optionProps:we,onChange:ze,onClose:je,onCreate:T,onKeyDown:Ee,onOpen:Ne,onSearch:ue,...be}=ns(n),b=is(),Ge=s.useRef(null),ee=s.useRef(null),te=s.useRef(new Set([])),Je=s.useRef(!1),nt=s.useRef(void 0),[se,lt]=s.useState(v?JSON.parse(JSON.stringify(v)):void 0),[O,De]=Qt({defaultValue:G,value:he,onChange:ze}),[Ke,Ue]=s.useState(void 0),[E,de]=s.useState(""),[J,P]=s.useState(-1),[oe,at]=s.useState(!1),[pe,it]=s.useState(!0),{isOpen:x,onClose:B,onOpen:ct}=Xt({defaultIsOpen:F,isOpen:j,onClose:je,onOpen:Ne}),{"aria-readonly":Cs,onFocus:rt,...z}=Kt(be,ls),[ut,wt]=yt(be,At),_e=J>-1,$e=J===-2&&t,g=ae(O),Ve=g?!O.length:!O,[ve,dt]=s.useMemo(()=>ae(h)?h:[h,"first"],[h]);t&&!Be(a)&&console.warn(`${g?"MultiAutocomplete":"Autocomplete"}: ${g?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const $=b.enabledValues(({node:e})=>g&&O.includes(e.dataset.value??"")).map(({index:e})=>e),K=b.enabledValues(({index:e,node:o})=>"target"in o.dataset&&!$.includes(e)),pt=(ht=b.value(J))==null?void 0:ht.node.id,jt=vt(a),Fe=s.useMemo(()=>se==null?void 0:se.map((e,o)=>{if("value"in e){const{label:i,value:r,...y}=e;return p.jsx(He,{value:r,...y,children:i},o)}else if("items"in e){const{items:i=[],label:r,...y}=e;return p.jsx(ot,{label:r,...y,children:i.map(({label:R,value:le,...Xe},Tt)=>p.jsx(He,{value:le,...Xe,children:R},Tt))},o)}}).filter(Boolean),[se]),ne=!jt.length&&!(Fe!=null&&Fe.length),N=s.useCallback(()=>{z.disabled||z.readOnly||!t&&(ne||oe)||(ct(),ee.current&&ee.current.focus())},[t,z,oe,ne,ct]),me=s.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const o=b.enabledFirstValue(({node:i})=>"target"in i.dataset);if(o)if(!g||!w)P(o.index);else if($.includes(o.index)){const i=K[0];P((i==null?void 0:i.index)??-1)}else P(o.index)});te.current.add(e)},[b,K,oe,ne,g,w,$]),Re=s.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const o=b.enabledLastValue(({node:i})=>"target"in i.dataset);if(o)if(!g||!w)P(o.index);else if($.includes(o.index)){const i=K.reverse()[0];P((i==null?void 0:i.index)??-1)}else P(o.index)});te.current.add(e)},[b,K,oe,ne,g,w,$]),qe=s.useCallback(()=>{const e=setTimeout(()=>{const i=b.enabledValues().find(({node:r})=>g?O.includes(r.dataset.value??""):r.dataset.value===O);i&&P(i.index)});te.current.add(e)},[b,g,O]),ye=s.useCallback((e=J)=>{const o=setTimeout(()=>{const i=b.enabledNextValue(e,({node:r})=>"target"in r.dataset);if(i)if(!g||!w)P(i.index);else if($.includes(i.index)){const r=K.find(({index:y})=>i.index<y)??K[0];P((r==null?void 0:r.index)??-1)}else P(i.index)});te.current.add(o)},[b,K,J,g,w,$]),We=s.useCallback((e=J)=>{const o=setTimeout(()=>{const i=b.enabledPrevValue(e,({node:r})=>"target"in r.dataset);if(i)if(!g||!w)P(i.index);else if($.includes(i.index)){const r=K.reverse().find(({index:y})=>y<i.index)??K[0];P((r==null?void 0:r.index)??-1)}else P(i.index)});te.current.add(o)},[b,K,J,g,w,$]),Q=Ve||w?me:qe,mt=Ve||w?Re:qe,Ye=s.useCallback(e=>{const o=b.values();let i=!1,r=!1;o.forEach(({index:y,node:R})=>{if(k(R.textContent??"").includes(e)){i=!0;const le="disabled"in R.dataset;R.dataset.target="",!r&&!le&&(r=!0,P(y))}else delete R.dataset.target}),it(i)},[b,k]),q=s.useCallback((e=!0)=>{b.values().forEach(({node:i})=>{i.dataset.target=""}),e&&me(),it(!0)},[b,me]),Et=s.useCallback(e=>{const o=b.values();if(!o.length)return;const r=(ae(e)?e:[e]).map(y=>{const{node:R}=o.find(({node:le})=>le.dataset.value===y)??{};if(R){const{textContent:le}=Array.from(R.children).find(Xe=>Xe.getAttribute("data-label")!==null)??{};return le}else return l?y:void 0}).filter(y=>!Be(y));Ue(g?r:r[0])},[l,b,g]),H=s.useCallback((e,o=!0)=>{De(i=>{let r;return ae(i)?i.includes(e)?r=i.filter(R=>R!==e):r=[...i,e]:r=e,nt.current=r,r}),de(""),g&&o&&q(!1)},[g,q,De]),Qe=s.useCallback(()=>{let e=b.value(J);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const o=e.node.dataset.value??"";H(o),_&&B(),w&&ye()},[_,b,J,w,H,B,ye]),Nt=s.useCallback(e=>{x||N(),ue==null||ue(e);const o=e.target.value,i=k(o);i?Ye(i):q(),de(o)},[x,N,k,ue,Ye,q]),Dt=s.useCallback(()=>{Je.current=!0},[]),Vt=s.useCallback(()=>{Je.current=!1},[]),Me=s.useCallback(()=>{const e={label:E,value:E};let o=[];if(se&&(o=[...se]),ve==="first")o=[e,...o];else if(ve==="last")o=[...o,e];else{const r=o.findIndex(({label:R})=>R===ve),y=o[r];r!==-1&&y&&"items"in y?(dt==="first"?y.items=[e,...y.items??[]]:y.items=[...y.items??[],e],o[r]=y):console.warn(`${g?"MultiAutocomplete":"Autocomplete"}: '${ve}' specified in insertPositionItem does not exist in the option group.`)}lt(o),H(E),q(!1);const i=xs(o).findIndex(({value:r})=>r===E);P(i),T==null||T(e,o)},[E,se,ve,H,q,T,dt,g]),ft=s.useCallback(()=>{x?ee.current&&ee.current.focus():(N(),Q())},[x,Q,N]),Le=s.useCallback(()=>{x||(N(),Q())},[x,Q,N]),xt=s.useCallback(e=>{const o=Ut(e);$t(Ge.current,o)||!m&&pe||(l&&E&&H(E,!1),de(""),x&&B())},[m,pe,x,E,l,B,H]),Ct=s.useCallback(()=>{H(g?O[O.length-1]:""),x||Le()},[g,x,H,Le,O]),Ft=s.useCallback(e=>{e.stopPropagation(),nt.current=[],De([]),Ue(void 0),de(""),q(),x&&ee.current&&ee.current.focus()},[x,Ue,de,De,q]),gt=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),z.disabled||z.readOnly||Je.current)return;const o=Ke===E||!E.length,r={ArrowDown:_e?()=>ye():x?void 0:Te(N,Q),ArrowUp:_e?()=>We():x?void 0:Te(N,mt),Backspace:!Ve&&o?Ct:void 0,End:x?Re:void 0,Enter:$e?Me:_e?Qe:x?l&&g?()=>{E&&H(E),P(0)}:void 0:Te(N,Q),Escape:C?B:void 0,Home:x?me:void 0,Space:$e?Me:_e?Qe:x?void 0:Te(N,Q)}[e.key];r&&(e.preventDefault(),e.stopPropagation(),r(e))},[l,z,Ke,E,N,_e,g,Q,ye,mt,We,$e,Me,Qe,x,me,Re,C,B,Ve,Ct,H]);s.useEffect(()=>{if(!g||!w&&Be(xe))return;const e=O.length>0&&O.length===b.count(),o=O.length===xe;e||o?(B(),at(!0)):at(!1)},[w,O,b,g,B,xe]),qt(()=>{Et(O)},[O]),Ae(()=>{x||l||(P(-1),de(""))},[x]),Ae(()=>{pe||P(-2)},[pe]),Ae(()=>{lt(v?JSON.parse(JSON.stringify(v)):void 0)},[v]),Wt(()=>{te.current.forEach(e=>clearTimeout(e)),te.current.clear()}),Zt({ref:Ge,enabled:x&&(m||!pe),handler:B});const Rt=s.useCallback(e=>({animation:c,boundary:u,closeDelay:d,closeOnBlur:m,duration:A,eventListeners:S,flip:M,gutter:L,isLazy:I,lazyBehavior:ce,matchWidth:Se,modifiers:W,offset:Ce,openDelay:Oe,placement:Y,preventOverflow:Z,strategy:re,...e,closeOnButton:!1,isOpen:x,trigger:"never",onClose:B,onOpen:N}),[m,Oe,d,I,ce,c,A,Ce,L,Z,M,Se,u,S,re,Y,W,x,N,B]),Mt=s.useCallback((e={},o=null)=>({ref:ke(Ge,o),...ut,...e,...z,onBlur:U(e.onBlur,be.onBlur,xt),onClick:U(e.onClick,be.onClick,ft)}),[ut,z,xt,ft,be]),Lt=s.useCallback((e={},o=null)=>({ref:o,"aria-activedescendant":pt,"aria-autocomplete":"list","aria-haspopup":"listbox",role:"combobox",tabIndex:-1,...e,...z,"data-active":fe(x),placeholder:ge,onFocus:U(e.onFocus,rt,Le),onKeyDown:U(e.onKeyDown,Ee,gt)}),[pt,z,ge,x,rt,Le,Ee,gt]);return{allowCreate:t,allowFree:l,children:a??Fe,closeOnSelect:_,descendants:b,emptyMessage:f,focusedIndex:J,inputRef:ee,inputValue:E,isAllSelected:oe,isEmpty:ne,isHit:pe,isOpen:x,label:Ke,omitSelectedValues:w,pickOptions:Ye,rebirthOptions:q,setFocusedIndex:P,value:O,formControlProps:z,getContainerProps:Mt,getFieldProps:Lt,getPopoverProps:Rt,inputProps:wt,optionProps:we,onChange:H,onClear:Ft,onClose:B,onCompositionEnd:Vt,onCompositionStart:Dt,onCreate:Me,onFocusFirst:me,onFocusLast:Re,onFocusNext:ye,onFocusPrev:We,onFocusSelected:qe,onOpen:N,onSearch:Nt}},Ds=()=>{const{inputRef:n,isAllSelected:t,formControlProps:l,inputProps:c,onCompositionEnd:u,onCompositionStart:a,onSearch:d}=V();return Ae(()=>{t&&n.current&&n.current.blur()},[t]),{getInputProps:s.useCallback((C={},_=null)=>({ref:ke(n,_),...l,autoCapitalize:"none",autoComplete:"off",spellCheck:"false",tabIndex:t?-1:0,...c,...C,cursor:l.readOnly?"default":"text",pointerEvents:l.disabled||t?"none":"auto",onChange:U(C.onChange,d),onCompositionEnd:U(C.onCompositionEnd,c.onCompositionEnd,u),onCompositionStart:U(C.onCompositionStart,c.onCompositionStart,a)}),[c,n,l,t,d,a,u])}};export{js as A,Es as a,Ze as b,Ot as c,Pt as d,St as e,V as f,Ds as g,He as h,ot as i,kt as j,Ns as u};
