import{j as _}from"./extends-CwFRzn3r.js";import{r as o}from"./index-BwDkhjyp.js";import{f as oe}from"./forward-ref-BWI-Phbn.js";import{o as Ze,V as et,U as Ge,a6 as Ue,_ as tt,F as W,ae as st,W as nt,A as ot,f as lt,S as ct,a as be,h as ne,d as Ce,t as Pe,aO as at,X as xe,b as R,c as J,p as it,j as rt}from"./factory-CYpx3TMG.js";import{u as ut}from"./index-CIt0OHe7.js";import{c as dt,a as pt}from"./icon-FPUxZQsz.js";import{u as ft}from"./index-tU9OGY6h.js";import{c as mt}from"./index-C1nnoSu4.js";import{u as xt}from"./index-CFjuI6Rx.js";import{u as bt}from"./index-DHvgXC6C.js";import{u as Ct,f as _t}from"./form-control-DTumWR9y.js";import{b as ht}from"./popover-content-C9K0DE-R.js";const vt=a=>{var s;return at(a)&&!!((s=a==null?void 0:a.getAttribute("role"))!=null&&s.startsWith("option"))},{DescendantsContextProvider:Mt,useDescendantsContext:Ke,useDescendants:gt,useDescendant:St}=mt(),[Ht,U]=Ze({strict:!1,name:"SelectContext"}),Gt=a=>{const{placeholder:s,closeOnSelect:l=!0,placeholderInOptions:u=!0,omitSelectedValues:n=!1,maxSelectValues:i,isEmpty:r,value:k,defaultValue:I,onChange:m,optionProps:x,isOpen:h,defaultIsOpen:P,onOpen:p,onClose:L,closeOnBlur:c=!0,closeOnEsc:v=!0,openDelay:S,closeDelay:A,isLazy:y,lazyBehavior:B,animation:le,duration:ce=.2,offset:K,gutter:Q,preventOverflow:ae,flip:_e,matchWidth:ie=!0,boundary:X,eventListeners:he,strategy:M,placement:Y="bottom-start",modifiers:Z,...N}=Ct(a),{"aria-readonly":H,...D}=et(N,_t),[re,Fe]=Ge(tt(N,["aria-readonly"]),Ue),f=gt(),[V,g]=o.useState(-1),[we,Ee]=o.useState(!1),ue=o.useRef(null),Ne=o.useRef(null),Ve=o.useRef(null),$=o.useRef(new Set([])),[F,de]=ft({value:k,defaultValue:I,onChange:m}),[q,ve]=o.useState(void 0),ee=V>-1,b=W(F),Te=(b?!F.length:!F)&&!(s&&u),G=f.values(({node:e})=>b&&F.includes(e.dataset.value??"")).map(({index:e})=>e),T=f.enabledValues(({index:e})=>!G.includes(e)),pe=o.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledFirstValue();if(t)if(!b||!n)g(t.index);else if(G.includes(t.index)){const C=T[0];g(C.index)}else g(t.index)});$.current.add(e)},[f,T,b,n,G]),fe=o.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledLastValue();if(t)if(!b||!n)g(t.index);else if(G.includes(t.index)){const C=T.reverse()[0];g(C.index)}else g(t.index)});$.current.add(e)},[f,T,b,n,G]),ge=o.useCallback(()=>{const e=setTimeout(()=>{const C=f.enabledValues().find(({node:j})=>b?F.includes(j.dataset.value??""):j.dataset.value===F);C&&g(C.index)});$.current.add(e)},[f,b,F]),te=o.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledNextValue(V);if(t)if(!b||!n)g(t.index);else if(G.includes(t.index)){const C=T.find(({index:j})=>t.index<j)??T[0];g(C.index)}else g(t.index)});$.current.add(e)},[f,T,V,b,n,G,g]),Se=o.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledPrevValue(V);if(t)if(!b||!n)g(t.index);else if(G.includes(t.index)){const C=T.reverse().find(({index:j})=>j<t.index)??T[0];g(C.index)}else g(t.index)});$.current.add(e)},[f,T,V,b,n,G,g]),z=Te||n?pe:ge,Re=Te||n?fe:ge,ye=o.useCallback((e,t=!0)=>{const C=f.values();if(!C.length)return;const j=C.filter(({node:O})=>O.dataset.value===e).map(({node:O,index:se})=>{if(!(s&&u)||se!==0){const me=Array.from(O.children).find(ke=>ke.getAttribute("data-label")!==null);return(me==null?void 0:me.innerHTML)??""}else return});ve(O=>b?(j.forEach(se=>{W(O)&&O.includes(se??"")?t&&(O=W(O)?O.filter(ke=>ke!==se):void 0):O=[...W(O)?O:[],se]}),O):j[0])},[f,b,s,u]),Oe=o.useCallback(e=>{de(t=>W(t)?t.includes(e)?t.filter(j=>j!==e):[...t,e]:e),ye(e)},[ye,de]),Ye=o.useCallback(e=>{e.stopPropagation(),de([]),ve(void 0)},[ve,de]),{isOpen:d,onOpen:Le,onClose:w}=xt({isOpen:h,defaultIsOpen:P,onOpen:p,onClose:L}),E=o.useCallback(()=>{D.disabled||D.readOnly||r||we||Le()},[D,r,we,Le]),Ie=o.useCallback(()=>{let e=f.value(V);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";Oe(t),l&&w(),n&&te()},[l,f,V,n,Oe,w,te]),Ae=o.useCallback(()=>{d||(E(),z())},[d,z,E]),Be=o.useCallback(()=>{d||(E(),z())},[d,z,E]),Me=o.useCallback(e=>{const t=st(e);nt(ue.current,t)||c&&d&&w()},[c,d,w]),He=o.useCallback(e=>{if(e.key===" "&&(e.key=e.code),D.disabled||D.readOnly)return;const C={ArrowDown:ee?()=>te():d?void 0:xe(E,z),ArrowUp:ee?()=>Se():d?void 0:xe(E,Re),Space:ee?Ie:d?void 0:xe(E,z),Enter:ee?Ie:d?void 0:xe(E,z),Home:d?pe:void 0,End:d?fe:void 0,Escape:v?w:void 0}[e.key];C&&(e.preventDefault(),e.stopPropagation(),C())},[D.disabled,D.readOnly,ee,d,E,z,Re,Ie,pe,fe,v,w,te,Se]);bt({ref:ue,handler:w,enabled:d&&c}),o.useEffect(()=>{if(!b||!n&&ot(i))return;const e=F.length>0&&F.length===f.count(),t=F.length===i;e||t?(w(),Ee(!0)):Ee(!1)},[n,F,f,b,w,i]),lt(()=>{d||g(-1)},[d]),ct(()=>{$.current.forEach(e=>clearTimeout(e)),$.current.clear()});const qe=o.useCallback(e=>({closeOnBlur:c,openDelay:S,closeDelay:A,isLazy:y,lazyBehavior:B,animation:le,duration:ce,offset:K,gutter:Q,preventOverflow:ae,flip:_e,matchWidth:ie,boundary:X,eventListeners:he,strategy:M,placement:Y,modifiers:Z,...e,trigger:"never",closeOnButton:!1,isOpen:d,onOpen:E,onClose:w}),[c,S,A,y,B,le,ce,K,Q,ae,_e,ie,X,he,M,Y,Z,d,E,w]),Je=o.useCallback((e={},t=null)=>({ref:be(ue,t),...re,...e,...D,onClick:ne(e.onClick,N.onClick,Ae),onBlur:ne(e.onBlur,N.onBlur,Me)}),[re,D,Me,Ae,N]),Qe=o.useCallback(({"aria-label":e,...t}={},C=null)=>{var j,O;return e??(e=s??`Select ${b?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:be(Ne,C),tabIndex:0,...Fe,...t,"data-active":Ce(d),"data-placeholder":Ce(b?!(q!=null&&q.length):q===void 0),"aria-controls":(j=Ve.current)==null?void 0:j.id,"aria-activedescendant":(O=f.value(V))==null?void 0:O.node.id,"aria-expanded":d,onFocus:ne(t.onFocus,N.onFocus,Be),onKeyDown:ne(t.onKeyDown,N.onKeyDown,He)}},[f,Fe,V,d,b,q,s,N,Be,He]);return{descendants:f,value:F,label:q,focusedIndex:V,placeholder:s,placeholderInOptions:u,omitSelectedValues:n,closeOnSelect:l,isOpen:d,containerRef:ue,fieldRef:Ne,listRef:Ve,optionProps:x,formControlProps:D,onChangeLabel:ye,onChange:Oe,onClear:Ye,onOpen:E,onClose:w,onFocusFirst:pe,onFocusLast:fe,onFocusSelected:ge,onFocusNext:te,onFocusPrev:Se,setFocusedIndex:g,getPopoverProps:qe,getContainerProps:Je,getFieldProps:Qe}},yt=()=>{const{value:a,listRef:s,focusedIndex:l}=U(),u=Ke(),n=o.useRef(-1),i=u.value(l),r=W(a);o.useEffect(()=>{if(!s.current||!i||n.current===i.index)return;const m=s.current,x=i.node,h=m.clientHeight,P=m.scrollTop,p=P+h,L=x.clientHeight,c=x.offsetTop,v=c+L,S=P<=c&&v<=p,A=n.current<i.index;S||(v<=h?s.current.scrollTo({top:0}):A?s.current.scrollTo({top:v-h}):s.current.scrollTo({top:c+1})),n.current=i.index},[s,i]);const k=o.useId();return{getListProps:o.useCallback((m={},x=null)=>({id:k,ref:be(s,x),role:"listbox","aria-multiselectable":Pe(r),tabIndex:-1,position:"relative",...m}),[k,r,s])}},Ot=({label:a,...s})=>{const{value:l,omitSelectedValues:u}=U(),n=W(l),i=Ke(),r=i.values(),I=(n&&u?i.values(({node:c})=>l.includes(c.dataset.value??"")):[]).map(({index:c})=>c),x=!r.filter(({node:c,index:v})=>{var S;return((S=c.parentElement)==null?void 0:S.dataset.label)===a&&!I.includes(v)}).length,[h,P]=Ge(s,Ue),p=o.useCallback((c={},v=null)=>({ref:v,...c,...h,style:x?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[h,x]),L=o.useCallback(({"aria-label":c,...v}={},S=null)=>(c??(c=a),{"aria-label":c,ref:S,role:"group",...v,...P,"data-label":a}),[P,a]);return{label:a,getContainerProps:p,getGroupProps:L}},It=a=>{const{fieldRef:s,value:l,placeholder:u,placeholderInOptions:n,omitSelectedValues:i,closeOnSelect:r,focusedIndex:k,optionProps:I,onChange:m,onChangeLabel:x,onFocusNext:h,onClose:P,setFocusedIndex:p}=U();let{icon:L,isDisabled:c,isFocusable:v,closeOnSelect:S,children:A,value:y,...B}={...I,...a};const le=!!c&&!v,ce=o.useRef(null),{index:K,register:Q,descendants:ae}=St({disabled:le}),ie=ae.values().slice(0,K),X=W(l),M=!(X?!1:ie.some(({node:H})=>H.dataset.value===(y??"")))&&(X?l.includes(y??""):(y??"")===l),Y=K===k;u&&K>0&&n&&!y&&console.warn(`${X?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const Z=o.useCallback(H=>{if(H.preventDefault(),H.stopPropagation(),c){s.current&&s.current.focus();return}if(!vt(H.currentTarget)){s.current&&s.current.focus();return}p(K),m(y??""),s.current&&s.current.focus(),(S??r)&&P(),i&&h()},[c,p,K,m,y,s,S,r,P,i,h]);o.useEffect(()=>{M&&x(y??"",!1)},[y,M,x]);const N=o.useCallback((H={},D=null)=>{const re={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:be(ce,D,Q),...B,...H,tabIndex:-1,style:i&&M?re:void 0,"data-value":y??"","data-focus":Ce(Y),"data-disabled":Ce(c),"aria-checked":Pe(M),"aria-disabled":Pe(c),onClick:ne(B.onClick,H.onClick,Z)}},[y,B,c,Y,M,i,Z,Q]);return{isSelected:M,isFocused:Y,customIcon:L,children:A,getOptionProps:N}},ze=oe(({id:a,className:s,icon:l,...u},n)=>{const{styles:i}=U(),{isSelected:r,customIcon:k,children:I,getOptionProps:m}=It(u),x=o.useId();a??(a=x),l??(l=k);const h={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...i.item};return _.jsxs(R.li,{id:a,className:J("ui-select__item",s),__css:h,...m({},n),children:[l!==null?_.jsx(je,{opacity:r?1:0,children:l||_.jsx(kt,{})}):null,_.jsx(R.span,{style:{flex:1},"data-label":!0,children:I})]})});ze.displayName="Option";ze.__ui__="Option";const je=oe(({className:a,...s},l)=>{const{styles:u}=U(),n={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...u.itemIcon};return _.jsx(R.span,{ref:l,className:J("ui-select__item__icon",a),__css:n,...s})});je.displayName="OptionIcon";je.__ui__="OptionIcon";const kt=()=>_.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:_.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),We=oe(({className:a,color:s,h:l,height:u,minH:n,minHeight:i,children:r,labelProps:k,...I},m)=>{const{styles:x}=U(),{label:h,getContainerProps:P,getGroupProps:p}=Ot(I);return l??(l=u),n??(n=i),_.jsxs(R.li,{className:J("ui-select__item","ui-select__item--group",a),__css:{w:"100%",h:"fit-content",color:s},...P(),children:[_.jsx(R.span,{className:"ui-select__item__group-label",__css:x.groupLabel,lineClamp:1,...k,children:h}),_.jsx(R.ul,{...p({},m),className:"ui-select__item__group",__css:{h:l,minH:n,...x.group},children:r})]})});We.displayName="OptionGroup";We.__ui__="OptionGroup";const De=oe(({className:a,children:s,__css:l,...u},n)=>{const{styles:i}=U(),r={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...i.icon,...l},I=it(s).map(m=>o.cloneElement(m,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return _.jsx(R.div,{ref:n,className:J("ui-select__icon",a),__css:r,...u,children:rt(s)?I:_.jsx(dt,{})})});De.displayName="SelectIcon";De.__ui__="SelectIcon";const $e=({className:a,children:s,...l})=>{const u=o.useRef(null),{styles:n}=U(),i=l.disabled,r=ut({ref:u,isDisabled:i,...l});return _.jsx(De,{"aria-label":"Clear value",className:J("ui-select__clear-icon",a),__css:n.clearIcon,...r,children:s??_.jsx(pt,{w:"0.5em",h:"0.5em"})})};$e.displayName="SelectClearIcon";$e.__ui__="SelectClearIcon";const Xe=oe(({className:a,w:s,width:l,minW:u,minWidth:n,maxW:i,maxWidth:r,contentProps:k,header:I,footer:m,children:x,...h},P)=>{var c,v,S,A,y,B;const{styles:p}=U(),{getListProps:L}=yt();return l??(l=s),l??(l=((c=p.list)==null?void 0:c.width)??((v=p.list)==null?void 0:v.w)),n??(n=u),n??(n=((S=p.list)==null?void 0:S.minWidth)??((A=p.list)==null?void 0:A.minW)),r??(r=i),r??(r=((y=p.list)==null?void 0:y.maxWidth)??((B=p.list)==null?void 0:B.maxW)),_.jsxs(ht,{as:"div",className:"ui-select__content",width:l,minWidth:n,maxWidth:r,__css:{...p.content,width:l,minWidth:n,maxWidth:r},...k,children:[I?_.jsx(R.div,{className:"ui-select__header",__css:{...p.header},children:I}):null,_.jsx(R.ul,{className:J("ui-select__list",a),__css:{...p.list},...L(h,P),children:x}),m?_.jsx(R.div,{className:"ui-select__footer",__css:{...p.footer},children:m}):null]})});Xe.displayName="SelectList";Xe.__ui__="SelectList";export{ze as O,Mt as S,We as a,Ht as b,De as c,Xe as d,U as e,$e as f,Gt as u};
