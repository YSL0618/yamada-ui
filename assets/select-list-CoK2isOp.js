import{j as C}from"./extends-CwFRzn3r.js";import{r as o}from"./index-BwDkhjyp.js";import{f as oe}from"./forward-ref-BWI-Phbn.js";import{o as $e,V as Xe,U as Me,a7 as He,_ as Ye,F as W,aj as qe,W as Je,A as Qe,f as Ze,S as et,a as be,h as ne,d as he,t as Ie,an as tt,X as xe,b as A,c as J,p as st,j as nt}from"./factory-BgMvz7NM.js";import{u as ot}from"./index-Br7ZWcgB.js";import{c as lt,a as ct}from"./icon-CvhI1IwG.js";import{u as at}from"./index-Dz6agydm.js";import{c as it}from"./index-DkfW55MP.js";import{u as rt}from"./index-B6ycpjcM.js";import{u as ut}from"./index-BzBNm7Tp.js";import{u as dt,f as ft}from"./form-control-DAXawruh.js";import{b as pt}from"./popover-content-CkkufdAv.js";const mt=a=>{var s;return tt(a)&&!!((s=a==null?void 0:a.getAttribute("role"))!=null&&s.startsWith("option"))},{DescendantsContextProvider:At,useDescendantsContext:Ue,useDescendants:xt,useDescendant:bt}=it(),[Lt,G]=$e({strict:!1,name:"SelectContext"}),Nt=a=>{const{placeholder:s,closeOnSelect:l=!0,placeholderInOptions:u=!0,omitSelectedValues:n=!1,maxSelectValues:i,isEmpty:r,value:P,defaultValue:O,onChange:m,optionProps:x,isOpen:k,defaultIsOpen:I,onOpen:f,onClose:L,closeOnBlur:c=!0,closeOnEsc:v=!0,openDelay:_,closeDelay:N,isLazy:S,lazyBehavior:B,animation:le,duration:ce=.2,offset:K,gutter:Q,preventOverflow:ae,flip:Ce,matchWidth:ie=!0,boundary:X,eventListeners:ve,strategy:M,placement:Y="bottom-start",modifiers:Z,...V}=dt(a),{"aria-readonly":H,...D}=Xe(V,ft),[re,je]=Me(Ye(V,["aria-readonly"]),He),p=xt(),[T,g]=o.useState(-1),[De,Fe]=o.useState(!1),ue=o.useRef(null),we=o.useRef(null),Ee=o.useRef(null),$=o.useRef(new Set([])),[F,de]=at({value:P,defaultValue:O,onChange:m}),[q,ge]=o.useState(void 0),ee=T>-1,b=W(F),Ve=(b?!F.length:!F)&&!(s&&u),U=p.values(({node:e})=>b&&F.includes(e.dataset.value??"")).map(({index:e})=>e),R=p.enabledValues(({index:e})=>!U.includes(e)),fe=o.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledFirstValue();if(t)if(!b||!n)g(t.index);else if(U.includes(t.index)){const h=R[0];g(h.index)}else g(t.index)});$.current.add(e)},[p,R,b,n,U]),pe=o.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledLastValue();if(t)if(!b||!n)g(t.index);else if(U.includes(t.index)){const h=R.reverse()[0];g(h.index)}else g(t.index)});$.current.add(e)},[p,R,b,n,U]),_e=o.useCallback(()=>{const e=setTimeout(()=>{const h=p.enabledValues().find(({node:j})=>b?F.includes(j.dataset.value??""):j.dataset.value===F);h&&g(h.index)});$.current.add(e)},[p,b,F]),te=o.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledNextValue(T);if(t)if(!b||!n)g(t.index);else if(U.includes(t.index)){const h=R.find(({index:j})=>t.index<j)??R[0];g(h.index)}else g(t.index)});$.current.add(e)},[p,R,T,b,n,U,g]),Se=o.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledPrevValue(T);if(t)if(!b||!n)g(t.index);else if(U.includes(t.index)){const h=R.reverse().find(({index:j})=>j<t.index)??R[0];g(h.index)}else g(t.index)});$.current.add(e)},[p,R,T,b,n,U,g]),z=Ve||n?fe:_e,Te=Ve||n?pe:_e,ye=o.useCallback((e,t=!0)=>{const h=p.values();if(!h.length)return;const j=h.filter(({node:y})=>y.dataset.value===e).map(({node:y,index:se})=>{if(!(s&&u)||se!==0){const me=Array.from(y.children).find(Pe=>Pe.getAttribute("data-label")!==null);return(me==null?void 0:me.innerHTML)??""}else return});ge(y=>b?(j.forEach(se=>{W(y)&&y.includes(se??"")?t&&(y=W(y)?y.filter(Pe=>Pe!==se):void 0):y=[...W(y)?y:[],se]}),y):j[0])},[p,b,s,u]),Oe=o.useCallback(e=>{de(t=>W(t)?t.includes(e)?t.filter(j=>j!==e):[...t,e]:e),ye(e)},[ye,de]),Ge=o.useCallback(e=>{e.stopPropagation(),de([]),ge(void 0)},[ge,de]),{isOpen:d,onOpen:Re,onClose:w}=rt({isOpen:k,defaultIsOpen:I,onOpen:f,onClose:L}),E=o.useCallback(()=>{D.disabled||D.readOnly||r||De||Re()},[D,r,De,Re]),ke=o.useCallback(()=>{let e=p.value(T);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";Oe(t),l&&w(),n&&te()},[l,p,T,n,Oe,w,te]),Ae=o.useCallback(()=>{d||(E(),z())},[d,z,E]),Le=o.useCallback(()=>{d||(E(),z())},[d,z,E]),Ne=o.useCallback(e=>{const t=qe(e);Je(ue.current,t)||c&&d&&w()},[c,d,w]),Be=o.useCallback(e=>{if(e.key===" "&&(e.key=e.code),D.disabled||D.readOnly)return;const h={ArrowDown:ee?()=>te():d?void 0:xe(E,z),ArrowUp:ee?()=>Se():d?void 0:xe(E,Te),Space:ee?ke:d?void 0:xe(E,z),Enter:ee?ke:d?void 0:xe(E,z),Home:d?fe:void 0,End:d?pe:void 0,Escape:v?w:void 0}[e.key];h&&(e.preventDefault(),e.stopPropagation(),h())},[D.disabled,D.readOnly,ee,d,E,z,Te,ke,fe,pe,v,w,te,Se]);ut({ref:ue,handler:w,enabled:d&&c}),o.useEffect(()=>{if(!b||!n&&Qe(i))return;const e=F.length>0&&F.length===p.count(),t=F.length===i;e||t?(w(),Fe(!0)):Fe(!1)},[n,F,p,b,w,i]),Ze(()=>{d||g(-1)},[d]),et(()=>{$.current.forEach(e=>clearTimeout(e)),$.current.clear()});const Ke=o.useCallback(e=>({closeOnBlur:c,openDelay:_,closeDelay:N,isLazy:S,lazyBehavior:B,animation:le,duration:ce,offset:K,gutter:Q,preventOverflow:ae,flip:Ce,matchWidth:ie,boundary:X,eventListeners:ve,strategy:M,placement:Y,modifiers:Z,...e,trigger:"never",closeOnButton:!1,isOpen:d,onOpen:E,onClose:w}),[c,_,N,S,B,le,ce,K,Q,ae,Ce,ie,X,ve,M,Y,Z,d,E,w]),ze=o.useCallback((e={},t=null)=>({ref:be(ue,t),...re,...e,...D,onClick:ne(e.onClick,V.onClick,Ae),onBlur:ne(e.onBlur,V.onBlur,Ne)}),[re,D,Ne,Ae,V]),We=o.useCallback(({"aria-label":e,...t}={},h=null)=>{var j,y;return e??(e=s??`Select ${b?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:be(we,h),tabIndex:0,...je,...t,"data-active":he(d),"data-placeholder":he(b?!(q!=null&&q.length):q===void 0),"aria-controls":(j=Ee.current)==null?void 0:j.id,"aria-activedescendant":(y=p.value(T))==null?void 0:y.node.id,"aria-expanded":d,onFocus:ne(t.onFocus,V.onFocus,Le),onKeyDown:ne(t.onKeyDown,V.onKeyDown,Be)}},[p,je,T,d,b,q,s,V,Le,Be]);return{descendants:p,value:F,label:q,focusedIndex:T,placeholder:s,placeholderInOptions:u,omitSelectedValues:n,closeOnSelect:l,isOpen:d,containerRef:ue,fieldRef:we,listRef:Ee,optionProps:x,formControlProps:D,onChangeLabel:ye,onChange:Oe,onClear:Ge,onOpen:E,onClose:w,onFocusFirst:fe,onFocusLast:pe,onFocusSelected:_e,onFocusNext:te,onFocusPrev:Se,setFocusedIndex:g,getPopoverProps:Ke,getContainerProps:ze,getFieldProps:We}},ht=()=>{const{value:a,listRef:s,focusedIndex:l}=G(),u=Ue(),n=o.useRef(-1),i=u.value(l),r=W(a);o.useEffect(()=>{if(!s.current||!i||n.current===i.index)return;const m=s.current,x=i.node,k=m.clientHeight,I=m.scrollTop,f=I+k,L=x.clientHeight,c=x.offsetTop,v=c+L,_=I<=c&&v<=f,N=n.current<i.index;_||(v<=k?s.current.scrollTo({top:0}):N?s.current.scrollTo({top:v-k}):s.current.scrollTo({top:c+1})),n.current=i.index},[s,i]);const P=o.useId();return{getListProps:o.useCallback((m={},x=null)=>({id:P,ref:be(s,x),role:"listbox","aria-multiselectable":Ie(r),tabIndex:-1,position:"relative",...m}),[P,r,s])}},Ct=({label:a,...s})=>{const{value:l,omitSelectedValues:u}=G(),n=W(l),i=Ue(),r=i.values(),O=(n&&u?i.values(({node:c})=>l.includes(c.dataset.value??"")):[]).map(({index:c})=>c),x=!r.filter(({node:c,index:v})=>{var _;return((_=c.parentElement)==null?void 0:_.dataset.label)===a&&!O.includes(v)}).length,[k,I]=Me(s,He),f=o.useCallback((c={},v=null)=>({ref:v,...c,...k,style:x?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[k,x]),L=o.useCallback(({"aria-label":c,...v}={},_=null)=>(c??(c=a),{"aria-label":c,ref:_,role:"group",...v,...I,"data-label":a}),[I,a]);return{label:a,getContainerProps:f,getGroupProps:L}},vt=a=>{const{fieldRef:s,value:l,placeholder:u,placeholderInOptions:n,omitSelectedValues:i,closeOnSelect:r,focusedIndex:P,optionProps:O,onChange:m,onChangeLabel:x,onFocusNext:k,onClose:I,setFocusedIndex:f}=G();let{icon:L,isDisabled:c,isFocusable:v,closeOnSelect:_,children:N,value:S,...B}={...O,...a};const le=!!c&&!v,ce=o.useRef(null),{index:K,register:Q,descendants:ae}=bt({disabled:le}),ie=ae.values().slice(0,K),X=W(l),M=!(X?!1:ie.some(({node:H})=>H.dataset.value===(S??"")))&&(X?l.includes(S??""):(S??"")===l),Y=K===P;u&&K>0&&n&&!S&&console.warn(`${X?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const Z=o.useCallback(H=>{if(H.preventDefault(),H.stopPropagation(),c){s.current&&s.current.focus();return}if(!mt(H.currentTarget)){s.current&&s.current.focus();return}f(K),m(S??""),s.current&&s.current.focus(),(_??r)&&I(),i&&k()},[c,f,K,m,S,s,_,r,I,i,k]);o.useEffect(()=>{M&&x(S??"",!1)},[S,M,x]);const V=o.useCallback((H={},D=null)=>{const re={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:be(ce,D,Q),...B,...H,tabIndex:-1,style:i&&M?re:void 0,"data-value":S??"","data-focus":he(Y),"data-disabled":he(c),"aria-checked":Ie(M),"aria-disabled":Ie(c),onClick:ne(B.onClick,H.onClick,Z)}},[S,B,c,Y,M,i,Z,Q]);return{isSelected:M,isFocused:Y,customIcon:L,children:N,getOptionProps:V}},Bt=oe(({id:a,className:s,icon:l,...u},n)=>{const{styles:i}=G(),{isSelected:r,customIcon:P,children:O,getOptionProps:m}=vt(u);a??(a=o.useId()),l??(l=P);const x={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...i.item};return C.jsxs(A.li,{id:a,className:J("ui-select__item",s),__css:x,...m({},n),children:[l!==null?C.jsx(gt,{opacity:r?1:0,children:l||C.jsx(_t,{})}):null,C.jsx(A.span,{style:{flex:1},"data-label":!0,children:O})]})}),gt=oe(({className:a,...s},l)=>{const{styles:u}=G(),n={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...u.itemIcon};return C.jsx(A.span,{ref:l,className:J("ui-select__item__icon",a),__css:n,...s})}),_t=()=>C.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:C.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Mt=oe(({className:a,color:s,h:l,height:u,minH:n,minHeight:i,children:r,labelProps:P,...O},m)=>{const{styles:x}=G(),{label:k,getContainerProps:I,getGroupProps:f}=Ct(O);return l??(l=u),n??(n=i),C.jsxs(A.li,{className:J("ui-select__item","ui-select__item--group",a),__css:{w:"100%",h:"fit-content",color:s},...I(),children:[C.jsx(A.span,{className:"ui-select__item__group-label",__css:x.groupLabel,lineClamp:1,...P,children:k}),C.jsx(A.ul,{...f({},m),className:"ui-select__item__group",__css:{h:l,minH:n,...x.group},children:r})]})}),St=oe(({className:a,children:s,__css:l,...u},n)=>{const{styles:i}=G(),r={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...i.icon,...l},O=st(s).map(m=>o.cloneElement(m,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return C.jsx(A.div,{ref:n,className:J("ui-select__icon",a),__css:r,...u,children:nt(s)?O:C.jsx(lt,{})})}),Ht=({className:a,children:s,...l})=>{const u=o.useRef(null),{styles:n}=G(),i=l.disabled,r=ot({ref:u,isDisabled:i,...l});return C.jsx(St,{"aria-label":"Clear value",className:J("ui-select__clear-icon",a),__css:n.clearIcon,...r,children:s??C.jsx(ct,{w:"0.5em",h:"0.5em"})})},Ut=oe(({className:a,w:s,width:l,minW:u,minWidth:n,maxW:i,maxWidth:r,contentProps:P,header:O,footer:m,children:x,...k},I)=>{var c,v,_,N,S,B;const{styles:f}=G(),{getListProps:L}=ht();return l??(l=s),l??(l=((c=f.list)==null?void 0:c.width)??((v=f.list)==null?void 0:v.w)),n??(n=u),n??(n=((_=f.list)==null?void 0:_.minWidth)??((N=f.list)==null?void 0:N.minW)),r??(r=i),r??(r=((S=f.list)==null?void 0:S.maxWidth)??((B=f.list)==null?void 0:B.maxW)),C.jsxs(pt,{as:"div",className:"ui-select__content",width:l,minWidth:n,maxWidth:r,__css:{...f.content,width:l,minWidth:n,maxWidth:r},...P,children:[O?C.jsx(A.div,{className:"ui-select__header",__css:{...f.header},children:O}):null,C.jsx(A.ul,{className:J("ui-select__list",a),__css:{...f.list},...L(k,I),children:x}),m?C.jsx(A.div,{className:"ui-select__footer",__css:{...f.footer},children:m}):null]})});export{Bt as O,At as S,Mt as a,Lt as b,St as c,Ut as d,G as e,Ht as f,Nt as u};
