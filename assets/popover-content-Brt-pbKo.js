import{r}from"./index-BwDkhjyp.js";import{j as M}from"./extends-CwFRzn3r.js";import{b as se}from"./index-is6smmpS.js";import{u as ie,a as ue}from"./index-BM_Ccg1d.js";import{u as le,a as ce,b as ae}from"./index-C53kKj3W.js";import{u as fe}from"./index-B6Y8FPE8.js";import{l as me,a as N,h as l,B as de,ag as L,U as R,c as Z,t as pe,w as ve,b as ge,V as Pe}from"./factory-BjF4_dRw.js";import{a as Ce}from"./use-component-style-DVO-iEPi.js";import{o as he}from"./theme-provider-CpaSpGZh.js";import{C as be}from"./close-button-B01cMkKC.js";import{f as xe}from"./forward-ref-BWI-Phbn.js";import{s as S}from"./slide-fade-DE5mVSQd.js";import{s as ye}from"./scale-fade-5IkQq2Gw.js";import{m as Be}from"./forward-ref-scR1bmHx.js";import{m as Re}from"./factory-COh1-7fC.js";const[Te,H]=me({strict:!1,name:"PopoverContext"}),Ye=m=>{const[a,s]=Ce("Popover",m),{children:T,initialFocusRef:g,restoreFocus:P=!0,autoFocus:w=!0,closeOnBlur:f=!0,closeOnEsc:D=!0,closeOnButton:E=!0,trigger:c="click",openDelay:x=200,closeDelay:y=200,isLazy:A,lazyBehavior:z="unmount",animation:_="scale",duration:I,relatedRef:C,...K}=he(s),{isOpen:t,onOpen:h,onClose:i,onToggle:j}=ie(s),F=r.useRef(null),B=r.useRef(null),d=r.useRef(null),{present:X,onAnimationComplete:e}=se({isOpen:t,ref:d}),p=r.useRef(void 0),Y=r.useRef(void 0),k=r.useRef(!1),U=r.useRef(!1);t&&(U.current=!0);const{referenceRef:V,getPopperProps:$,forceUpdate:q,transformOrigin:G}=fe({...K,enabled:t});r.useEffect(()=>()=>{p.current&&clearTimeout(p.current),Y.current&&clearTimeout(Y.current)},[]),le({enabled:t,ref:B}),ce(d,{focusRef:B,visible:t,shouldFocus:P&&(c==="click"||c==="contextmenu")}),ae(d,{focusRef:g,visible:t,shouldFocus:w&&(c==="click"||c==="contextmenu")});const J=ue({wasSelected:U.current,enabled:A,mode:z,isSelected:X}),ee=r.useCallback((o={},O=null)=>{const u={...o,style:{...o.style,transformOrigin:G},ref:N(d,O),children:J?o.children:null,tabIndex:-1,onKeyDown:l(o.onKeyDown,n=>{D&&n.key==="Escape"&&i()}),onBlur:l(o.onBlur,n=>{const v=L(n),b=R(d.current,v),ne=R(B.current,v),re=C!=null&&C.current?R(C.current,v):!1;t&&f&&(!b&&!ne&&!re)&&i()})};return c==="hover"&&(u.onMouseEnter=l(o.onMouseEnter,()=>{k.current=!0}),u.onMouseLeave=l(o.onMouseLeave,n=>{n.nativeEvent.relatedTarget!==null&&(k.current=!1,f&&setTimeout(i,y))})),u},[y,f,D,t,i,J,G,c,C]),Q=r.useCallback(o=>{F.current==null&&V(o)},[V]),oe=r.useCallback((o={},O=null)=>{const u={...o,ref:N(B,O,Q)};return c==="click"&&(u.onClick=l(o.onClick,j),u.onBlur=l(o.onBlur,n=>{const v=L(n),b=!R(d.current,v);t&&f&&b&&i()})),c==="contextmenu"&&(u.onContextMenu=l(o.onContextMenu,n=>{n.preventDefault(),h()}),u.onBlur=l(o.onBlur,n=>{const v=L(n),b=!R(d.current,v);t&&f&&b&&i()})),c==="hover"&&(u.onFocus=l(o.onFocus,()=>{p.current===void 0&&h()}),u.onBlur=l(o.onBlur,n=>{const v=L(n),b=!R(d.current,v);t&&f&&b&&i()}),u.onKeyDown=l(o.onKeyDown,n=>{n.key==="Escape"&&i()}),u.onMouseEnter=l(o.onMouseEnter,()=>{k.current=!0,p.current=window.setTimeout(h,x)}),u.onMouseLeave=l(o.onMouseLeave,()=>{k.current=!1,p.current&&(clearTimeout(p.current),p.current=void 0),Y.current=window.setTimeout(()=>{k.current||i()},y)})),u},[y,f,t,Q,i,h,j,x,c]),te=r.useCallback((o={},O=null)=>({...o,ref:N(O,F,V)}),[F,V]);return M.jsx(Te,{value:{isOpen:t,onClose:i,closeOnButton:E,onAnimationComplete:e,forceUpdate:q,getTriggerProps:oe,getAnchorProps:te,getPopperProps:$,getPopoverProps:ee,animation:_,duration:I,styles:a},children:de(T,{isOpen:t,onClose:i,forceUpdate:q})})},Ne=({children:m})=>{const a=r.Children.only(m),{getTriggerProps:s}=H();return r.cloneElement(a,s(a.props,a.ref))},W=xe(({onClick:m,...a},s)=>{const{styles:T,onClose:g}=H(),P={position:"absolute",...T.closeButton};return M.jsx(be,{ref:s,className:Z("ui-popover__close-button"),__css:P,onClick:l(m,w=>{w.stopPropagation(),g==null||g()}),size:"sm",...a})}),we=(m="scale",a)=>{const s={reverse:!0,duration:a,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(m){case"scale":return{...ye,custom:{...s,scale:.95}};case"top":return{...S,custom:{...s,offsetX:0,offsetY:-16}};case"right":return{...S,custom:{...s,offsetX:16,offsetY:0}};case"left":return{...S,custom:{...s,offsetX:-16,offsetY:0}};case"bottom":return{...S,custom:{...s,offsetX:0,offsetY:16}}}},He=Be(({as:m="section",className:a,containerProps:s,children:T,w:g,width:P,minW:w,minWidth:f,maxW:D,maxWidth:E,z:c,zIndex:x,__css:y,...A},z)=>{const{isOpen:_,closeOnButton:I,getPopperProps:C,getPopoverProps:K,onAnimationComplete:t,animation:h,duration:i,styles:j}=H(),F=pe(T),[B,...d]=ve(F,W),X=r.useMemo(()=>Re(m),[m]),e=y??j.container??{},p={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...e};return P??(P=g),P??(P=(e==null?void 0:e.width)??(e==null?void 0:e.w)),f??(f=w),f??(f=(e==null?void 0:e.minWidth)??(e==null?void 0:e.minW)),E??(E=D),E??(E=(e==null?void 0:e.maxWidth)??(e==null?void 0:e.maxW)),x??(x=c),x??(x=(e==null?void 0:e.zIndex)??(e==null?void 0:e.z)),M.jsx(ge.div,{...C({style:{visibility:_?"visible":"hidden"}}),className:"ui-popover",width:P,minWidth:f,maxWidth:E,zIndex:x,...s,children:M.jsxs(X,{className:Z("ui-popover__content",a),...h!=="none"?we(h,i):{},...K(A,z),initial:"exit",animate:_?"enter":"exit",exit:"exit",onAnimationComplete:Pe(t,A.onAnimationComplete),__css:p,children:[B??(I?M.jsx(W,{}):null),d]})})});export{Ye as P,Ne as a,He as b,W as c,H as u};
