import{j as f}from"./extends-CwFRzn3r.js";import{f as ie}from"./forward-ref-BWI-Phbn.js";import{o as Bt,p as yt,b as N,c as Z,j as Ht,f as xe,a as Le,t as zt,d as Ce,h as J,aP as Gt,F as Y,z as ht,V as vt,a6 as At,W as Jt,A as bt,af as Ut,X as Kt,S as $t,Y as Me}from"./factory-BPGpAF5Z.js";import{r as t}from"./index-BwDkhjyp.js";import{b as Wt}from"./popover-trigger-BJsmlD02.js";import{u as Yt}from"./index-CJwZPsS_.js";import{u as Xt}from"./index-BSZzY47h.js";import{u as qt}from"./index-DjrrK_0S.js";import{c as Qt}from"./index-oQ85FuiM.js";import{u as Zt}from"./index-DYLohKMc.js";import{c as es,a as ts}from"./icon-BYVaiKtb.js";import{u as ss,f as os}from"./form-control-CY2fHU0c.js";const{DescendantsContextProvider:Ps,useDescendant:ns,useDescendants:ls,useDescendantsContext:Qe}=Qt(),[ws,F]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),Ze=ie(({className:l,children:i,__css:n,...s},c)=>{const{styles:r}=F(),m={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...r.icon,...n},_=yt(i).map(v=>t.cloneElement(v,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return f.jsx(N.div,{ref:c,className:Z("ui-autocomplete__icon",l),__css:m,...s,children:Ht(i)?_:f.jsx(es,{})})});Ze.displayName="AutocompleteIcon";Ze.__ui__="AutocompleteIcon";const It=({className:l,children:i,...n})=>{const s=t.useRef(null),{styles:c}=F(),r=n.disabled,m=Zt({ref:s,isDisabled:r,...n});return f.jsx(Ze,{className:Z("ui-autocomplete__icon--clear",l),"aria-label":"Clear value",__css:c.clearIcon,...m,children:i??f.jsx(ts,{h:"0.5em",w:"0.5em"})})};It.displayName="AutocompleteClearIcon";It.__ui__="AutocompleteClearIcon";const Ae=ie(({className:l,...i},n)=>{const{styles:s}=F(),c={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...s.itemIcon};return f.jsx(N.span,{ref:n,className:Z("ui-autocomplete__item__icon",l),__css:c,...i})});Ae.displayName="AutocompleteItemIcon";Ae.__ui__="AutocompleteItemIcon";const is=l=>{var i;return Gt(l)&&!!((i=l.getAttribute("role"))!=null&&i.startsWith("option"))},as=l=>{var Se;const{closeOnSelect:i,focusedIndex:n,inputRef:s,omitSelectedValues:c,setFocusedIndex:r,value:m,optionProps:p,onChange:_,onChangeLabel:v,onClose:y,onFocusNext:S}=F(),j=t.useId();let{children:h,closeOnSelect:R,icon:A,isDisabled:x,isFocusable:E,value:O,...L}={...p,...l};const ae=!!x&&!E,B=t.useRef(null),{descendants:Ie,index:X,register:ce}=ns({disabled:ae}),ke=Ie.values().slice(0,X),w=Y(m),q=!(w?!1:ke.some(({node:U})=>U.dataset.value===(O??"")))&&(w?m.includes(O??""):(O??"")===m),ge="target"in(((Se=B.current)==null?void 0:Se.dataset)??{}),re=X===n,he=t.useCallback(U=>{if(U.stopPropagation(),x){s.current&&s.current.focus();return}if(!is(U.currentTarget)){s.current&&s.current.focus();return}r(X),_(O??""),s.current&&s.current.focus(),(R??i)&&y(),c&&S(X)},[S,c,x,O,r,X,_,R,i,y,s]);xe(()=>{q&&v(O??"",{runOmit:!1})},[O]);const ze=t.useCallback((U={},Ge=null)=>{const ue={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{id:j,ref:Le(B,Ge,ce),role:"option",...L,...U,style:!ge||c&&q?ue:void 0,"aria-checked":q,"aria-disabled":zt(x),"data-disabled":Ce(x),"data-focus":Ce(re),"data-target":Ce(!0),"data-value":O??"",tabIndex:-1,onClick:J(L.onClick,U.onClick,he)}},[j,O,L,x,re,q,ge,c,he,ce]);return{children:h,customIcon:A,isFocused:re,isSelected:q,getOptionProps:ze}},cs=()=>{const{isHit:l,onCreate:i}=F();return{getCreateProps:t.useCallback((s={},c=null)=>({ref:c,...s,style:l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"data-focus":Ce(!l),tabIndex:-1,onClick:J(s.onClick,i)}),[l,i])}},rs=()=>{const{isEmpty:l,isHit:i}=F();return{getEmptyProps:t.useCallback((s={},c=null)=>({ref:c,...s,style:i&&!l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,tabIndex:-1}),[i,l])}},kt=ie(({className:l,children:i,icon:n,...s},c)=>{const{inputValue:r,styles:m}=F(),{getCreateProps:p}=cs();i??(i=r);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...m.item};return f.jsxs(N.li,{className:Z("ui-autocomplete__item--create",l),__css:_,...p(s,c),children:[n!==null?f.jsx(Ae,{children:n||f.jsx(et,{})}):null,n?f.jsx(N.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:ht(i,r)}):ht(i,r)]})});kt.displayName="AutocompleteCreate";kt.__ui__="AutocompleteCreate";const et=()=>f.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:f.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});et.displayName="AutocompletePlusIcon";et.__ui__="AutocompletePlusIcon";const St=ie(({className:l,children:i,icon:n,...s},c)=>{const{emptyMessage:r,styles:m}=F(),{getEmptyProps:p}=rs();i??(i=r);const _={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...m.item};return f.jsxs(N.li,{className:Z("ui-autocomplete__item--empty",l),__css:_,...p(s,c),children:[n!==null?f.jsx(Ae,{children:n||f.jsx(tt,{})}):null,n?f.jsx(N.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:i}):i]})});St.displayName="AutocompleteEmpty";St.__ui__="AutocompleteEmpty";const tt=()=>f.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:f.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});tt.displayName="AutocompleteMinusIcon";tt.__ui__="AutocompleteMinusIcon";const us=()=>{const l=t.useId(),{focusedIndex:i,isOpen:n,listRef:s,rebirthOptions:c}=F(),r=Qe(),m=t.useRef(-1),p=r.value(i),_=t.useCallback(()=>{n||c(!1)},[n,c]);return t.useEffect(()=>{if(!s.current||!p||m.current===p.index)return;const y=s.current,S=p.node,j=y.clientHeight,h=y.scrollTop,R=h+j,A=S.clientHeight,x=S.offsetTop,E=x+A,O=h<=x&&E<=R,L=m.current<p.index;O||(E<=j?s.current.scrollTo({top:0}):L?s.current.scrollTo({top:E-j}):s.current.scrollTo({top:x+1})),m.current=p.index},[s,p]),xe(()=>{n||(m.current=-1)},[n]),{getListProps:t.useCallback((y={},S=null)=>({id:y.id??l,ref:Le(s,S),as:"ul",position:"relative",role:"listbox",tabIndex:-1,...y}),[s,l]),onAnimationComplete:_}},Ot=ie(({className:l,children:i,footer:n,header:s,maxW:c,maxWidth:r,minW:m,minWidth:p,w:_,width:v,contentProps:y,...S},j)=>{var x,E,O,L,ae,B;const{styles:h}=F(),{getListProps:R,onAnimationComplete:A}=us();return v??(v=_),v??(v=((x=h.list)==null?void 0:x.width)??((E=h.list)==null?void 0:E.w)),p??(p=m),p??(p=((O=h.list)==null?void 0:O.minWidth)??((L=h.list)==null?void 0:L.minW)),r??(r=c),r??(r=((ae=h.list)==null?void 0:ae.maxWidth)??((B=h.list)==null?void 0:B.maxW)),f.jsxs(Wt,{as:"div",className:"ui-autocomplete__popover",maxWidth:r,minWidth:p,width:v,__css:{...h.content,maxWidth:r,minWidth:p,width:v},...y,onAnimationComplete:J(y==null?void 0:y.onAnimationComplete,A),children:[s?f.jsx(N.div,{className:"ui-autocomplete__header",__css:{...h.header},children:s}):null,f.jsx(N.ul,{className:Z("ui-autocomplete__list",l),__css:{...h.list},...R(S,j),children:i}),n?f.jsx(N.div,{className:"ui-autocomplete__footer",__css:{...h.footer},children:n}):null]})});Ot.displayName="AutocompleteList";Ot.__ui__="AutocompleteList";const Te=ie(({className:l,icon:i,...n},s)=>{const{styles:c}=F(),{children:r,customIcon:m,isSelected:p,getOptionProps:_}=as(n);i??(i=m);const v={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...c.item};return f.jsxs(N.li,{className:Z("ui-autocomplete__item",l),__css:v,..._({},s),children:[i!==null?f.jsx(Ae,{opacity:p?1:0,children:i||f.jsx(st,{})}):null,f.jsx(N.span,{style:{flex:1},"data-label":!0,children:r})]})});Te.displayName="AutocompleteOption";Te.__ui__="AutocompleteOption";const st=()=>f.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:f.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});st.displayName="AutocompleteCheckIcon";st.__ui__="AutocompleteCheckIcon";const ds=({label:l,...i})=>{const{omitSelectedValues:n,value:s}=F(),c=Y(s),r=Qe(),m=r.values(),_=(c&&n?r.values(({node:A})=>s.includes(A.dataset.value??"")):[]).map(({index:A})=>A),y=!m.filter(({index:A,node:x})=>{var E;return((E=x.parentElement)==null?void 0:E.dataset.label)===l&&!_.includes(A)&&"target"in x.dataset}).length,[S,j]=vt(i,At),h=t.useCallback((A={},x=null)=>({ref:x,...A,...S,style:y?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"data-label":l,role:"autocomplete-group-container"}),[S,y,l]),R=t.useCallback((A={},x=null)=>({ref:x,...A,...j,"data-label":l,role:"autocomplete-group"}),[j,l]);return{label:l,getContainerProps:h,getGroupProps:R}},ot=ie(({className:l,children:i,color:n,h:s,height:c,minH:r,minHeight:m,labelProps:p,..._},v)=>{const{styles:y}=F(),{label:S,getContainerProps:j,getGroupProps:h}=ds(_);return s??(s=c),r??(r=m),f.jsxs(N.li,{className:Z("ui-autocomplete__item","ui-autocomplete__item--group",l),__css:{color:n,h:"fit-content",w:"100%"},...j(),children:[f.jsx(N.span,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:y.groupLabel,...p,children:S}),f.jsx(N.ul,{...h({},v),className:"ui-autocomplete__item__group",__css:{h:s,minH:r,...y.group},children:i})]})});ot.displayName="AutocompleteOptionGroup";ot.__ui__="AutocompleteOptionGroup";const _t={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},ps=l=>{l=l.replace(/[！-～]/g,n=>String.fromCharCode(n.charCodeAt(0)-65248));const i=new RegExp("("+Object.keys(_t).join("|")+")","g");return l=l.replace(i,n=>_t[n]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),l=l.toUpperCase(),l},ms=l=>{const i=n=>n.map(s=>{const{isDisabled:c,isFocusable:r}=s;if(!(c&&!r))return"items"in s?i(s.items??[]):s}).filter(Boolean);return i(l).flat(1/0)},js=l=>{const{allowCreate:i=!1,allowFree:n=!1,animation:s,boundary:c,children:r,closeDelay:m,closeOnBlur:p=!0,closeOnEsc:_=!0,closeOnSelect:v=!0,defaultIsOpen:y,defaultValue:S,duration:j=.2,emptyMessage:h="No results found",eventListeners:R,flip:A,format:x=ps,gutter:E,insertPositionItem:O="first",isLazy:L,isOpen:ae,items:B,lazyBehavior:Ie,matchWidth:X=!0,maxSelectValues:ce,modifiers:Be,offset:ke,omitSelectedValues:w=!1,openDelay:He,placeholder:q,placement:ge="bottom-start",preventOverflow:re,strategy:he,value:ze,optionProps:Se,onChange:U,onClose:Ge,onCreate:ue,onKeyDown:nt,onOpen:Pt,onSearch:Oe,...de}=ss(l),{"aria-readonly":fs,onFocus:lt,...H}=Jt(de,os),[it,wt]=vt(de,At),{id:jt}=de,b=ls(),Je=t.useRef(null),at=t.useRef(null),ee=t.useRef(null),te=t.useRef(new Set([])),Ue=t.useRef(!1),Pe=t.useRef(void 0),[se,ct]=t.useState(B?JSON.parse(JSON.stringify(B)):void 0),[k,we]=Yt({defaultValue:S,value:ze,onChange:U}),[Ke,je]=t.useState(void 0),[V,pe]=t.useState(""),[K,P]=t.useState(-1),[oe,rt]=t.useState(!1),[me,ut]=t.useState(!0),{isOpen:C,onClose:M,onOpen:dt}=Xt({defaultIsOpen:y,isOpen:ae,onClose:Ge,onOpen:Pt}),be=K>-1,$e=K===-2&&i,g=Y(k),Ee=g?!k.length:!k,[_e,pt]=t.useMemo(()=>Y(O)?O:[O,"first"],[O]);i&&!bt(r)&&console.warn(`${g?"MultiAutocomplete":"Autocomplete"}: ${g?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const $=b.enabledValues(({node:e})=>g&&k.includes(e.dataset.value??"")).map(({index:e})=>e),G=b.enabledValues(({index:e,node:o})=>"target"in o.dataset&&!$.includes(e)),Et=yt(r),Ve=t.useMemo(()=>se==null?void 0:se.map((e,o)=>{if("value"in e){const{label:a,value:u,...d}=e;return f.jsx(Te,{value:u,...d,children:a},o)}else if("items"in e){const{items:a=[],label:u,...d}=e;return f.jsx(ot,{label:u,...d,children:a.map(({label:I,value:z,...le},Lt)=>f.jsx(Te,{value:z,...le,children:I},Lt))},o)}}),[se]),ne=!Et.length&&!(Ve!=null&&Ve.length),D=t.useCallback(()=>{H.disabled||H.readOnly||!i&&(ne||oe)||(dt(),ee.current&&ee.current.focus())},[i,H,oe,ne,dt]),fe=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const o=b.enabledFirstValue(({node:a})=>"target"in a.dataset);if(o)if(!g||!w)P(o.index);else if($.includes(o.index)){const a=G[0];P((a==null?void 0:a.index)??-1)}else P(o.index)});te.current.add(e)},[b,G,oe,ne,g,w,$]),De=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const o=b.enabledLastValue(({node:a})=>"target"in a.dataset);if(o)if(!g||!w)P(o.index);else if($.includes(o.index)){const a=G.reverse()[0];P((a==null?void 0:a.index)??-1)}else P(o.index)});te.current.add(e)},[b,G,oe,ne,g,w,$]),We=t.useCallback(()=>{const e=setTimeout(()=>{const a=b.enabledValues().find(({node:u})=>g?k.includes(u.dataset.value??""):u.dataset.value===k);a&&P(a.index)});te.current.add(e)},[b,g,k]),ye=t.useCallback((e=K)=>{const o=setTimeout(()=>{const a=b.enabledNextValue(e,({node:u})=>"target"in u.dataset);if(a)if(!g||!w)P(a.index);else if($.includes(a.index)){const u=G.find(({index:d})=>a.index<d)??G[0];P((u==null?void 0:u.index)??-1)}else P(a.index)});te.current.add(o)},[b,G,K,g,w,$]),Ye=t.useCallback((e=K)=>{const o=setTimeout(()=>{const a=b.enabledPrevValue(e,({node:u})=>"target"in u.dataset);if(a)if(!g||!w)P(a.index);else if($.includes(a.index)){const u=G.reverse().find(({index:d})=>d<a.index)??G[0];P((u==null?void 0:u.index)??-1)}else P(a.index)});te.current.add(o)},[b,G,K,g,w,$]),Q=Ee||w?fe:We,mt=Ee||w?De:We,Xe=t.useCallback(e=>{const o=b.values();let a=!1,u=!1;o.forEach(({index:d,node:I})=>{if(x(I.textContent??"").includes(e)){a=!0;const z="disabled"in I.dataset;I.dataset.target="",!u&&!z&&(u=!0,P(d))}else delete I.dataset.target}),ut(a)},[b,x]),W=t.useCallback((e=!0)=>{b.values().forEach(({node:a})=>{a.dataset.target=""}),e&&fe(),ut(!0)},[b,fe]),Ne=t.useCallback(e=>{const o=b.enabledValues();return(Y(e)?e:[e]).map(d=>{const{node:I}=o.find(({node:z})=>z.dataset.value===d)??{};if(I){const z=Array.from(I.children).find(le=>le.getAttribute("data-label")!==null);return(z==null?void 0:z.textContent)??void 0}else return n?d:void 0}).filter(Boolean)},[n,b]),ve=t.useCallback((e,{forceUpdate:o,runOmit:a=!0}={})=>{const u=Ne(e);!o&&!u.length||je(d=>g?(u.forEach(I=>{Y(d)&&d.includes(I)?a&&(d=Y(d)?d.filter(le=>le!==I):void 0):d=[...Y(d)?d:[],I]}),d):u[0])},[Ne,g]),T=t.useCallback((e,{forceUpdate:o,runRebirth:a=!0}={})=>{we(d=>{let I;return Y(d)?d.includes(e)?I=d.filter(le=>le!==e):I=[...d,e]:I=e,Pe.current=I,I});const u=b.values().filter(({node:d})=>x(d.textContent??"").includes(e)).length>0;ve(e,{forceUpdate:o}),(n||u)&&pe(""),g&&a&&W(!1)},[n,g,ve,W,we,b,x]),qe=t.useCallback(()=>{let e=b.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const o=e.node.dataset.value??"";T(o),v&&M(),w&&ye()},[v,b,K,w,T,M,ye]),Vt=t.useCallback(e=>{C||D(),Oe==null||Oe(e);const o=e.target.value,a=x(o);a?Xe(a):W(),pe(o)},[C,D,x,Oe,Xe,W]),Dt=t.useCallback(()=>{Ue.current=!0},[]),Nt=t.useCallback(()=>{Ue.current=!1},[]),Fe=t.useCallback(()=>{if(!at.current)return;const e={label:V,value:V};let o=[];if(se&&(o=[...se]),_e==="first")o=[e,...o];else if(_e==="last")o=[...o,e];else{const u=o.findIndex(({label:I})=>I===_e),d=o[u];u!==-1&&d&&"items"in d?(pt==="first"?d.items=[e,...d.items??[]]:d.items=[...d.items??[],e],o[u]=d):console.warn(`${g?"MultiAutocomplete":"Autocomplete"}: '${_e}' specified in insertPositionItem does not exist in the option group.`)}ct(o),T(V),W(!1);const a=ms(o).findIndex(({value:u})=>u===V);P(a),ue==null||ue(e,o)},[V,se,_e,T,W,ue,pt,g]),ft=t.useCallback(()=>{C?ee.current&&ee.current.focus():(D(),Q())},[C,Q,D]),Re=t.useCallback(()=>{C||(D(),Q())},[C,Q,D]),xt=t.useCallback(e=>{const o=Ut(e);Kt(Je.current,o)||!p&&me||(n&&V&&T(V,{runRebirth:!1}),pe(""),C&&M())},[p,me,C,V,n,M,T]),Ct=t.useCallback(()=>{g?T(k[k.length-1]):T("",{forceUpdate:!0}),C||Re()},[g,C,T,Re,k]),Ft=t.useCallback(e=>{e.stopPropagation(),Pe.current=[],we([]),je(void 0),pe(""),W(),C&&ee.current&&ee.current.focus()},[C,je,pe,we,W]),gt=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),H.disabled||H.readOnly||Ue.current)return;const o=Ke===V||!V.length,u={ArrowDown:be?()=>ye():C?void 0:Me(D,Q),ArrowUp:be?()=>Ye():C?void 0:Me(D,mt),Backspace:!Ee&&o?Ct:void 0,End:C?De:void 0,Enter:$e?Fe:be?qe:C?n&&g?()=>{V&&T(V),P(0)}:void 0:Me(D,Q),Escape:_?M:void 0,Home:C?fe:void 0,Space:$e?Fe:be?qe:C?void 0:Me(D,Q)}[e.key];u&&(e.preventDefault(),e.stopPropagation(),u(e))},[n,H,Ke,V,D,be,g,Q,ye,mt,Ye,$e,Fe,qe,C,fe,De,_,M,Ee,Ct,T]);t.useEffect(()=>{if(!g||!w&&bt(ce))return;const e=k.length>0&&k.length===b.count(),o=k.length===ce;e||o?(M(),rt(!0)):rt(!1)},[w,k,b,g,M,ce]),t.useEffect(()=>{if(g){if(JSON.stringify(Pe.current??[])===JSON.stringify(k))return;const e=Ne(k);je(e)}else{if(Pe.current===k)return;ve(k,{runOmit:!1})}},[g,k,ve,Ne]),xe(()=>{C||n||(P(-1),pe(""))},[C]),xe(()=>{me||P(-2)},[me]),xe(()=>{ct(B?JSON.parse(JSON.stringify(B)):void 0)},[B]),$t(()=>{te.current.forEach(e=>clearTimeout(e)),te.current.clear()}),qt({ref:Je,enabled:C&&(p||!me),handler:M});const Rt=t.useCallback(e=>({animation:s,boundary:c,closeDelay:m,closeOnBlur:p,duration:j,eventListeners:R,flip:A,gutter:E,isLazy:L,lazyBehavior:Ie,matchWidth:X,modifiers:Be,offset:ke,openDelay:He,placement:ge,preventOverflow:re,strategy:he,...e,closeOnButton:!1,isOpen:C,trigger:"never",onClose:M,onOpen:D}),[p,He,m,L,Ie,s,j,ke,E,re,A,X,c,R,he,ge,Be,C,D,M]),Mt=t.useCallback((e={},o=null)=>({ref:Le(Je,o),...it,...e,...H,onBlur:J(e.onBlur,de.onBlur,xt),onClick:J(e.onClick,de.onClick,ft)}),[it,H,xt,ft,de]),Tt=t.useCallback((e={},o=null)=>({ref:o,tabIndex:-1,...e,...H,"aria-expanded":Ce(C),"data-active":Ce(C),placeholder:q,onFocus:J(e.onFocus,lt,Re),onKeyDown:J(e.onKeyDown,nt,gt)}),[H,q,C,lt,Re,nt,gt]);return{id:jt,allowCreate:i,allowFree:n,closeOnSelect:v,computedChildren:Ve,descendants:b,emptyMessage:h,focusedIndex:K,inputRef:ee,inputValue:V,isAllSelected:oe,isEmpty:ne,isHit:me,isOpen:C,label:Ke,listRef:at,omitSelectedValues:w,pickOptions:Xe,rebirthOptions:W,setFocusedIndex:P,value:k,formControlProps:H,getContainerProps:Mt,getFieldProps:Tt,getPopoverProps:Rt,inputProps:wt,optionProps:Se,onChange:T,onChangeLabel:ve,onClear:Ft,onClose:M,onCompositionEnd:Nt,onCompositionStart:Dt,onCreate:Fe,onFocusFirst:fe,onFocusLast:De,onFocusNext:ye,onFocusPrev:Ye,onFocusSelected:We,onOpen:D,onSearch:Vt}},Es=()=>{const{id:l,focusedIndex:i,inputRef:n,isAllSelected:s,isOpen:c,listRef:r,formControlProps:m,inputProps:p,onCompositionEnd:_,onCompositionStart:v,onSearch:y}=F(),{value:S}=Qe();return xe(()=>{s&&n.current&&n.current.blur()},[s]),{getInputProps:t.useCallback((h={},R=null)=>{var A,x;return{ref:Le(n,R),...m,"aria-activedescendant":(A=S(i))==null?void 0:A.node.id,"aria-autocomplete":"list","aria-controls":(x=r.current)==null?void 0:x.id,"aria-expanded":c,"aria-haspopup":"listbox",autoCapitalize:"none",autoComplete:"off",role:"combobox",spellCheck:"false",...p,...h,id:l,cursor:m.readOnly?"default":"text",pointerEvents:m.disabled||s?"none":"auto",tabIndex:s?-1:0,onChange:J(h.onChange,y),onCompositionEnd:J(h.onCompositionEnd,p.onCompositionEnd,_),onCompositionStart:J(h.onCompositionStart,p.onCompositionStart,v)}},[r,i,c,p,n,m,l,s,S,y,v,_])}};export{Ps as A,ws as a,Ze as b,Ot as c,kt as d,St as e,F as f,Es as g,Te as h,ot as i,It as j,js as u};
