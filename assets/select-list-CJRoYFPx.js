import{j as b}from"./jsx-runtime-CfatFE5O.js";import{u as dt}from"./index-C58se0b8.js";import{r as s}from"./index-ClcD9ViR.js";import{a as pt,C as ft}from"./icon-BodRPJCf.js";import{f as ie}from"./forward-ref-D13m8o2p.js";import{E as Ve,a4 as mt,g as xt,a as ce,x as Qe,d as ae,h as le,aq as ht,J as Q,b as M,c as ee,Y as et,a9 as tt,p as bt,Z as Ct,a2 as vt,q as st,am as gt,_ as _t,$ as ge,u as St,f as yt,X as Ot,j as It}from"./factory-COau3w21.js";import{u as Pt}from"./index-DPt_fcIQ.js";import{c as kt}from"./index-Btt-sfjQ.js";import{u as jt}from"./index-BcE809qD.js";import{u as wt}from"./index-Blij8Q7p.js";import{c as Dt,f as Et}from"./form-control-Y8qD5MxJ.js";import{b as Ft}from"./popover-trigger-C0a8uwwS.js";const Vt=c=>{var n;return ht(c)&&!!((n=c.getAttribute("role"))!=null&&n.startsWith("option"))},Nt=c=>{const{closeOnSelect:n,fieldRef:a,focusedIndex:d,omitSelectedValues:i,placeholder:l,placeholderInOptions:r,setFocusedIndex:m,value:P,optionProps:C,onChange:_,onClose:O,onFocusNext:k}=U(),p=s.useId(),F=s.useRef(null);let{id:w,children:S,closeOnSelect:N,icon:x,isDisabled:h,isFocusable:D,value:I,...g}={...C,...c};const re=!!h&&!D,{descendants:J,index:H,register:te}=Tt({disabled:re}),ue=J.values().slice(0,H),de=!!l&&r,ye=de&&H===0,W=Q(P),z=W?!1:ue.some(({node:A})=>A.dataset.value===(I??"")),X=!z&&(W?P.includes(I??""):(I??"")===P),R=H===d;w??(w=p),!ye&&Ve(I)&&(mt(S)||xt(S)?I=S.toString():console.warn(`${W?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),de&&H>0&&!I&&console.warn(`${W?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const Oe=s.useCallback(A=>{if(A.preventDefault(),A.stopPropagation(),h||!Vt(A.currentTarget)){a.current&&a.current.focus();return}z||m(H),_(I??""),a.current&&a.current.focus(),(N??n)&&O(),i&&k()},[h,z,m,H,_,I,a,N,n,O,i,k]),L=s.useCallback((A={},pe=null)=>{const f={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ce(F,pe,te),role:"option",...g,...A,id:w,style:i&&X?f:void 0,"aria-disabled":Qe(h),"aria-selected":X,"data-disabled":ae(h),"data-duplicated":ae(z),"data-focus":ae(R),"data-value":I??"",tabIndex:-1,onClick:le(g.onClick,A.onClick,Oe)}},[w,I,g,h,R,z,X,i,Oe,te]);return{children:S,customIcon:x,isFocused:R,isSelected:X,getOptionProps:L}},_e=ie(({className:c,icon:n,...a},d)=>{const{styles:i}=U(),{children:l,customIcon:r,isSelected:m,getOptionProps:P}=Nt(a);n??(n=r);const C={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...i.item};return b.jsxs(M.div,{className:ee("ui-select__item",c),__css:C,...P({},d),children:[n!==null?b.jsx(Ne,{opacity:m?1:0,children:n||b.jsx(Rt,{})}):null,b.jsx(M.span,{style:{flex:1},"data-label":!0,children:l})]})});_e.displayName="Option";_e.__ui__="Option";const Ne=ie(({className:c,...n},a)=>{const{styles:d}=U(),i={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...d.itemIcon};return b.jsx(M.span,{ref:a,className:ee("ui-select__item__icon",c),__css:i,...n})});Ne.displayName="OptionIcon";Ne.__ui__="OptionIcon";const Rt=()=>b.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:b.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Lt=({label:c,...n})=>{const{omitSelectedValues:a,value:d}=U(),i=nt(),l=s.useRef(null),r=s.useId(),m=i.values(),_=(Q(d)&&a?i.values(({node:x})=>d.includes(x.dataset.value??"")):[]).map(({index:x})=>x),k=!m.filter(({index:x,node:h})=>{var D;return((D=h.parentElement)==null?void 0:D.dataset.label)===c&&!_.includes(x)}).length,[p,F]=et(n,tt),w=s.useCallback((x={},h=null)=>{var I;const D={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:h,"aria-labelledby":(I=l.current)==null?void 0:I.id,role:"group",...x,...p,style:k?D:void 0}},[p,k]),S=s.useCallback(({id:x,...h}={},D=null)=>({id:x??r,ref:ce(D,l),role:"presentation",...h}),[r]),N=s.useCallback((x={},h=null)=>({ref:h,...x,...F,"data-label":c}),[F,c]);return{label:c,getContainerProps:w,getGroupProps:N,getLabelProps:S}},Re=ie(({className:c,children:n,color:a,h:d,height:i,minH:l,minHeight:r,labelProps:m,...P},C)=>{const{styles:_}=U(),{label:O,getContainerProps:k,getGroupProps:p,getLabelProps:F}=Lt(P);return d??(d=i),l??(l=r),b.jsxs(M.section,{className:ee("ui-select__item","ui-select__item--group",c),__css:{color:a,h:"fit-content",w:"100%"},...k(),children:[b.jsx(M.header,{className:"ui-select__item__group-label",lineClamp:1,__css:_.groupLabel,...F(m),children:O}),b.jsx(M.div,{...p({},C),className:"ui-select__item__group",__css:{h:d,minH:l,..._.group},children:n})]})});Re.displayName="OptionGroup";Re.__ui__="OptionGroup";const{DescendantsContextProvider:Qt,useDescendant:Tt,useDescendants:At,useDescendantsContext:nt}=kt(),[es,U]=bt({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),ts=c=>{var Xe,Ze;const{animation:n,boundary:a,children:d,closeDelay:i,closeOnBlur:l=!0,closeOnEsc:r=!0,closeOnSelect:m=!0,defaultIsOpen:P,defaultValue:C,duration:_=.2,eventListeners:O,flip:k,gutter:p,isLazy:F,isOpen:w,items:S=[],lazyBehavior:N,matchWidth:x=!0,maxSelectValues:h,modifiers:D,offset:I,omitSelectedValues:g=!1,openDelay:re,placeholder:J,placeholderInOptions:H=!0,placement:te="bottom-start",preventOverflow:Se,strategy:ue,value:de,optionProps:ye,onChange:W,onClose:z,onOpen:X,...R}=Dt(c),{"aria-readonly":Oe,...L}=Ct(R,Et),[A,pe]=et(vt(R,["aria-readonly"]),tt),f=At(),[G,y]=s.useState(-1),[Te,Ae]=s.useState(!1),fe=s.useRef(null),Be=s.useRef(null),Me=s.useRef(null),q=s.useRef(new Set([])),[E,me]=Pt({defaultValue:C,value:de,onChange:W}),[Z,Ie]=s.useState(void 0),xe=!!J&&H,se=G>-1,v=Q(E),He=(v?!E.length:!E)&&!xe,K=f.values(({node:e})=>v&&E.includes(e.dataset.value??"")).map(({index:e})=>e),B=f.enabledValues(({index:e})=>!K.includes(e)),Ge=(Xe=f.value(G))==null?void 0:Xe.node.id,Ke=(Ze=Me.current)==null?void 0:Ze.id,he=st(d),Ue=s.useMemo(()=>!he.length&&S.length?S.map((e,t)=>{if("value"in e){const{label:o,value:j,...Y}=e;return b.jsx(_e,{value:j,...Y,children:o},t)}else if("items"in e){const{items:o=[],label:j,...Y}=e;return b.jsx(Re,{label:j,...Y,children:o.map(({label:Ee,value:ve,...Fe},oe)=>b.jsx(_e,{value:ve,...Fe,children:Ee},oe))},t)}}).filter(Boolean):he,[he,S]),Pe=!he.length&&!Ue.length&&(v?!0:!xe),be=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledFirstValue();if(t)if(!v||!g)y(t.index);else if(K.includes(t.index)){const o=B[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[f,B,v,g,K]),Ce=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledLastValue();if(t)if(!v||!g)y(t.index);else if(K.includes(t.index)){const o=B.reverse()[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[f,B,v,g,K]),ke=s.useCallback(()=>{const e=setTimeout(()=>{const o=f.enabledValues().find(({node:j})=>v?E.includes(j.dataset.value??""):j.dataset.value===E);o&&y(o.index)});q.current.add(e)},[f,v,E]),ne=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledNextValue(G);if(t)if(!v||!g)y(t.index);else if(K.includes(t.index)){const o=B.find(({index:j})=>t.index<j)??B[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[f,B,G,v,g,K,y]),je=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledPrevValue(G);if(t)if(!v||!g)y(t.index);else if(K.includes(t.index)){const o=B.reverse().find(({index:j})=>j<t.index)??B[0];y((o==null?void 0:o.index)??-1)}else y(t.index)});q.current.add(e)},[f,B,G,v,g,K,y]),$=He||g?be:ke,$e=He||g?Ce:ke,at=s.useCallback(e=>{const t=f.values();if(!t.length)return;const j=(Q(e)?e:[e]).map(Y=>{const{index:Ee,node:ve}=t.find(({node:oe})=>oe.dataset.value===Y)??{};if(!ve||xe&&Ee===0)return;const{innerHTML:Fe}=Array.from(ve.children).find(oe=>oe.getAttribute("data-label")!==null)??{};return Fe}).filter(Y=>!Ve(Y));Ie(v?j:j[0])},[f,v,xe]),we=s.useCallback(e=>{me(t=>Q(t)?t.includes(e)?t.filter(j=>j!==e):[...t,e]:e)},[me]),ct=s.useCallback(e=>{e.stopPropagation(),me([]),Ie(void 0)},[Ie,me]),{isOpen:u,onClose:V,onOpen:ze}=jt({defaultIsOpen:P,isOpen:w,onClose:z,onOpen:X}),T=s.useCallback(()=>{L.disabled||L.readOnly||Pe||Te||ze()},[L,Pe,Te,ze]),De=s.useCallback(()=>{let e=f.value(G);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";we(t),m&&V(),g&&ne()},[m,f,G,g,we,V,ne]),qe=s.useCallback(()=>{u||(T(),$())},[u,$,T]),Ye=s.useCallback(()=>{u||(T(),$())},[u,$,T]),Je=s.useCallback(e=>{const t=gt(e);_t(fe.current,t)||l&&u&&V()},[l,u,V]),We=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),L.disabled||L.readOnly)return;const o={ArrowDown:se?()=>ne():u?void 0:ge(T,$),ArrowUp:e.altKey&&u?V:se?()=>je():u?void 0:ge(T,$e),End:u?Ce:void 0,Enter:se?De:u?void 0:ge(T,$),Escape:r?V:void 0,Home:u?be:void 0,Space:se?De:u?void 0:ge(T,$)}[e.key];o&&(e.preventDefault(),e.stopPropagation(),o())},[L.disabled,L.readOnly,se,u,T,$,$e,De,be,Ce,r,V,ne,je]);wt({ref:fe,enabled:u&&l,handler:V}),s.useEffect(()=>{if(!v||!g&&Ve(h))return;const e=E.length>0&&E.length===f.count(),t=E.length===h;e||t?(V(),Ae(!0)):Ae(!1)},[g,E,f,v,V,h]),St(()=>{at(E)},[E]),yt(()=>{u||y(-1)},[u]),Ot(()=>{q.current.forEach(e=>clearTimeout(e)),q.current.clear()});const it=s.useCallback(e=>({animation:n,boundary:a,closeDelay:i,closeOnBlur:l,duration:_,eventListeners:O,flip:k,gutter:p,isLazy:F,lazyBehavior:N,matchWidth:x,modifiers:D,offset:I,openDelay:re,placement:te,preventOverflow:Se,strategy:ue,...e,closeOnButton:!1,isOpen:u,trigger:"never",onClose:V,onOpen:T}),[l,re,i,F,N,n,_,I,p,Se,k,x,a,O,ue,te,D,u,T,V]),rt=s.useCallback((e={},t=null)=>({ref:ce(fe,t),...A,...e,...L,onBlur:le(e.onBlur,R.onBlur,Je),onClick:le(e.onClick,R.onClick,qe)}),[A,L,Je,qe,R]),ut=s.useCallback(({"aria-label":e,...t}={},o=null)=>(e??(e=J??`Select ${v?"one or more options.":"an option."}`),{ref:ce(Be,o),"aria-activedescendant":Ge,"aria-controls":Ke,"aria-expanded":u,"aria-haspopup":"listbox","aria-label":e,role:"combobox",tabIndex:0,...pe,...t,"data-active":ae(u),"data-placeholder":ae(v?!(Z!=null&&Z.length):Z===void 0),onFocus:le(t.onFocus,R.onFocus,Ye),onKeyDown:le(t.onKeyDown,R.onKeyDown,We)}),[Ge,Ke,pe,u,v,Z,J,R,Ye,We]);return{children:Ue,closeOnSelect:m,containerRef:fe,descendants:f,fieldRef:Be,focusedIndex:G,isEmpty:Pe,isOpen:u,label:Z,listRef:Me,omitSelectedValues:g,placeholder:J,placeholderInOptions:H,setFocusedIndex:y,value:E,formControlProps:L,getContainerProps:rt,getFieldProps:ut,getPopoverProps:it,optionProps:ye,onChange:we,onClear:ct,onClose:V,onFocusFirst:be,onFocusLast:Ce,onFocusNext:ne,onFocusPrev:je,onFocusSelected:ke,onOpen:T}},Le=ie(({className:c,children:n,__css:a,...d},i)=>{const{styles:l}=U(),r={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...l.icon,...a},P=st(n).map(C=>s.cloneElement(C,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return b.jsx(M.div,{ref:i,className:ee("ui-select__icon",c),__css:r,...d,children:It(n)?P:b.jsx(pt,{})})});Le.displayName="SelectIcon";Le.__ui__="SelectIcon";const ot=({className:c,children:n,...a})=>{const d=s.useRef(null),{styles:i}=U(),l=a.disabled,r=dt({ref:d,isDisabled:l,...a});return b.jsx(Le,{className:ee("ui-select__clear-icon",c),"aria-label":"Clear value",__css:i.clearIcon,...r,children:n??b.jsx(ft,{h:"0.5em",w:"0.5em"})})};ot.displayName="SelectClearIcon";ot.__ui__="SelectClearIcon";const Bt=()=>{const{focusedIndex:c,listRef:n,value:a}=U(),d=nt(),i=s.useId(),l=s.useRef(-1),r=d.value(c),m=Q(a);return s.useEffect(()=>{if(!n.current||!r||l.current===r.index)return;const C=n.current,_=r.node,O=C.clientHeight,k=C.scrollTop,p=k+O,F=_.clientHeight,w=_.offsetTop,S=w+F,N=k<=w&&S<=p,x=l.current<r.index;N||(S<=O?n.current.scrollTo({top:0}):x?n.current.scrollTo({top:S-O}):n.current.scrollTo({top:w+1})),l.current=r.index},[n,r]),{getListProps:s.useCallback(({id:C,..._}={},O=null)=>({id:C??i,ref:ce(n,O),"aria-multiselectable":Qe(m),position:"relative",role:"listbox",tabIndex:-1,..._}),[i,m,n])}},lt=ie(({className:c,children:n,footer:a,header:d,maxW:i,maxWidth:l,minW:r,minWidth:m,w:P,width:C,contentProps:_,...O},k)=>{var w,S,N,x,h,D;const{styles:p}=U(),{getListProps:F}=Bt();return C??(C=P),C??(C=((w=p.list)==null?void 0:w.width)??((S=p.list)==null?void 0:S.w)),m??(m=r),m??(m=((N=p.list)==null?void 0:N.minWidth)??((x=p.list)==null?void 0:x.minW)),l??(l=i),l??(l=((h=p.list)==null?void 0:h.maxWidth)??((D=p.list)==null?void 0:D.maxW)),b.jsxs(Ft,{className:"ui-select__content",maxWidth:l,minWidth:m,width:C,__css:{...p.content,maxWidth:l,minWidth:m,width:C},..._,children:[d?b.jsx(M.header,{className:"ui-select__header",__css:{...p.header},children:d}):null,b.jsx(M.div,{className:ee("ui-select__list",c),__css:{...p.list},...F(O,k),children:n}),a?b.jsx(M.footer,{className:"ui-select__footer",__css:{...p.footer},children:a}):null]})});lt.displayName="SelectList";lt.__ui__="SelectList";export{_e as O,Qt as S,es as a,Le as b,lt as c,U as d,Re as e,ot as f,ts as u};
