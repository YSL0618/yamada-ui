import{j as x}from"./extends-CwFRzn3r.js";import{u as at}from"./index-BD-dMYlD.js";import{r as s}from"./index-BwDkhjyp.js";import{c as it,a as rt}from"./icon-CVPWgGuL.js";import{f as ae}from"./forward-ref-BWI-Phbn.js";import{C as Ve,a3 as ut,g as dt,a as ge,w as Ee,d as ce,h as le,ap as pt,I as J,b as B,c as Q,X as Xe,a8 as Ze,p as ft,Y as mt,a1 as xt,q as Je,al as ht,Z as vt,u as Ct,f as bt,W as _t,_ as _e,j as gt}from"./factory-DBrfn43w.js";import{u as St}from"./index-CsH8woeS.js";import{c as yt}from"./index-ByFQ-olM.js";import{u as Ot}from"./index-Dbjktjet.js";import{u as It}from"./index-VpCG-oEN.js";import{u as Pt,f as kt}from"./form-control-DALmJTHd.js";import{b as jt}from"./popover-trigger-C4B9Wa4t.js";const wt=a=>{var n;return pt(a)&&!!((n=a.getAttribute("role"))!=null&&n.startsWith("option"))},Dt=a=>{const{closeOnSelect:n,fieldRef:c,focusedIndex:d,omitSelectedValues:i,placeholder:o,placeholderInOptions:_,setFocusedIndex:h,value:P,optionProps:v,onChange:C,onClose:g,onFocusNext:k}=K();let{children:r,closeOnSelect:E,icon:f,isDisabled:u,isFocusable:j,value:S,...N}={...v,...a};const z=!!u&&!j,ie=s.useRef(null),{descendants:O,index:M,register:$}=Et({disabled:z}),re=O.values().slice(0,M),ee=!!o&&_,ue=ee&&M===0,q=J(P);!ue&&Ve(S)&&(ut(r)||dt(r)?S=r.toString():console.warn(`${q?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),ee&&M>0&&!S&&console.warn(`${q?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const W=q?!1:re.some(({node:H})=>H.dataset.value===(S??"")),X=!W&&(q?P.includes(S??""):(S??"")===P),te=M===d,de=s.useCallback(H=>{if(H.preventDefault(),H.stopPropagation(),u||!wt(H.currentTarget)){c.current&&c.current.focus();return}W||h(M),C(S??""),c.current&&c.current.focus(),(E??n)&&g(),i&&k()},[u,W,h,M,C,S,c,E,n,g,i,k]),T=s.useCallback((H={},D=null)=>{const pe={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ge(ie,D,$),role:"option",...N,...H,style:i&&X?pe:void 0,"aria-checked":Ee(X),"aria-disabled":Ee(u),"data-disabled":ce(u),"data-duplicated":ce(W),"data-focus":ce(te),"data-value":S??"",tabIndex:-1,onClick:le(N.onClick,H.onClick,de)}},[S,N,u,te,W,X,i,de,$]);return{children:r,customIcon:f,isFocused:te,isSelected:X,getOptionProps:T}},Se=ae(({id:a,className:n,icon:c,...d},i)=>{const{styles:o}=K(),{children:_,customIcon:h,isSelected:P,getOptionProps:v}=Dt(d),C=s.useId();a??(a=C),c??(c=h);const g={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...o.item};return x.jsxs(B.li,{id:a,className:Q("ui-select__item",n),__css:g,...v({},i),children:[c!==null?x.jsx(Ne,{opacity:P?1:0,children:c||x.jsx(Ft,{})}):null,x.jsx(B.span,{style:{flex:1},"data-label":!0,children:_})]})});Se.displayName="Option";Se.__ui__="Option";const Ne=ae(({className:a,...n},c)=>{const{styles:d}=K(),i={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...d.itemIcon};return x.jsx(B.span,{ref:c,className:Q("ui-select__item__icon",a),__css:i,...n})});Ne.displayName="OptionIcon";Ne.__ui__="OptionIcon";const Ft=()=>x.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:x.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Vt=({label:a,...n})=>{const{omitSelectedValues:c,value:d}=K(),i=J(d),o=Qe(),_=o.values(),P=(i&&c?o.values(({node:f})=>d.includes(f.dataset.value??"")):[]).map(({index:f})=>f),C=!_.filter(({index:f,node:u})=>{var j;return((j=u.parentElement)==null?void 0:j.dataset.label)===a&&!P.includes(f)}).length,[g,k]=Xe(n,Ze),r=s.useCallback((f={},u=null)=>({ref:u,...f,...g,style:C?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0}),[g,C]),E=s.useCallback(({"aria-label":f,...u}={},j=null)=>(f??(f=a),{ref:j,"aria-label":f,role:"group",...u,...k,"data-label":a}),[k,a]);return{label:a,getContainerProps:r,getGroupProps:E}},Te=ae(({className:a,children:n,color:c,h:d,height:i,minH:o,minHeight:_,labelProps:h,...P},v)=>{const{styles:C}=K(),{label:g,getContainerProps:k,getGroupProps:r}=Vt(P);return d??(d=i),o??(o=_),x.jsxs(B.li,{className:Q("ui-select__item","ui-select__item--group",a),__css:{color:c,h:"fit-content",w:"100%"},...k(),children:[x.jsx(B.span,{className:"ui-select__item__group-label",lineClamp:1,__css:C.groupLabel,...h,children:g}),x.jsx(B.ul,{...r({},v),className:"ui-select__item__group",__css:{h:d,minH:o,...C.group},children:n})]})});Te.displayName="OptionGroup";Te.__ui__="OptionGroup";const{DescendantsContextProvider:qt,useDescendant:Et,useDescendants:Nt,useDescendantsContext:Qe}=yt(),[Xt,K]=ft({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),Zt=a=>{const{animation:n,boundary:c,children:d,closeDelay:i,closeOnBlur:o=!0,closeOnEsc:_=!0,closeOnSelect:h=!0,defaultIsOpen:P,defaultValue:v,duration:C=.2,eventListeners:g,flip:k,gutter:r,isLazy:E,isOpen:f,items:u=[],lazyBehavior:j,matchWidth:S=!0,maxSelectValues:N,modifiers:z,offset:ie,omitSelectedValues:O=!1,openDelay:M,placeholder:$,placeholderInOptions:ye=!0,placement:re="bottom-start",preventOverflow:ee,strategy:ue,value:q,optionProps:W,onChange:X,onClose:te,onOpen:de,...T}=Pt(a),{"aria-readonly":H,...D}=mt(T,kt),[pe,Le]=Xe(xt(T,["aria-readonly"]),Ze),m=Nt(),[R,I]=s.useState(-1),[Ae,Be]=s.useState(!1),fe=s.useRef(null),Me=s.useRef(null),He=s.useRef(null),Y=s.useRef(new Set([])),[w,me]=St({defaultValue:v,value:q,onChange:X}),[Z,Oe]=s.useState(void 0),xe=!!$&&ye,se=R>-1,b=J(w),Ge=(b?!w.length:!w)&&!xe,G=m.values(({node:e})=>b&&w.includes(e.dataset.value??"")).map(({index:e})=>e),L=m.enabledValues(({index:e})=>!G.includes(e)),he=Je(d),Ke=s.useMemo(()=>!he.length&&u.length?u.map((e,t)=>{if("value"in e){const{label:l,value:y,...A}=e;return x.jsx(Se,{value:y,...A,children:l},t)}else if("items"in e){const{items:l=[],label:y,...A}=e;return x.jsx(Te,{label:y,...A,children:l.map(({label:De,value:be,...Fe},oe)=>x.jsx(Se,{value:be,...Fe,children:De},oe))},t)}}).filter(Boolean):he,[he,u]),Ie=!he.length&&!Ke.length&&(b?!0:!xe),ve=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledFirstValue();if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=L[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,L,b,O,G]),Ce=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledLastValue();if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=L.reverse()[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,L,b,O,G]),Pe=s.useCallback(()=>{const e=setTimeout(()=>{const l=m.enabledValues().find(({node:y})=>b?w.includes(y.dataset.value??""):y.dataset.value===w);l&&I(l.index)});Y.current.add(e)},[m,b,w]),ne=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledNextValue(R);if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=L.find(({index:y})=>t.index<y)??L[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,L,R,b,O,G,I]),ke=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledPrevValue(R);if(t)if(!b||!O)I(t.index);else if(G.includes(t.index)){const l=L.reverse().find(({index:y})=>y<t.index)??L[0];I((l==null?void 0:l.index)??-1)}else I(t.index)});Y.current.add(e)},[m,L,R,b,O,G,I]),U=Ge||O?ve:Pe,Ue=Ge||O?Ce:Pe,st=s.useCallback(e=>{const t=m.values();if(!t.length)return;const y=(J(e)?e:[e]).map(A=>{const{index:De,node:be}=t.find(({node:oe})=>oe.dataset.value===A)??{};if(!be||xe&&De===0)return;const{innerHTML:Fe}=Array.from(be.children).find(oe=>oe.getAttribute("data-label")!==null)??{};return Fe}).filter(A=>!Ve(A));Oe(b?y:y[0])},[m,b,xe]),je=s.useCallback(e=>{me(t=>J(t)?t.includes(e)?t.filter(y=>y!==e):[...t,e]:e)},[me]),nt=s.useCallback(e=>{e.stopPropagation(),me([]),Oe(void 0)},[Oe,me]),{isOpen:p,onClose:F,onOpen:ze}=Ot({defaultIsOpen:P,isOpen:f,onClose:te,onOpen:de}),V=s.useCallback(()=>{D.disabled||D.readOnly||Ie||Ae||ze()},[D,Ie,Ae,ze]),we=s.useCallback(()=>{let e=m.value(R);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";je(t),h&&F(),O&&ne()},[h,m,R,O,je,F,ne]),$e=s.useCallback(()=>{p||(V(),U())},[p,U,V]),We=s.useCallback(()=>{p||(V(),U())},[p,U,V]),Ye=s.useCallback(e=>{const t=ht(e);vt(fe.current,t)||o&&p&&F()},[o,p,F]),qe=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),D.disabled||D.readOnly)return;const l={ArrowDown:se?()=>ne():p?void 0:_e(V,U),ArrowUp:se?()=>ke():p?void 0:_e(V,Ue),End:p?Ce:void 0,Enter:se?we:p?void 0:_e(V,U),Escape:_?F:void 0,Home:p?ve:void 0,Space:se?we:p?void 0:_e(V,U)}[e.key];l&&(e.preventDefault(),e.stopPropagation(),l())},[D.disabled,D.readOnly,se,p,V,U,Ue,we,ve,Ce,_,F,ne,ke]);It({ref:fe,enabled:p&&o,handler:F}),s.useEffect(()=>{if(!b||!O&&Ve(N))return;const e=w.length>0&&w.length===m.count(),t=w.length===N;e||t?(F(),Be(!0)):Be(!1)},[O,w,m,b,F,N]),Ct(()=>{st(w)},[w]),bt(()=>{p||I(-1)},[p]),_t(()=>{Y.current.forEach(e=>clearTimeout(e)),Y.current.clear()});const ot=s.useCallback(e=>({animation:n,boundary:c,closeDelay:i,closeOnBlur:o,duration:C,eventListeners:g,flip:k,gutter:r,isLazy:E,lazyBehavior:j,matchWidth:S,modifiers:z,offset:ie,openDelay:M,placement:re,preventOverflow:ee,strategy:ue,...e,closeOnButton:!1,isOpen:p,trigger:"never",onClose:F,onOpen:V}),[o,M,i,E,j,n,C,ie,r,ee,k,S,c,g,ue,re,z,p,V,F]),lt=s.useCallback((e={},t=null)=>({ref:ge(fe,t),...pe,...e,...D,onBlur:le(e.onBlur,T.onBlur,Ye),onClick:le(e.onClick,T.onClick,$e)}),[pe,D,Ye,$e,T]),ct=s.useCallback(({"aria-label":e,...t}={},l=null)=>{var y,A;return e??(e=$??`Select ${b?"one or more options.":"an option."}`),{ref:ge(Me,l),"aria-label":e,role:"combobox",tabIndex:0,...Le,...t,"aria-activedescendant":(y=m.value(R))==null?void 0:y.node.id,"aria-controls":(A=He.current)==null?void 0:A.id,"aria-expanded":p,"data-active":ce(p),"data-placeholder":ce(b?!(Z!=null&&Z.length):Z===void 0),onFocus:le(t.onFocus,T.onFocus,We),onKeyDown:le(t.onKeyDown,T.onKeyDown,qe)}},[m,Le,R,p,b,Z,$,T,We,qe]);return{children:Ke,closeOnSelect:h,containerRef:fe,descendants:m,fieldRef:Me,focusedIndex:R,isEmpty:Ie,isOpen:p,label:Z,listRef:He,omitSelectedValues:O,placeholder:$,placeholderInOptions:ye,setFocusedIndex:I,value:w,formControlProps:D,getContainerProps:lt,getFieldProps:ct,getPopoverProps:ot,optionProps:W,onChange:je,onClear:nt,onClose:F,onFocusFirst:ve,onFocusLast:Ce,onFocusNext:ne,onFocusPrev:ke,onFocusSelected:Pe,onOpen:V}},Re=ae(({className:a,children:n,__css:c,...d},i)=>{const{styles:o}=K(),_={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...o.icon,...c},P=Je(n).map(v=>s.cloneElement(v,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return x.jsx(B.div,{ref:i,className:Q("ui-select__icon",a),__css:_,...d,children:gt(n)?P:x.jsx(it,{})})});Re.displayName="SelectIcon";Re.__ui__="SelectIcon";const et=({className:a,children:n,...c})=>{const d=s.useRef(null),{styles:i}=K(),o=c.disabled,_=at({ref:d,isDisabled:o,...c});return x.jsx(Re,{className:Q("ui-select__clear-icon",a),"aria-label":"Clear value",__css:i.clearIcon,..._,children:n??x.jsx(rt,{h:"0.5em",w:"0.5em"})})};et.displayName="SelectClearIcon";et.__ui__="SelectClearIcon";const Tt=()=>{const{focusedIndex:a,listRef:n,value:c}=K(),d=Qe(),i=s.useRef(-1),o=d.value(a),_=J(c);s.useEffect(()=>{if(!n.current||!o||i.current===o.index)return;const v=n.current,C=o.node,g=v.clientHeight,k=v.scrollTop,r=k+g,E=C.clientHeight,f=C.offsetTop,u=f+E,j=k<=f&&u<=r,S=i.current<o.index;j||(u<=g?n.current.scrollTo({top:0}):S?n.current.scrollTo({top:u-g}):n.current.scrollTo({top:f+1})),i.current=o.index},[n,o]);const h=s.useId();return{getListProps:s.useCallback((v={},C=null)=>({id:h,ref:ge(n,C),"aria-multiselectable":Ee(_),position:"relative",role:"listbox",tabIndex:-1,...v}),[h,_,n])}},tt=ae(({className:a,children:n,footer:c,header:d,maxW:i,maxWidth:o,minW:_,minWidth:h,w:P,width:v,contentProps:C,...g},k)=>{var f,u,j,S,N,z;const{styles:r}=K(),{getListProps:E}=Tt();return v??(v=P),v??(v=((f=r.list)==null?void 0:f.width)??((u=r.list)==null?void 0:u.w)),h??(h=_),h??(h=((j=r.list)==null?void 0:j.minWidth)??((S=r.list)==null?void 0:S.minW)),o??(o=i),o??(o=((N=r.list)==null?void 0:N.maxWidth)??((z=r.list)==null?void 0:z.maxW)),x.jsxs(jt,{as:"div",className:"ui-select__content",maxWidth:o,minWidth:h,width:v,__css:{...r.content,maxWidth:o,minWidth:h,width:v},...C,children:[d?x.jsx(B.div,{className:"ui-select__header",__css:{...r.header},children:d}):null,x.jsx(B.ul,{className:Q("ui-select__list",a),__css:{...r.list},...E(g,k),children:n}),c?x.jsx(B.div,{className:"ui-select__footer",__css:{...r.footer},children:c}):null]})});tt.displayName="SelectList";tt.__ui__="SelectList";export{Se as O,qt as S,Xt as a,Re as b,tt as c,K as d,Te as e,et as f,Zt as u};
