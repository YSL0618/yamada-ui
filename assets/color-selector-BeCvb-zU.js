import{j as t}from"./jsx-runtime-CfatFE5O.js";import{u as Ne}from"./index-D-iNr3rb.js";import{r as h}from"./index-ClcD9ViR.js";import{u as De,A as Re,L as Me,q as Ce,a0 as oe,n as se,h as w,c as H,b as N,r as Te,I as Ve}from"./factory-Bqmz9C5P.js";import{u as Ae,f as He}from"./form-control-DNngTyAT.js";import{f as Oe,c as re,h as Q,i as Le,r as Be,p as Ie,j as Fe,k as We,o as $e}from"./theme-provider-Dit74geM.js";import{I as qe}from"./icon-button-C4sxXu5I.js";import{b as ze}from"./icon-DeZ7GCXS.js";import{f as O}from"./forward-ref-D13m8o2p.js";import{A as Ge}from"./alpha-slider-CPj1N9Bp.js";import{H as Ue}from"./hue-slider-DK1z7-ON.js";import{C as _e}from"./color-swatch-B9N8sbJH.js";import{I as Ze}from"./input-tE2ddQAG.js";import{S as Je}from"./saturation-slider-Bn0-T-C7.js";import{a as Ke}from"./use-component-style-D7fUVUlo.js";const Qe=()=>{const[s,n]=h.useState(!1);De(()=>{n(typeof window<"u"&&"EyeDropper"in window)},[]);const c=h.useCallback(async(l={})=>s?new window.EyeDropper().open(l):Promise.resolve(void 0),[s]);return{supported:s,onOpen:c}},me=(s,n)=>{let[c,l,i,o]=Ie(s,n)??[0,0,1,1];return o>1&&(o=1),{a:o,h:c,l:i,s:l}},fe=(s,n)=>{let[c,l,i,o]=Fe(s,n)??[255,255,255,1];return c>255&&(c=255),l>255&&(l=255),i>255&&(i=255),o>1&&(o=1),{a:o,b:i,g:l,r:c}},ae=(s,n)=>{const[c,l,i,o]=We(s,n);return{a:o,h:c,s:l,v:i}},[Xe,W]=Re({name:"ColorSelectorContext",errorMessage:`useColorSelectorContext returned is 'undefined'. Seems you forgot to wrap the components in "<ColorSelector />"`}),Ye=({isInvalid:s,...n})=>{const{id:c,name:l,defaultValue:i,fallbackValue:o,format:m,value:u,onChange:f,onChangeEnd:_,onChangeStart:E,onSwatchClick:y,...S}=Ae({isInvalid:s,...n}),[{"aria-readonly":D,disabled:d,readOnly:g,required:x,...L},z]=Me(S,He),G=Ce(E),U=Ce(_),{supported:X,onOpen:Z}=Qe(),[T,J]=Ne({defaultValue:i??o,value:u,onChange:f}),C=h.useMemo(()=>m??Oe(T||"#ffffff"),[T,m]),b=re(T,"#ffffff")(C),$=h.useRef(void 0),B=h.useRef(!1),[V,q]=h.useState(ae(b,o)),{a:A,h:k,s:R,v:I}=V,K=C.endsWith("a"),ge=!(d||g),ye=h.useMemo(()=>{if(b.startsWith("hsl")){const{a:e,h:a,l:r,s:p}=me(b,o),P=[{label:"H",max:360,min:0,space:"h",value:Math.round(a)},{label:"S(%)",max:100,min:0,space:"s",value:Math.round(p*100)},{label:"L(%)",max:100,min:0,space:"l",value:Math.round(r*100)}];return K&&P.push({label:"A(%)",max:100,min:0,space:"a",value:Math.round(e*100)}),P}else{const{a:e,b:a,g:r,r:p}=fe(b,o),P=[{label:"R",max:255,min:0,space:"r",value:Math.round(p)},{label:"G",max:255,min:0,space:"g",value:Math.round(r)},{label:"B",max:255,min:0,space:"b",value:Math.round(a)}];return K&&P.push({label:"A(%)",max:100,min:0,space:"a",value:Math.round(e*100)}),P}},[b,K,o]),v=h.useCallback(e=>{oe(e)?q(ae(e,o)):q(a=>({...a,...e}))},[o]),F=h.useCallback(e=>{window.clearTimeout($.current),B.current=!0;const{a,h:r,s:p,v:P}={...V,...e},M=Q([r,p,P,a],o)(C);M&&G(M)},[G,o,V,C]),j=h.useCallback(e=>{window.clearTimeout($.current),$.current=window.setTimeout(()=>{B.current=!1},200);let a;if(oe(e))a=re(e,o)(C);else{const{a:r,h:p,s:P,v:M}={...V,...e};a=Q([p,P,M,r],o)(C)}a&&U(a)},[U,o,V,C]),he=h.useCallback((e,a)=>{let r=Math.floor(parseFloat(e.target.value));isNaN(r)&&(r=0),["a","l","s"].includes(a)&&(r=r/100);let p;if(b.startsWith("hsl")){const{a:P,h:M,l:Y,s:ee}=Object.assign(me(b,o),{[a]:r});p=Le([M,ee,Y,P],o)(C)}else{const{a:P,b:M,g:Y,r:ee}=Object.assign(fe(b,o),{[a]:r});p=Be([ee,Y,M,P],o)(C)}p&&(v(p),j(p))},[b,v,j,o,C]),de=h.useCallback(async()=>{try{const{sRGBHex:e}=await Z()??{};if(!e)return;v(e),j(e)}catch{}},[Z,v,j]);se(()=>{const e=Q([k,R,I,A],o)(C);e&&J(e)},[k,R,I,A]),se(()=>{B.current||u&&q(ae(u,o))},[u]),se(()=>{if(!T)return;const e=re(T,o)(C);e&&J(e)},[C]);const xe=h.useCallback((e={},a=null)=>({...e,ref:a,...L,...z}),[z,L]),be=h.useCallback((e={},a=null)=>({...L,"aria-readonly":D,...e,id:c,ref:a,type:"hidden",name:l,disabled:d,readOnly:g,required:x,value:b}),[L,D,c,l,b,x,d,g]),ve=h.useCallback((e={},a=null)=>({disabled:d,isInvalid:s,readOnly:g,required:x,...e,ref:a,value:[k,R,I],onChange:w(e.onChange,([,r,p])=>v({s:r,v:p})),onChangeEnd:w(e.onChangeEnd,([,r,p])=>j({s:r,v:p})),onChangeStart:w(e.onChangeStart,([,r,p])=>F({s:r,v:p}))}),[x,d,g,s,k,R,I,v,F,j]),Pe=h.useCallback((e={},a=null)=>({disabled:d,isInvalid:s,readOnly:g,required:x,...e,ref:a,value:k,onChange:w(e.onChange,r=>v({h:r})),onChangeEnd:w(e.onChangeEnd,r=>j({h:r})),onChangeStart:w(e.onChangeStart,r=>F({h:r}))}),[x,d,g,s,k,v,F,j]),je=h.useCallback((e={},a=null)=>({disabled:d,isInvalid:s,readOnly:g,required:x,...e,ref:a,color:Q([k,R,I,A],o)(C),value:A,onChange:w(e.onChange,r=>v({a:r})),onChangeEnd:w(e.onChangeEnd,r=>j({a:r})),onChangeStart:w(e.onChangeStart,r=>F({a:r}))}),[o,x,d,g,s,C,k,R,I,A,v,F,j]),we=h.useCallback(({space:e,...a},r=null)=>({disabled:d,isInvalid:s,readOnly:g,required:x,...a,ref:r,type:"number",step:1,onChange:w(a.onChange,p=>he(p,e))}),[x,d,g,s,he]),Ee=h.useCallback((e={},a=null)=>({"aria-label":"Pick a color",disabled:d,...e,ref:a,onClick:w(e.onClick,de)}),[d,de]),ke=h.useCallback(({color:e,...a}={},r=null)=>({"aria-label":`Select ${e} as the color`,disabled:d,readOnly:g,role:"button",...a,ref:r,color:e,onClick:w(a.onClick,()=>{oe(e)&&(y==null||y(e),v(e),j(e))})}),[d,g,y,v,j]);return{channels:ye,disabled:d,eyeDropperSupported:X,interactive:ge,readOnly:g,value:b,withAlpha:K,getAlphaSliderProps:je,getChannelProps:we,getContainerProps:xe,getEyeDropperProps:Ee,getHueSliderProps:Pe,getInputProps:be,getSaturationSliderProps:ve,getSwatchProps:ke,onChange:v}},le=O(({className:s,...n},c)=>{const{size:l,readOnly:i,styles:o,getEyeDropperProps:m}=W(),u={h:"auto",minW:"auto",pointerEvents:i?"none":void 0,...o.eyeDropper};return t.jsx(qe,{className:H("ui-color-selector__eye-dropper",s),size:l,variant:"outline",__css:u,...m(n,c),children:t.jsx(te,{className:"ui-color-selector__eye-dropper__icon"})})});le.displayName="ColorSelectorEyeDropper";le.__ui__="ColorSelectorEyeDropper";const te=({...s})=>t.jsxs(ze,{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",...s,children:[t.jsx("path",{d:"m2 22 1-1h3l9-9"}),t.jsx("path",{d:"M3 21v-3l9-9"}),t.jsx("path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z"})]});te.displayName="EyeDropperIcon";te.__ui__="EyeDropperIcon";const ne=O(({className:s,alphaSliderRef:n,hueSliderRef:c,alphaSliderProps:l,hueSliderProps:i,...o},m)=>{let{size:u,styles:f,withAlpha:_,getAlphaSliderProps:E,getHueSliderProps:y}=W();u==="full"&&(u="lg");const S={display:"flex",flexDirection:"column",...f.sliders};return t.jsxs(N.div,{ref:m,className:H("ui-color-selector__sliders",s),__css:S,...o,children:[t.jsx(Ue,{className:"ui-color-selector__hue-slider",size:u,__css:{...f.hueSlider},...y(i,c)}),_?t.jsx(Ge,{className:"ui-color-selector__alpha-slider",size:u,__css:{...f.alphaSlider},...E(l,n)}):null]})});ne.displayName="ColorSelectorSliders";ne.__ui__="ColorSelectorSliders";const ce=O(({className:s,alphaSliderRef:n,eyeDropperRef:c,hueSliderRef:l,withEyeDropper:i=!0,withResult:o,alphaSliderProps:m,eyeDropperProps:u,hueSliderProps:f,..._},E)=>{const{eyeDropperSupported:y,styles:S,value:D}=W(),d={display:"flex",w:"100%",...S.body};return t.jsxs(N.div,{ref:E,className:H("ui-color-selector__body",s),__css:d,..._,children:[t.jsx(ne,{alphaSliderRef:n,hueSliderRef:l,alphaSliderProps:m,hueSliderProps:f}),i&&y?t.jsx(le,{ref:c,...u}):null,o?t.jsx(_e,{className:"ui-color-selector__result",color:D,__css:{...S.result}}):null]})});ce.displayName="ColorSelectorBody";ce.__ui__="ColorSelectorBody";const ie=O(({className:s,channelProps:n,...c},l)=>{const{channels:i,styles:o,withAlpha:m,getChannelProps:u}=W(),f={display:"grid",gridTemplateColumns:`repeat(${m?"4":"3"}, 1fr)`,...o.channels};return t.jsx(N.div,{ref:l,className:H("ui-color-selector__channels",s),__css:f,...c,children:i.map(({label:_,max:E,min:y,space:S,value:D})=>t.jsx(ue,{channelLabel:_,...u({...n,max:E,min:y,space:S,value:D})},_))})});ie.displayName="ColorSelectorChannels";ie.__ui__="ColorSelectorChannels";const ue=O(({className:s,channelLabel:n,...c},l)=>{const i=h.useId();let{size:o,disabled:m,readOnly:u,styles:f}=W();o==="full"&&(o="lg");const _={...f.channel};return t.jsxs(N.div,{className:H("ui-color-selector__channel",s),children:[n?t.jsx(N.label,{htmlFor:i,style:{cursor:m?"not-allowed":void 0},__css:{display:"block",pointerEvents:u?"none":void 0,...f.channelLabel},children:n}):null,t.jsx(Ze,{id:i,ref:l,size:o,__css:_,...c})]})});ue.displayName="ColorSelectorChannel";ue.__ui__="ColorSelectorChannel";const pe=O(({className:s,swatches:n,swatchesColumns:c,swatchesLabel:l,swatchesContainerProps:i,swatchProps:o,...m},u)=>{const{readOnly:f,styles:_,getSwatchProps:E}=W(),y={display:"grid",gridTemplateColumns:Te(c,S=>S!=null?`repeat(${S}, minmax(0, 1fr))`:void 0),..._.swatches};return n!=null&&n.length?t.jsxs(N.div,{...i,children:[l?t.jsx(N.p,{className:"ui-color-selector__swatches__label",__css:{..._.swatchesLabel},children:l}):null,t.jsx(N.div,{ref:u,className:H("ui-color-selector__swatches",s),__css:y,...m,children:n.map(S=>t.jsx(_e,{as:"button",__css:{boxSize:"100%",pointerEvents:f?"none":void 0,..._.swatch},...E({color:S,...o})},S))})]}):null});pe.displayName="ColorSelectorSwatches";pe.__ui__="ColorSelectorSwatches";const Se=O(({size:s,...n},c)=>{const[l,i]=Ke("ColorSelector",{size:s,...n}),{className:o,alphaSliderRef:m,children:u,eyeDropperRef:f,hueSliderRef:_,saturationSliderRef:E,swatches:y,swatchesColumns:S=7,swatchesLabel:D,withChannel:d=!0,withEyeDropper:g,withPicker:x=!0,withResult:L=!0,alphaSliderProps:z,channelProps:G,channelsProps:U,eyeDropperProps:X,hueSliderProps:Z,inputProps:T,saturationSliderProps:J,swatchesProps:C,swatchProps:b,...$}=$e(i),{value:B,getContainerProps:V,getInputProps:q,getSaturationSliderProps:A,...k}=Ye($),R={display:"flex",flexDirection:"column",...l.container};return t.jsx(Xe,{value:{size:s,styles:l,value:B,...k},children:t.jsxs(N.div,{ref:c,className:H("ui-color-selector",o),__css:R,...V(),children:[t.jsx(N.input,{...q(T,c)}),x?t.jsx(Je,{className:"ui-color-selector__saturation-slider",size:s,__css:{...l.saturationSlider},...A(J,E)}):null,x?t.jsx(ce,{alphaSliderRef:m,eyeDropperRef:f,hueSliderRef:_,withEyeDropper:g,withResult:L,alphaSliderProps:z,eyeDropperProps:X,hueSliderProps:Z}):null,x&&d?t.jsx(ie,{channelProps:G,...U}):null,t.jsx(pe,{swatches:y,swatchesColumns:S,swatchesLabel:D,swatchProps:b,...C}),Ve(u,{value:B})]})})});Se.displayName="ColorSelector";Se.__ui__="ColorSelector";export{Se as C,te as E,Qe as u};
