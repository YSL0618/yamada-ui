import{j as k}from"./extends-CwFRzn3r.js";import{r as n}from"./index-BwDkhjyp.js";import{C as ce}from"./close-button-BDLDbh2v.js";import{f as le}from"./forward-ref-BWI-Phbn.js";import{p as ae,a as H,h as u,B as fe,al as S,Z as x,c as W,q as me,ao as pe,b as de,_ as ve}from"./factory-DBrfn43w.js";import{s as L}from"./slide-fade-DV-SS8EA.js";import{s as ge}from"./scale-fade-CARss9Lv.js";import{m as Pe}from"./forward-ref-scR1bmHx.js";import{m as Ce}from"./factory-CWrzRNZL.js";import{b as ye}from"./index-DX5CNJFl.js";import{u as he,b as be}from"./index-Dbjktjet.js";import{u as xe,a as Be,b as _e}from"./index-Ds_xHjLF.js";import{u as Re}from"./index-pFyedNCb.js";import{a as Te}from"./use-component-style-DhRiPQIp.js";import{o as we}from"./theme-provider-Cr3m0r8P.js";const[Ee,q]=ae({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),$=f=>{const[l,r]=Te("Popover",f),{animation:B="scale",autoFocus:d=!0,children:_,closeDelay:m=200,closeOnBlur:v=!0,closeOnButton:R=!0,closeOnEsc:M=!0,duration:T,initialFocusRef:z,isLazy:I,lazyBehavior:O="unmount",openDelay:D=200,relatedRef:C,restoreFocus:K=!0,trigger:c="click",...A}=we(r),{isOpen:o,onClose:s,onOpen:h,onToggle:j}=he(r),w=n.useRef(null),b=n.useRef(null),p=n.useRef(null),{present:X,onAnimationComplete:a}=ye({ref:p,isOpen:o}),g=n.useRef(void 0),Y=n.useRef(void 0),E=n.useRef(!1),U=n.useRef(!1);o&&(U.current=!0);const{forceUpdate:Z,referenceRef:N,transformOrigin:G,getPopperProps:te}=Re({...A,enabled:o});n.useEffect(()=>()=>{g.current&&clearTimeout(g.current),Y.current&&clearTimeout(Y.current)},[]),xe({ref:b,enabled:o}),Be(p,{focusRef:b,shouldFocus:K&&(c==="click"||c==="contextmenu"),visible:o}),_e(p,{focusRef:z,shouldFocus:d&&(c==="click"||c==="contextmenu"),visible:o});const J=be({enabled:I,isSelected:X,mode:O,wasSelected:U.current}),ne=n.useCallback((e={},F=null)=>{const i={...e,ref:H(p,F),style:{...e.style,transformOrigin:G},children:J?e.children:null,tabIndex:-1,onBlur:u(e.onBlur,t=>{const P=S(t),y=x(p.current,P),ie=x(b.current,P),ue=C!=null&&C.current?x(C.current,P):!1;o&&v&&(!y&&!ie&&!ue)&&s()}),onKeyDown:u(e.onKeyDown,t=>{M&&t.key==="Escape"&&s()})};return c==="hover"&&(i.onMouseEnter=u(e.onMouseEnter,()=>{E.current=!0}),i.onMouseLeave=u(e.onMouseLeave,t=>{t.nativeEvent.relatedTarget!==null&&(E.current=!1,v&&setTimeout(s,m))})),i},[m,v,M,o,s,J,G,c,C]),Q=n.useCallback(e=>{w.current==null&&N(e)},[N]),re=n.useCallback((e={},F=null)=>{const i={...e,ref:H(b,F,Q)};return c==="click"&&(i.onClick=u(e.onClick,j),i.onBlur=u(e.onBlur,t=>{const P=S(t),y=!x(p.current,P);o&&v&&y&&s()})),c==="contextmenu"&&(i.onContextMenu=u(e.onContextMenu,t=>{t.preventDefault(),h()}),i.onBlur=u(e.onBlur,t=>{const P=S(t),y=!x(p.current,P);o&&v&&y&&s()})),c==="hover"&&(i.onFocus=u(e.onFocus,()=>{g.current===void 0&&h()}),i.onBlur=u(e.onBlur,t=>{const P=S(t),y=!x(p.current,P);o&&v&&y&&s()}),i.onKeyDown=u(e.onKeyDown,t=>{t.key==="Escape"&&s()}),i.onMouseEnter=u(e.onMouseEnter,()=>{E.current=!0,g.current=window.setTimeout(h,D)}),i.onMouseLeave=u(e.onMouseLeave,()=>{E.current=!1,g.current&&(clearTimeout(g.current),g.current=void 0),Y.current=window.setTimeout(()=>{E.current||s()},m)})),i},[m,v,o,Q,s,h,j,D,c]),se=n.useCallback((e={},F=null)=>({...e,ref:H(F,w,N)}),[w,N]);return k.jsx(Ee,{value:{animation:B,closeOnButton:R,duration:T,forceUpdate:Z,isOpen:o,styles:l,getAnchorProps:se,getPopoverProps:ne,getPopperProps:te,getTriggerProps:re,onAnimationComplete:a,onClose:s},children:fe(_,{forceUpdate:Z,isOpen:o,onClose:s})})};$.displayName="Popover";$.__ui__="Popover";const V=le(({onClick:f,...l},r)=>{const{styles:B,onClose:d}=q(),_={position:"absolute",...B.closeButton};return k.jsx(ce,{ref:r,className:W("ui-popover__close-button"),size:"sm",onClick:u(f,m=>{m.stopPropagation(),d==null||d()}),__css:_,...l})});V.displayName="PopoverCloseButton";V.__ui__="PopoverCloseButton";const Fe=(f="scale",l)=>{const r={duration:l,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(f){case"scale":return{...ge,custom:{...r,scale:.95}};case"top":return{...L,custom:{...r,offsetX:0,offsetY:-16}};case"right":return{...L,custom:{...r,offsetX:16,offsetY:0}};case"left":return{...L,custom:{...r,offsetX:-16,offsetY:0}};case"bottom":return{...L,custom:{...r,offsetX:0,offsetY:16}}}},ee=Pe(({as:f="section",className:l,children:r,maxW:B,maxWidth:d,minW:_,minWidth:m,w:v,width:R,z:M,zIndex:T,containerProps:z,__css:I,...O},D)=>{const{animation:C,closeOnButton:K,duration:c,isOpen:A,styles:o,getPopoverProps:s,getPopperProps:h,onAnimationComplete:j}=q(),w=me(r),[b,...p]=pe(w,V),X=n.useMemo(()=>Ce(f),[f]),a=I??o.container??{},g={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...a};return R??(R=v),R??(R=a.width??a.w),m??(m=_),m??(m=a.minWidth??a.minW),d??(d=B),d??(d=a.maxWidth??a.maxW),T??(T=M),T??(T=a.zIndex??a.z),k.jsx(de.div,{...h({style:{visibility:A?"visible":"hidden"}}),className:"ui-popover",maxWidth:d,minWidth:m,outline:"none",width:R,zIndex:T,...z,children:k.jsxs(X,{className:W("ui-popover__content",l),...C!=="none"?Fe(C,c):{},...s(O,D),animate:A?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:ve(j,O.onAnimationComplete),__css:g,children:[b??(K?k.jsx(V,{}):null),p]})})});ee.displayName="PopoverContent";ee.__ui__="PopoverContent";const oe=({children:f})=>{const l=n.Children.only(f),{getTriggerProps:r}=q();return n.cloneElement(l,r(l.props,l.ref))};oe.displayName="PopoverTrigger";oe.__ui__="PopoverTrigger";export{$ as P,oe as a,ee as b,V as c,q as u};
