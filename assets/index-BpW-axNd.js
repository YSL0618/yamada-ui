import{r as g}from"./index-BwDkhjyp.js";import{o as _,C as b,u as E,a as S,D as M}from"./factory-BFmlPmGv.js";const v=t=>t.sort((c,d)=>{const r=c.compareDocumentPosition(d);return r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS?1:((r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)&&console.warn("Cannot sort the given nodes."),0)}),V=(t,c,d)=>{let r=t+1;return d&&r>=c&&(r=0),r},m=(t,c,d)=>{let r=t-1;return d&&r<0&&(r=c),r},y=()=>{const t=new Map,c=e=>{t.forEach(n=>{const s=e.indexOf(n.node);n.index=s,n.node.dataset.index=n.index.toString()})},d=(e,n)=>{if(!e||t.has(e))return;const s=Array.from(t.keys()).concat(e),a=v(s);n!=null&&n.disabled&&(n.disabled=!!n.disabled);const N={node:e,index:-1,...n};t.set(e,N),c(a)},r=e=>{if(e!=null)return M(e)?d(e):n=>d(n,e)},u=e=>{t.delete(e);const n=v(Array.from(t.keys()));c(n)},D=()=>t.clear(),o=e=>f(e).length,I=e=>x(e).length,T=e=>{var n;return e?((n=t.get(e))==null?void 0:n.index)??-1:-1},C=(e,n)=>e==null?-1:x(n).findIndex(s=>s.node.isSameNode(e)),f=e=>{const n=Array.from(t.values());return e?n.filter(e).sort((s,a)=>s.index-a.index):n.sort((s,a)=>s.index-a.index)},x=e=>f(e).filter(({disabled:n})=>!n),l=(e,n)=>{if(o(n)!==0)return f(n)[e]},i=(e,n)=>{if(I(n)!==0)return x(n)[e]};return{register:r,unregister:u,destroy:D,count:o,values:f,value:l,indexOf:T,firstValue:e=>l(0,e),lastValue:e=>l(t.size-1,e),prevValue:(e,n,s=!0)=>{const a=m(e,o(n)-1,s);return l(a,n)},nextValue:(e,n,s=!0)=>{const a=V(e,o(n),s);return l(a,n)},enabledCount:I,enabledValues:x,enabledValue:i,enabledIndexOf:C,enabledFirstValue:e=>i(0,e),enabledLastValue:e=>i(x(e).length-1,e),enabledPrevValue:(e,n,s=!0)=>{const a=l(e);if(!a)return;const N=C(a.node,n),O=m(N,I(n)-1,s);return i(O,n)},enabledNextValue:(e,n,s=!0)=>{const a=l(e);if(!a)return;const N=C(a.node,n),O=V(N,I(n),s);return i(O,n)}}},h=()=>{const t=g.useRef(y());return E(()=>()=>t.current.destroy()),t.current},[A,P]=_({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsContextProvider"}),L=t=>{const c=P(),[d,r]=g.useState(-1),u=g.useRef(null);E(()=>()=>{u.current&&c.unregister(u.current)},[]),E(()=>{if(!u.current)return;const o=Number(u.current.dataset.index);d!=o&&!Number.isNaN(o)&&r(o)});const D=t?b(c.register(t)):b(c.register);return{descendants:c,index:d,enabledIndex:c.enabledIndexOf(u.current,t==null?void 0:t.filter),register:S(D,u)}},j=()=>({DescendantsContextProvider:b(A),useDescendantsContext:()=>b(P()),useDescendants:()=>h(),useDescendant:t=>L(t)});export{j as c};
