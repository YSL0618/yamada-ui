import{j as m}from"./extends-CwFRzn3r.js";import{f as ie}from"./forward-ref-BWI-Phbn.js";import{o as Lt,p as bt,b as D,c as q,j as Bt,A as Fe,a1 as Ht,g as zt,a as Me,t as Gt,d as le,h as z,aP as Kt,F as pe,z as gt,f as _e,V as _t,a6 as vt,W as Ut,af as $t,X as Jt,u as Wt,S as Yt,Y as Ve}from"./factory-uBtAHRUq.js";import{r as t}from"./index-BwDkhjyp.js";import{b as Xt}from"./popover-trigger-CiVhXs2R.js";import{u as qt}from"./index-B_fkAghs.js";import{u as Qt}from"./index-CdVvibsY.js";import{u as Zt}from"./index-B1JaSA3I.js";import{c as es}from"./index-DSunIB56.js";import{u as ts}from"./index-CMM3kl6L.js";import{c as ss,a as os}from"./icon-fUKD81HD.js";import{u as ns,f as ls}from"./form-control-k6ikkRb0.js";const{DescendantsContextProvider:js,useDescendant:is,useDescendants:as,useDescendantsContext:Xe}=es(),[Es,N]=Lt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),qe=ie(({className:i,children:s,__css:o,...n},u)=>{const{styles:r}=N(),p={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...r.icon,...o},v=bt(s).map(I=>t.cloneElement(I,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return m.jsx(D.div,{ref:u,className:q("ui-autocomplete__icon",i),__css:p,...n,children:Bt(s)?v:m.jsx(ss,{})})});qe.displayName="AutocompleteIcon";qe.__ui__="AutocompleteIcon";const yt=({className:i,children:s,...o})=>{const n=t.useRef(null),{styles:u}=N(),r=o.disabled,p=ts({ref:n,isDisabled:r,...o});return m.jsx(qe,{className:q("ui-autocomplete__icon--clear",i),"aria-label":"Clear value",__css:u.clearIcon,...p,children:s??m.jsx(os,{h:"0.5em",w:"0.5em"})})};yt.displayName="AutocompleteClearIcon";yt.__ui__="AutocompleteClearIcon";const ve=ie(({className:i,...s},o)=>{const{styles:n}=N(),u={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...n.itemIcon};return m.jsx(D.span,{ref:o,className:q("ui-autocomplete__item__icon",i),__css:u,...s})});ve.displayName="AutocompleteItemIcon";ve.__ui__="AutocompleteItemIcon";const cs=i=>{var s;return Kt(i)&&!!((s=i.getAttribute("role"))!=null&&s.startsWith("option"))},rs=i=>{var ke;const{closeOnSelect:s,focusedIndex:o,inputRef:n,omitSelectedValues:u,setFocusedIndex:r,value:p,optionProps:d,onChange:v,onClose:I,onFocusNext:y}=N(),S=t.useId();let{children:P,closeOnSelect:C,icon:F,isDisabled:g,isFocusable:b,value:A,...V}={...d,...i};const G=!!g&&!b,Q=t.useRef(null),{descendants:B,index:Y,register:me}=is({disabled:G}),Ae=B.values().slice(0,Y),fe=pe(p);Fe(A)&&(Ht(P)||zt(P)?A=P.toString():console.warn(`${fe?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`));const k=Ae.some(({node:K})=>K.dataset.value===(A??"")),Z=!k&&(fe?p.includes(A??""):(A??"")===p),xe="target"in(((ke=Q.current)==null?void 0:ke.dataset)??{}),ae=Y===o,Ce=t.useCallback(K=>{if(K.stopPropagation(),g||!cs(K.currentTarget)){n.current&&n.current.focus();return}k||r(Y),v(A??""),n.current&&n.current.focus(),(C??s)&&I(),u&&y(Y)},[k,y,u,g,A,r,Y,v,C,s,I,n]),Ie=t.useCallback((K={},Te=null)=>{const Le={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{id:S,ref:Me(Q,Te,me),role:"option",...V,...K,style:!xe||u&&Z?Le:void 0,"aria-checked":Z,"aria-disabled":Gt(g),"data-disabled":le(g),"data-duplicated":le(k),"data-focus":le(ae),"data-target":le(!0),"data-value":A??"",tabIndex:-1,onClick:z(V.onClick,K.onClick,Ce)}},[S,k,A,V,g,ae,Z,xe,u,Ce,me]);return{children:P,customIcon:F,isFocused:ae,isSelected:Z,getOptionProps:Ie}},us=()=>{const{isHit:i,onCreate:s}=N();return{getCreateProps:t.useCallback((n={},u=null)=>({ref:u,...n,style:i?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"data-focus":le(!i),tabIndex:-1,onClick:z(n.onClick,s)}),[i,s])}},ds=()=>{const{isEmpty:i,isHit:s}=N();return{getEmptyProps:t.useCallback((n={},u=null)=>({ref:u,...n,style:s&&!i?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,tabIndex:-1}),[s,i])}},At=ie(({className:i,children:s,icon:o,...n},u)=>{const{inputValue:r,styles:p}=N(),{getCreateProps:d}=us();s??(s=r);const v={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...p.item};return m.jsxs(D.li,{className:q("ui-autocomplete__item--create",i),__css:v,...d(n,u),children:[o!==null?m.jsx(ve,{children:o||m.jsx(Qe,{})}):null,o?m.jsx(D.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:gt(s,r)}):gt(s,r)]})});At.displayName="AutocompleteCreate";At.__ui__="AutocompleteCreate";const Qe=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:m.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});Qe.displayName="AutocompletePlusIcon";Qe.__ui__="AutocompletePlusIcon";const It=ie(({className:i,children:s,icon:o,...n},u)=>{const{emptyMessage:r,styles:p}=N(),{getEmptyProps:d}=ds();s??(s=r);const v={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...p.item};return m.jsxs(D.li,{className:q("ui-autocomplete__item--empty",i),__css:v,...d(n,u),children:[o!==null?m.jsx(ve,{children:o||m.jsx(Ze,{})}):null,o?m.jsx(D.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:s}):s]})});It.displayName="AutocompleteEmpty";It.__ui__="AutocompleteEmpty";const Ze=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:m.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});Ze.displayName="AutocompleteMinusIcon";Ze.__ui__="AutocompleteMinusIcon";const ps=()=>{const i=t.useId(),{focusedIndex:s,isOpen:o,listRef:n,rebirthOptions:u}=N(),r=Xe(),p=t.useRef(-1),d=r.value(s),v=t.useCallback(()=>{o||u(!1)},[o,u]);return t.useEffect(()=>{if(!n.current||!d||p.current===d.index)return;const y=n.current,S=d.node,P=y.clientHeight,C=y.scrollTop,F=C+P,g=S.clientHeight,b=S.offsetTop,A=b+g,V=C<=b&&A<=F,G=p.current<d.index;V||(A<=P?n.current.scrollTo({top:0}):G?n.current.scrollTo({top:A-P}):n.current.scrollTo({top:b+1})),p.current=d.index},[n,d]),_e(()=>{o||(p.current=-1)},[o]),{getListProps:t.useCallback((y={},S=null)=>({id:y.id??i,ref:Me(n,S),as:"ul",position:"relative",role:"listbox",tabIndex:-1,...y}),[n,i]),onAnimationComplete:v}},kt=ie(({className:i,children:s,footer:o,header:n,maxW:u,maxWidth:r,minW:p,minWidth:d,w:v,width:I,contentProps:y,...S},P)=>{var b,A,V,G,Q,B;const{styles:C}=N(),{getListProps:F,onAnimationComplete:g}=ps();return I??(I=v),I??(I=((b=C.list)==null?void 0:b.width)??((A=C.list)==null?void 0:A.w)),d??(d=p),d??(d=((V=C.list)==null?void 0:V.minWidth)??((G=C.list)==null?void 0:G.minW)),r??(r=u),r??(r=((Q=C.list)==null?void 0:Q.maxWidth)??((B=C.list)==null?void 0:B.maxW)),m.jsxs(Xt,{as:"div",className:"ui-autocomplete__popover",maxWidth:r,minWidth:d,width:I,__css:{...C.content,maxWidth:r,minWidth:d,width:I},...y,onAnimationComplete:z(y==null?void 0:y.onAnimationComplete,g),children:[n?m.jsx(D.div,{className:"ui-autocomplete__header",__css:{...C.header},children:n}):null,m.jsx(D.ul,{className:q("ui-autocomplete__list",i),__css:{...C.list},...F(S,P),children:s}),o?m.jsx(D.div,{className:"ui-autocomplete__footer",__css:{...C.footer},children:o}):null]})});kt.displayName="AutocompleteList";kt.__ui__="AutocompleteList";const Re=ie(({className:i,icon:s,...o},n)=>{const{styles:u}=N(),{children:r,customIcon:p,isSelected:d,getOptionProps:v}=rs(o);s??(s=p);const I={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...u.item};return m.jsxs(D.li,{className:q("ui-autocomplete__item",i),__css:I,...v({},n),children:[s!==null?m.jsx(ve,{opacity:d?1:0,children:s||m.jsx(et,{})}):null,m.jsx(D.span,{style:{flex:1},"data-label":!0,children:r})]})});Re.displayName="AutocompleteOption";Re.__ui__="AutocompleteOption";const et=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:m.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});et.displayName="AutocompleteCheckIcon";et.__ui__="AutocompleteCheckIcon";const ms=({label:i,...s})=>{const{omitSelectedValues:o,value:n}=N(),u=pe(n),r=Xe(),p=r.values(),v=(u&&o?r.values(({node:g})=>n.includes(g.dataset.value??"")):[]).map(({index:g})=>g),y=!p.filter(({index:g,node:b})=>{var A;return((A=b.parentElement)==null?void 0:A.dataset.label)===i&&!v.includes(g)&&"target"in b.dataset}).length,[S,P]=_t(s,vt),C=t.useCallback((g={},b=null)=>({ref:b,...g,...S,style:y?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"data-label":i,role:"autocomplete-group-container"}),[S,y,i]),F=t.useCallback((g={},b=null)=>({ref:b,...g,...P,"data-label":i,role:"autocomplete-group"}),[P,i]);return{label:i,getContainerProps:C,getGroupProps:F}},tt=ie(({className:i,children:s,color:o,h:n,height:u,minH:r,minHeight:p,labelProps:d,...v},I)=>{const{styles:y}=N(),{label:S,getContainerProps:P,getGroupProps:C}=ms(v);return n??(n=u),r??(r=p),m.jsxs(D.li,{className:q("ui-autocomplete__item","ui-autocomplete__item--group",i),__css:{color:o,h:"fit-content",w:"100%"},...P(),children:[m.jsx(D.span,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:y.groupLabel,...d,children:S}),m.jsx(D.ul,{...C({},I),className:"ui-autocomplete__item__group",__css:{h:n,minH:r,...y.group},children:s})]})});tt.displayName="AutocompleteOptionGroup";tt.__ui__="AutocompleteOptionGroup";const ht={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},fs=i=>{i=i.replace(/[！-～]/g,o=>String.fromCharCode(o.charCodeAt(0)-65248));const s=new RegExp("("+Object.keys(ht).join("|")+")","g");return i=i.replace(s,o=>ht[o]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),i=i.toUpperCase(),i},xs=i=>{const s=o=>o.map(n=>{const{isDisabled:u,isFocusable:r}=n;if(!(u&&!r))return"items"in n?s(n.items??[]):n}).filter(Boolean);return s(i).flat(1/0)},Ds=i=>{const{allowCreate:s=!1,allowFree:o=!1,animation:n,boundary:u,children:r,closeDelay:p,closeOnBlur:d=!0,closeOnEsc:v=!0,closeOnSelect:I=!0,defaultIsOpen:y,defaultValue:S,duration:P=.2,emptyMessage:C="No results found",eventListeners:F,flip:g,format:b=fs,gutter:A,insertPositionItem:V="first",isLazy:G,isOpen:Q,items:B,lazyBehavior:Y,matchWidth:me=!0,maxSelectValues:ye,modifiers:Ae,offset:fe,omitSelectedValues:k=!1,openDelay:Z,placeholder:xe,placement:ae="bottom-start",preventOverflow:Ce,strategy:Ie,value:ke,optionProps:K,onChange:Te,onClose:Le,onCreate:Se,onKeyDown:st,onOpen:St,onSearch:Pe,...ce}=ns(i),{"aria-readonly":Cs,onFocus:ot,...L}=Ut(ce,ls),[nt,Pt]=_t(ce,vt),{id:Ot}=ce,_=as(),Be=t.useRef(null),lt=t.useRef(null),ee=t.useRef(null),te=t.useRef(new Set([])),He=t.useRef(!1),it=t.useRef(void 0),[se,at]=t.useState(B?JSON.parse(JSON.stringify(B)):void 0),[w,Oe]=qt({defaultValue:S,value:ke,onChange:Te}),[ze,Ge]=t.useState(void 0),[j,re]=t.useState(""),[U,O]=t.useState(-1),[oe,ct]=t.useState(!1),[ue,rt]=t.useState(!0),{isOpen:f,onClose:R,onOpen:ut}=Qt({defaultIsOpen:y,isOpen:Q,onClose:Le,onOpen:St}),ge=U>-1,Ke=U===-2&&s,h=pe(w),we=h?!w.length:!w,[he,dt]=t.useMemo(()=>pe(V)?V:[V,"first"],[V]);s&&!Fe(r)&&console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: ${h?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const $=_.enabledValues(({node:e})=>h&&w.includes(e.dataset.value??"")).map(({index:e})=>e),H=_.enabledValues(({index:e,node:l})=>"target"in l.dataset&&!$.includes(e)),wt=bt(r),je=t.useMemo(()=>se==null?void 0:se.map((e,l)=>{if("value"in e){const{label:a,value:c,...x}=e;return m.jsx(Re,{value:c,...x,children:a},l)}else if("items"in e){const{items:a=[],label:c,...x}=e;return m.jsx(tt,{label:c,...x,children:a.map(({label:T,value:W,...Ye},Tt)=>m.jsx(Re,{value:W,...Ye,children:T},Tt))},l)}}).filter(Boolean),[se]),ne=!wt.length&&!(je!=null&&je.length),E=t.useCallback(()=>{L.disabled||L.readOnly||!s&&(ne||oe)||(ut(),ee.current&&ee.current.focus())},[s,L,oe,ne,ut]),de=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const l=_.enabledFirstValue(({node:a})=>"target"in a.dataset);if(l)if(!h||!k)O(l.index);else if($.includes(l.index)){const a=H[0];O((a==null?void 0:a.index)??-1)}else O(l.index)});te.current.add(e)},[_,H,oe,ne,h,k,$]),Ee=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const l=_.enabledLastValue(({node:a})=>"target"in a.dataset);if(l)if(!h||!k)O(l.index);else if($.includes(l.index)){const a=H.reverse()[0];O((a==null?void 0:a.index)??-1)}else O(l.index)});te.current.add(e)},[_,H,oe,ne,h,k,$]),Ue=t.useCallback(()=>{const e=setTimeout(()=>{const a=_.enabledValues().find(({node:c})=>h?w.includes(c.dataset.value??""):c.dataset.value===w);a&&O(a.index)});te.current.add(e)},[_,h,w]),be=t.useCallback((e=U)=>{const l=setTimeout(()=>{const a=_.enabledNextValue(e,({node:c})=>"target"in c.dataset);if(a)if(!h||!k)O(a.index);else if($.includes(a.index)){const c=H.find(({index:x})=>a.index<x)??H[0];O((c==null?void 0:c.index)??-1)}else O(a.index)});te.current.add(l)},[_,H,U,h,k,$]),$e=t.useCallback((e=U)=>{const l=setTimeout(()=>{const a=_.enabledPrevValue(e,({node:c})=>"target"in c.dataset);if(a)if(!h||!k)O(a.index);else if($.includes(a.index)){const c=H.reverse().find(({index:x})=>x<a.index)??H[0];O((c==null?void 0:c.index)??-1)}else O(a.index)});te.current.add(l)},[_,H,U,h,k,$]),X=we||k?de:Ue,pt=we||k?Ee:Ue,Je=t.useCallback(e=>{const l=_.values();let a=!1,c=!1;l.forEach(({index:x,node:T})=>{if(b(T.textContent??"").includes(e)){a=!0;const W="disabled"in T.dataset;T.dataset.target="",!c&&!W&&(c=!0,O(x))}else delete T.dataset.target}),rt(a)},[_,b]),J=t.useCallback((e=!0)=>{_.values().forEach(({node:a})=>{a.dataset.target=""}),e&&de(),rt(!0)},[_,de]),jt=t.useCallback(e=>{const l=_.values();if(!l.length)return;const c=(pe(e)?e:[e]).map(x=>{const{node:T}=l.find(({node:W})=>W.dataset.value===x)??{};if(T){const{textContent:W}=Array.from(T.children).find(Ye=>Ye.getAttribute("data-label")!==null)??{};return W}else return o?x:void 0}).filter(x=>!Fe(x));Ge(h?c:c[0])},[o,_,h]),M=t.useCallback((e,l=!0)=>{Oe(c=>{let x;return pe(c)?c.includes(e)?x=c.filter(W=>W!==e):x=[...c,e]:x=e,it.current=x,x});const a=_.values().filter(({node:c})=>b(c.textContent??"").includes(e)).length>0;(s||o||a)&&re(""),h&&l&&J(!1)},[o,s,h,J,Oe,_,b]),We=t.useCallback(()=>{let e=_.value(U);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const l=e.node.dataset.value??"";M(l),I&&R(),k&&be()},[I,_,U,k,M,R,be]),Et=t.useCallback(e=>{f||E(),Pe==null||Pe(e);const l=e.target.value,a=b(l);a?Je(a):J(),re(l)},[f,E,b,Pe,Je,J]),Dt=t.useCallback(()=>{He.current=!0},[]),Nt=t.useCallback(()=>{He.current=!1},[]),De=t.useCallback(()=>{if(!lt.current)return;const e={label:j,value:j};let l=[];if(se&&(l=[...se]),he==="first")l=[e,...l];else if(he==="last")l=[...l,e];else{const c=l.findIndex(({label:T})=>T===he),x=l[c];c!==-1&&x&&"items"in x?(dt==="first"?x.items=[e,...x.items??[]]:x.items=[...x.items??[],e],l[c]=x):console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: '${he}' specified in insertPositionItem does not exist in the option group.`)}at(l),M(j),J(!1);const a=xs(l).findIndex(({value:c})=>c===j);O(a),Se==null||Se(e,l)},[j,se,he,M,J,Se,dt,h]),mt=t.useCallback(()=>{f?ee.current&&ee.current.focus():(E(),X())},[f,X,E]),Ne=t.useCallback(()=>{f||(E(),X())},[f,X,E]),ft=t.useCallback(e=>{const l=$t(e);Jt(Be.current,l)||!d&&ue||(o&&j&&M(j,!1),re(""),f&&R())},[d,ue,f,j,o,R,M]),xt=t.useCallback(()=>{M(h?w[w.length-1]:""),f||Ne()},[h,f,M,Ne,w]),Vt=t.useCallback(e=>{e.stopPropagation(),it.current=[],Oe([]),Ge(void 0),re(""),J(),f&&ee.current&&ee.current.focus()},[f,Ge,re,Oe,J]),Ct=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),L.disabled||L.readOnly||He.current)return;const l=ze===j||!j.length,c={ArrowDown:ge?()=>be():f?void 0:Ve(E,X),ArrowUp:ge?()=>$e():f?void 0:Ve(E,pt),Backspace:!we&&l?xt:void 0,End:f?Ee:void 0,Enter:Ke?De:ge?We:f?o&&h?()=>{j&&M(j),O(0)}:void 0:Ve(E,X),Escape:v?R:void 0,Home:f?de:void 0,Space:Ke?De:ge?We:f?void 0:Ve(E,X)}[e.key];c&&(e.preventDefault(),e.stopPropagation(),c(e))},[o,L,ze,j,E,ge,h,X,be,pt,$e,Ke,De,We,f,de,Ee,v,R,we,xt,M]);t.useEffect(()=>{if(!h||!k&&Fe(ye))return;const e=w.length>0&&w.length===_.count(),l=w.length===ye;e||l?(R(),ct(!0)):ct(!1)},[k,w,_,h,R,ye]),Wt(()=>{jt(w)},[w]),_e(()=>{f||o||(O(-1),re(""))},[f]),_e(()=>{ue||O(-2)},[ue]),_e(()=>{at(B?JSON.parse(JSON.stringify(B)):void 0)},[B]),Yt(()=>{te.current.forEach(e=>clearTimeout(e)),te.current.clear()}),Zt({ref:Be,enabled:f&&(d||!ue),handler:R});const Ft=t.useCallback(e=>({animation:n,boundary:u,closeDelay:p,closeOnBlur:d,duration:P,eventListeners:F,flip:g,gutter:A,isLazy:G,lazyBehavior:Y,matchWidth:me,modifiers:Ae,offset:fe,openDelay:Z,placement:ae,preventOverflow:Ce,strategy:Ie,...e,closeOnButton:!1,isOpen:f,trigger:"never",onClose:R,onOpen:E}),[d,Z,p,G,Y,n,P,fe,A,Ce,g,me,u,F,Ie,ae,Ae,f,E,R]),Rt=t.useCallback((e={},l=null)=>({ref:Me(Be,l),...nt,...e,...L,onBlur:z(e.onBlur,ce.onBlur,ft),onClick:z(e.onClick,ce.onClick,mt)}),[nt,L,ft,mt,ce]),Mt=t.useCallback((e={},l=null)=>({ref:l,tabIndex:-1,...e,...L,"aria-expanded":le(f),"data-active":le(f),placeholder:xe,onFocus:z(e.onFocus,ot,Ne),onKeyDown:z(e.onKeyDown,st,Ct)}),[L,xe,f,ot,Ne,st,Ct]);return{id:Ot,allowCreate:s,allowFree:o,children:r??je,closeOnSelect:I,descendants:_,emptyMessage:C,focusedIndex:U,inputRef:ee,inputValue:j,isAllSelected:oe,isEmpty:ne,isHit:ue,isOpen:f,label:ze,listRef:lt,omitSelectedValues:k,pickOptions:Je,rebirthOptions:J,setFocusedIndex:O,value:w,formControlProps:L,getContainerProps:Rt,getFieldProps:Mt,getPopoverProps:Ft,inputProps:Pt,optionProps:K,onChange:M,onClear:Vt,onClose:R,onCompositionEnd:Nt,onCompositionStart:Dt,onCreate:De,onFocusFirst:de,onFocusLast:Ee,onFocusNext:be,onFocusPrev:$e,onFocusSelected:Ue,onOpen:E,onSearch:Et}},Ns=()=>{const{id:i,focusedIndex:s,inputRef:o,isAllSelected:n,isOpen:u,listRef:r,formControlProps:p,inputProps:d,onCompositionEnd:v,onCompositionStart:I,onSearch:y}=N(),{value:S}=Xe();return _e(()=>{n&&o.current&&o.current.blur()},[n]),{getInputProps:t.useCallback((C={},F=null)=>{var g,b;return{ref:Me(o,F),...p,"aria-activedescendant":(g=S(s))==null?void 0:g.node.id,"aria-autocomplete":"list","aria-controls":(b=r.current)==null?void 0:b.id,"aria-expanded":u,"aria-haspopup":"listbox",autoCapitalize:"none",autoComplete:"off",role:"combobox",spellCheck:"false",...d,...C,id:i,cursor:p.readOnly?"default":"text",pointerEvents:p.disabled||n?"none":"auto",tabIndex:n?-1:0,onChange:z(C.onChange,y),onCompositionEnd:z(C.onCompositionEnd,d.onCompositionEnd,v),onCompositionStart:z(C.onCompositionStart,d.onCompositionStart,I)}},[r,s,u,d,o,p,i,n,S,y,I,v])}};export{js as A,Es as a,qe as b,kt as c,At as d,It as e,N as f,Ns as g,Re as h,tt as i,yt as j,Ds as u};
