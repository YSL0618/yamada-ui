import{u as F}from"./index-BPP3U8Du.js";import{r as f}from"./index-ClcD9ViR.js";import{f as d,O as E,u as p,P as A,Q as b,R as h,S as g}from"./factory-Db31n_eg.js";const q=s=>{const e=s.current;if(!e)return!1;const r=h(e);return!r||e.contains(r)?!1:!!g(r)},S=(s,{focusRef:e,shouldFocus:r,visible:o})=>{const t=r&&!o;d(()=>{if(!t||q(s))return;const n=e.current||s.current;n&&requestAnimationFrame(()=>{n.focus()})},[t,s,e])},V=(s,{focusRef:e,preventScroll:r,shouldFocus:o,visible:t}={preventScroll:!0,shouldFocus:!1})=>{const n=E(s)?s.current:s,l=o&&t,a=f.useRef(l),c=f.useRef(t);p(()=>{!c.current&&t&&(a.current=l),c.current=t},[t,l]);const u=f.useCallback(()=>{if(!(!t||!n||!a.current)&&(a.current=!1,!n.contains(document.activeElement)))if(e!=null&&e.current)requestAnimationFrame(()=>{var i;(i=e.current)==null||i.focus({preventScroll:r})});else{const i=A(n);i.length>0&&requestAnimationFrame(()=>{var m;(m=i[0])==null||m.focus({preventScroll:r})})}},[t,r,n,e]);d(()=>{requestAnimationFrame(()=>{u()})},[u]),F(n,"transitionend",u)},x=({ref:s,elements:e,enabled:r})=>{const o=()=>{var t;return((t=s.current)==null?void 0:t.ownerDocument)??document};F(o,"pointerdown",t=>{if(!b()||!r)return;const n=t.target,a=(e??[s]).some(c=>{const u=E(c)?c.current:c;return(u==null?void 0:u.contains(n))||u===n});o().activeElement!==n&&a&&(t.preventDefault(),n.focus())})};export{S as a,V as b,x as u};
