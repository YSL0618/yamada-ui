import{j as h}from"./jsx-runtime-CfatFE5O.js";import{u as it}from"./index-coqOwSQu.js";import{r as s}from"./index-ClcD9ViR.js";import{c as rt,a as ut}from"./icon-BfxegGWg.js";import{f as ie}from"./forward-ref-D13m8o2p.js";import{E as Ve,X as dt,g as pt,a as ce,x as We,d as ae,h as le,aS as ft,J as Q,b as M,c as ee,Z as Xe,a9 as Ze,p as mt,_ as xt,a3 as ht,q as Qe,ai as bt,$ as Ct,a0 as ge,u as vt,f as gt,Y as _t,j as St}from"./factory-Db31n_eg.js";import{u as yt}from"./index-Hr0uPYc7.js";import{c as Ot}from"./index-CzwbnnDs.js";import{u as It}from"./index-BzLdmcXo.js";import{u as Pt}from"./index-D7WKgYAe.js";import{c as kt,f as jt}from"./form-control-DiJsSBY_.js";import{b as wt}from"./popover-trigger-CprRNq_c.js";const Dt=r=>{var a;return ft(r)&&!!((a=r.getAttribute("role"))!=null&&a.startsWith("option"))},Et=r=>{const{closeOnSelect:a,fieldRef:c,focusedIndex:o,omitSelectedValues:i,placeholder:n,placeholderInOptions:b,setFocusedIndex:C,value:I,optionProps:u,onChange:g,onClose:j,onFocusNext:P}=U(),d=s.useId(),E=s.useRef(null);let{id:F,children:y,closeOnSelect:N,icon:m,isDisabled:x,isFocusable:w,value:_,...S}={...u,...r};const re=!!x&&!w,{descendants:J,index:H,register:te}=Nt({disabled:re}),ue=J.values().slice(0,H),de=!!n&&b,ye=de&&H===0,W=Q(I),z=W?!1:ue.some(({node:A})=>A.dataset.value===(_??"")),X=!z&&(W?I.includes(_??""):(_??"")===I),R=H===o;F??(F=d),!ye&&Ve(_)&&(dt(y)||pt(y)?_=y.toString():console.warn(`${W?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),de&&H>0&&!_&&console.warn(`${W?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const Oe=s.useCallback(A=>{if(A.preventDefault(),A.stopPropagation(),x||!Dt(A.currentTarget)){c.current&&c.current.focus();return}z||C(H),g(_??""),c.current&&c.current.focus(),(N??a)&&j(),i&&P()},[x,z,C,H,g,_,c,N,a,j,i,P]),T=s.useCallback((A={},pe=null)=>{const p={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ce(E,pe,te),role:"option",...S,...A,id:F,style:i&&X?p:void 0,"aria-disabled":We(x),"aria-selected":X,"data-disabled":ae(x),"data-duplicated":ae(z),"data-focus":ae(R),"data-value":_??"",tabIndex:-1,onClick:le(S.onClick,A.onClick,Oe)}},[F,_,S,x,R,z,X,i,Oe,te]);return{children:y,customIcon:m,isFocused:R,isSelected:X,getOptionProps:T}},_e=ie(({className:r,icon:a,...c},o)=>{const{styles:i}=U(),{children:n,customIcon:b,isSelected:C,getOptionProps:I}=Et(c);a??(a=b);const u={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...i.item};return h.jsxs(M.div,{className:ee("ui-select__item",r),__css:u,...I({},o),children:[a!==null?h.jsx(Ne,{opacity:C?1:0,children:a||h.jsx(Ft,{})}):null,h.jsx(M.span,{style:{flex:1},"data-label":!0,children:n})]})});_e.displayName="Option";_e.__ui__="Option";const Ne=ie(({className:r,...a},c)=>{const{styles:o}=U(),i={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...o.itemIcon};return h.jsx(M.span,{ref:c,className:ee("ui-select__item__icon",r),__css:i,...a})});Ne.displayName="OptionIcon";Ne.__ui__="OptionIcon";const Ft=()=>h.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:h.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Vt=({label:r,...a})=>{const{omitSelectedValues:c,value:o}=U(),i=et(),n=s.useRef(null),b=s.useId(),C=i.values(),g=(Q(o)&&c?i.values(({node:m})=>o.includes(m.dataset.value??"")):[]).map(({index:m})=>m),P=!C.filter(({index:m,node:x})=>{var w;return((w=x.parentElement)==null?void 0:w.dataset.label)===r&&!g.includes(m)}).length,[d,E]=Xe(a,Ze),F=s.useCallback((m={},x=null)=>{var _;const w={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:x,"aria-labelledby":(_=n.current)==null?void 0:_.id,role:"group",...m,...d,style:P?w:void 0}},[d,P]),y=s.useCallback(({id:m,...x}={},w=null)=>({id:m??b,ref:ce(w,n),role:"presentation",...x}),[b]),N=s.useCallback((m={},x=null)=>({ref:x,...m,...E,"data-label":r}),[E,r]);return{label:r,getContainerProps:F,getGroupProps:N,getLabelProps:y}},Re=ie(({className:r,children:a,color:c,h:o,height:i,minH:n,minHeight:b,labelProps:C,...I},u)=>{const{styles:g}=U(),{label:j,getContainerProps:P,getGroupProps:d,getLabelProps:E}=Vt(I);return o??(o=i),n??(n=b),h.jsxs(M.section,{className:ee("ui-select__item","ui-select__item--group",r),__css:{color:c,h:"fit-content",w:"100%"},...P(),children:[h.jsx(M.header,{className:"ui-select__item__group-label",lineClamp:1,__css:g.groupLabel,...E(C),children:j}),h.jsx(M.div,{...d({},u),className:"ui-select__item__group",__css:{h:o,minH:n,...g.group},children:a})]})});Re.displayName="OptionGroup";Re.__ui__="OptionGroup";const{DescendantsContextProvider:Wt,useDescendant:Nt,useDescendants:Rt,useDescendantsContext:et}=Ot(),[Xt,U]=mt({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),Zt=r=>{var Je;const{animation:a,boundary:c,children:o,closeDelay:i,closeOnBlur:n=!0,closeOnEsc:b=!0,closeOnSelect:C=!0,defaultIsOpen:I,defaultValue:u,duration:g=.2,eventListeners:j,flip:P,gutter:d,isLazy:E,isOpen:F,items:y=[],lazyBehavior:N,matchWidth:m=!0,maxSelectValues:x,modifiers:w,offset:_,omitSelectedValues:S=!1,openDelay:re,placeholder:J,placeholderInOptions:H=!0,placement:te="bottom-start",preventOverflow:Se,strategy:ue,value:de,optionProps:ye,onChange:W,onClose:z,onOpen:X,...R}=kt(r),{"aria-readonly":Oe,...T}=xt(R,jt),[A,pe]=Xe(ht(R,["aria-readonly"]),Ze),p=Rt(),[G,O]=s.useState(-1),[Le,Ae]=s.useState(!1),fe=s.useRef(null),Be=s.useRef(null),Y=s.useRef(new Set([])),[D,me]=yt({defaultValue:u,value:de,onChange:W}),[Z,Ie]=s.useState(void 0),xe=!!J&&H,se=G>-1,v=Q(D),Me=(v?!D.length:!D)&&!xe,K=p.values(({node:e})=>v&&D.includes(e.dataset.value??"")).map(({index:e})=>e),B=p.enabledValues(({index:e})=>!K.includes(e)),He=(Je=p.value(G))==null?void 0:Je.node.id,he=Qe(o),Ge=s.useMemo(()=>!he.length&&y.length?y.map((e,t)=>{if("value"in e){const{label:l,value:k,...q}=e;return h.jsx(_e,{value:k,...q,children:l},t)}else if("items"in e){const{items:l=[],label:k,...q}=e;return h.jsx(Re,{label:k,...q,children:l.map(({label:Ee,value:ve,...Fe},oe)=>h.jsx(_e,{value:ve,...Fe,children:Ee},oe))},t)}}).filter(Boolean):he,[he,y]),Pe=!he.length&&!Ge.length&&(v?!0:!xe),be=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledFirstValue();if(t)if(!v||!S)O(t.index);else if(K.includes(t.index)){const l=B[0];O((l==null?void 0:l.index)??-1)}else O(t.index)});Y.current.add(e)},[p,B,v,S,K]),Ce=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledLastValue();if(t)if(!v||!S)O(t.index);else if(K.includes(t.index)){const l=B.reverse()[0];O((l==null?void 0:l.index)??-1)}else O(t.index)});Y.current.add(e)},[p,B,v,S,K]),ke=s.useCallback(()=>{const e=setTimeout(()=>{const l=p.enabledValues().find(({node:k})=>v?D.includes(k.dataset.value??""):k.dataset.value===D);l&&O(l.index)});Y.current.add(e)},[p,v,D]),ne=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledNextValue(G);if(t)if(!v||!S)O(t.index);else if(K.includes(t.index)){const l=B.find(({index:k})=>t.index<k)??B[0];O((l==null?void 0:l.index)??-1)}else O(t.index)});Y.current.add(e)},[p,B,G,v,S,K,O]),je=s.useCallback(()=>{const e=setTimeout(()=>{const t=p.enabledPrevValue(G);if(t)if(!v||!S)O(t.index);else if(K.includes(t.index)){const l=B.reverse().find(({index:k})=>k<t.index)??B[0];O((l==null?void 0:l.index)??-1)}else O(t.index)});Y.current.add(e)},[p,B,G,v,S,K,O]),$=Me||S?be:ke,Ke=Me||S?Ce:ke,nt=s.useCallback(e=>{const t=p.values();if(!t.length)return;const k=(Q(e)?e:[e]).map(q=>{const{index:Ee,node:ve}=t.find(({node:oe})=>oe.dataset.value===q)??{};if(!ve||xe&&Ee===0)return;const{innerHTML:Fe}=Array.from(ve.children).find(oe=>oe.getAttribute("data-label")!==null)??{};return Fe}).filter(q=>!Ve(q));Ie(v?k:k[0])},[p,v,xe]),we=s.useCallback(e=>{me(t=>Q(t)?t.includes(e)?t.filter(k=>k!==e):[...t,e]:e)},[me]),ot=s.useCallback(e=>{e.stopPropagation(),me([]),Ie(void 0)},[Ie,me]),{isOpen:f,onClose:V,onOpen:Ue}=It({defaultIsOpen:I,isOpen:F,onClose:z,onOpen:X}),L=s.useCallback(()=>{T.disabled||T.readOnly||Pe||Le||Ue()},[T,Pe,Le,Ue]),De=s.useCallback(()=>{let e=p.value(G);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";we(t),C&&V(),S&&ne()},[C,p,G,S,we,V,ne]),$e=s.useCallback(()=>{f||(L(),$())},[f,$,L]),ze=s.useCallback(()=>{f||(L(),$())},[f,$,L]),Ye=s.useCallback(e=>{const t=bt(e);Ct(fe.current,t)||n&&f&&V()},[n,f,V]),qe=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),T.disabled||T.readOnly)return;const l={ArrowDown:se?()=>ne():f?void 0:ge(L,$),ArrowUp:e.altKey&&f?V:se?()=>je():f?void 0:ge(L,Ke),End:f?Ce:void 0,Enter:se?De:f?void 0:ge(L,$),Escape:b?V:void 0,Home:f?be:void 0,Space:se?De:f?void 0:ge(L,$)}[e.key];l&&(e.preventDefault(),e.stopPropagation(),l())},[T.disabled,T.readOnly,se,f,L,$,Ke,De,be,Ce,b,V,ne,je]);Pt({ref:fe,enabled:f&&n,handler:V}),s.useEffect(()=>{if(!v||!S&&Ve(x))return;const e=D.length>0&&D.length===p.count(),t=D.length===x;e||t?(V(),Ae(!0)):Ae(!1)},[S,D,p,v,V,x]),vt(()=>{nt(D)},[D]),gt(()=>{f||O(-1)},[f]),_t(()=>{Y.current.forEach(e=>clearTimeout(e)),Y.current.clear()});const lt=s.useCallback(e=>({animation:a,boundary:c,closeDelay:i,closeOnBlur:n,duration:g,eventListeners:j,flip:P,gutter:d,isLazy:E,lazyBehavior:N,matchWidth:m,modifiers:w,offset:_,openDelay:re,placement:te,preventOverflow:Se,strategy:ue,...e,closeOnButton:!1,isOpen:f,trigger:"never",onClose:V,onOpen:L}),[n,re,i,E,N,a,g,_,d,Se,P,m,c,j,ue,te,w,f,L,V]),at=s.useCallback((e={},t=null)=>({ref:ce(fe,t),...A,...e,...T,onBlur:le(e.onBlur,R.onBlur,Ye),onClick:le(e.onClick,R.onClick,$e)}),[A,T,Ye,$e,R]),ct=s.useCallback(({"aria-label":e,...t}={},l=null)=>(e??(e=J??`Select ${v?"one or more options.":"an option."}`),{ref:ce(Be,l),"aria-activedescendant":He,"aria-haspopup":"listbox","aria-label":e,role:"combobox",tabIndex:0,...pe,...t,"data-active":ae(f),"data-placeholder":ae(v?!(Z!=null&&Z.length):Z===void 0),onFocus:le(t.onFocus,R.onFocus,ze),onKeyDown:le(t.onKeyDown,R.onKeyDown,qe)}),[He,pe,f,v,Z,J,R,ze,qe]);return{children:Ge,closeOnSelect:C,containerRef:fe,descendants:p,fieldRef:Be,focusedIndex:G,isEmpty:Pe,isOpen:f,label:Z,omitSelectedValues:S,placeholder:J,placeholderInOptions:H,setFocusedIndex:O,value:D,formControlProps:T,getContainerProps:at,getFieldProps:ct,getPopoverProps:lt,optionProps:ye,onChange:we,onClear:ot,onClose:V,onFocusFirst:be,onFocusLast:Ce,onFocusNext:ne,onFocusPrev:je,onFocusSelected:ke,onOpen:L}},Te=ie(({className:r,children:a,__css:c,...o},i)=>{const{styles:n}=U(),b={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...n.icon,...c},I=Qe(a).map(u=>s.cloneElement(u,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return h.jsx(M.div,{ref:i,className:ee("ui-select__icon",r),__css:b,...o,children:St(a)?I:h.jsx(rt,{})})});Te.displayName="SelectIcon";Te.__ui__="SelectIcon";const tt=({className:r,children:a,...c})=>{const o=s.useRef(null),{styles:i}=U(),n=c.disabled,b=it({ref:o,isDisabled:n,...c});return h.jsx(Te,{className:ee("ui-select__clear-icon",r),"aria-label":"Clear value",__css:i.clearIcon,...b,children:a??h.jsx(ut,{h:"0.5em",w:"0.5em"})})};tt.displayName="SelectClearIcon";tt.__ui__="SelectClearIcon";const Tt=()=>{const{focusedIndex:r,value:a}=U(),c=et(),o=s.useRef(null),i=s.useRef(-1),n=c.value(r),b=Q(a);s.useEffect(()=>{if(!o.current||!n||i.current===n.index)return;const u=o.current,g=n.node,j=u.clientHeight,P=u.scrollTop,d=P+j,E=g.clientHeight,F=g.offsetTop,y=F+E,N=P<=F&&y<=d,m=i.current<n.index;N||(y<=j?o.current.scrollTo({top:0}):m?o.current.scrollTo({top:y-j}):o.current.scrollTo({top:F+1})),i.current=n.index},[o,n]);const C=s.useCallback((u={},g=null)=>({ref:g,"aria-multiselectable":We(b),role:"listbox",...u}),[b]),I=s.useCallback((u={},g=null)=>({ref:ce(o,g),position:"relative",tabIndex:-1,...u}),[o]);return{getContainerProps:C,getListProps:I}},st=ie(({className:r,children:a,footer:c,header:o,maxW:i,maxWidth:n,minW:b,minWidth:C,w:I,width:u,contentProps:g,...j},P)=>{var y,N,m,x,w,_;const{styles:d}=U(),{getContainerProps:E,getListProps:F}=Tt();return u??(u=I),u??(u=((y=d.list)==null?void 0:y.width)??((N=d.list)==null?void 0:N.w)),C??(C=b),C??(C=((m=d.list)==null?void 0:m.minWidth)??((x=d.list)==null?void 0:x.minW)),n??(n=i),n??(n=((w=d.list)==null?void 0:w.maxWidth)??((_=d.list)==null?void 0:_.maxW)),h.jsxs(wt,{as:"div",className:"ui-select__content",maxWidth:n,minWidth:C,width:u,__css:{...d.content,maxWidth:n,minWidth:C,width:u},...E(g),children:[o?h.jsx(M.header,{className:"ui-select__header",__css:{...d.header},children:o}):null,h.jsx(M.div,{className:ee("ui-select__list",r),__css:{...d.list},...F(j,P),children:a}),c?h.jsx(M.footer,{className:"ui-select__footer",__css:{...d.footer},children:c}):null]})});st.displayName="SelectList";st.__ui__="SelectList";export{_e as O,Wt as S,Xt as a,Te as b,st as c,U as d,Re as e,tt as f,Zt as u};
