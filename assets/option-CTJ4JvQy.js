import{j as g}from"./jsx-runtime-Nms4Y4qS.js";import{u as $e}from"./index-DIig5QpT.js";import{r as n}from"./index-BwDkhjyp.js";import{c as qe,a as We}from"./icon-sIHrqgYT.js";import{f as ne}from"./forward-ref-DKTvpK5d.js";import{l as Je,T as Qe,S as He,a3 as Me,Y as Xe,s as Y,af as Ze,U as et,q as tt,f as st,R as nt,a as xe,h as se,d as be,x as Be,am as ot,V as me,t as lt,b as L,c as Q,j as ct}from"./factory-C2Uq3ahE.js";import{b as at}from"./popover-content-Br-m-ZU6.js";import{u as it}from"./index-JO6qx1eo.js";import{c as rt}from"./index-aK7o6Gpo.js";import{u as ut}from"./index-Bx4dOF2q.js";import{u as dt}from"./index-P1R8teSk.js";import{u as ft,f as pt}from"./form-control-Cvo0pEjR.js";const mt=o=>{var c;return ot(o)&&!!((c=o==null?void 0:o.getAttribute("role"))!=null&&c.startsWith("option"))},{DescendantsContextProvider:At,useDescendantsContext:Ue,useDescendants:xt,useDescendant:bt}=rt(),[Lt,H]=Je({strict:!1,name:"SelectContext"}),Nt=o=>{const{placeholder:c,closeOnSelect:l=!0,placeholderInOptions:a=!0,omitSelectedValues:t=!1,maxSelectValues:d,isEmpty:i,value:S,defaultValue:x,onChange:v,optionProps:y,isOpen:I,defaultIsOpen:j,onOpen:f,onClose:F,closeOnBlur:r=!0,closeOnEsc:m=!0,openDelay:D,closeDelay:M,isLazy:K,lazyBehavior:O,animation:$,duration:oe=.2,offset:le,gutter:U,preventOverflow:X,flip:ce,matchWidth:he=!0,boundary:ae,eventListeners:q,strategy:Ce,placement:N="bottom-start",modifiers:W,...T}=ft(o),{"aria-readonly":Pe,...b}=Qe(T,pt),[ie,Ie]=He(Xe(T,["aria-readonly"]),Me),p=xt(),[R,_]=n.useState(-1),[je,De]=n.useState(!1),re=n.useRef(null),Fe=n.useRef(null),we=n.useRef(null),z=n.useRef(new Set([])),[w,ue]=it({value:S,defaultValue:x,onChange:v}),[J,ve]=n.useState(void 0),Z=R>-1,h=Y(w),Ee=(h?!w.length:!w)&&!(c&&a),B=p.values(({node:e})=>h&&w.includes(e.dataset.value??"")).map(({index:e})=>e),A=p.enabledValues(({index:e})=>!B.includes(e)),de=n.useCallback(()=>{const e=setTimeout(()=>{const s=p.enabledFirstValue();if(s)if(!h||!t)_(s.index);else if(B.includes(s.index)){const C=A[0];_(C.index)}else _(s.index)});z.current.add(e)},[p,A,h,t,B]),fe=n.useCallback(()=>{const e=setTimeout(()=>{const s=p.enabledLastValue();if(s)if(!h||!t)_(s.index);else if(B.includes(s.index)){const C=A.reverse()[0];_(C.index)}else _(s.index)});z.current.add(e)},[p,A,h,t,B]),ge=n.useCallback(()=>{const e=setTimeout(()=>{const C=p.enabledValues().find(({node:P})=>h?w.includes(P.dataset.value??""):P.dataset.value===w);C&&_(C.index)});z.current.add(e)},[p,h,w]),ee=n.useCallback(()=>{const e=setTimeout(()=>{const s=p.enabledNextValue(R);if(s)if(!h||!t)_(s.index);else if(B.includes(s.index)){const C=A.find(({index:P})=>s.index<P)??A[0];_(C.index)}else _(s.index)});z.current.add(e)},[p,A,R,h,t,B,_]),Se=n.useCallback(()=>{const e=setTimeout(()=>{const s=p.enabledPrevValue(R);if(s)if(!h||!t)_(s.index);else if(B.includes(s.index)){const C=A.reverse().find(({index:P})=>P<s.index)??A[0];_(C.index)}else _(s.index)});z.current.add(e)},[p,A,R,h,t,B,_]),G=Ee||t?de:ge,Ve=Ee||t?fe:ge,_e=n.useCallback((e,s=!0)=>{const C=p.values();if(!C.length)return;const P=C.filter(({node:k})=>k.dataset.value===e).map(({node:k,index:te})=>{if(!(c&&a)||te!==0){const pe=Array.from(k.children).find(ke=>ke.getAttribute("data-label")!==null);return(pe==null?void 0:pe.innerHTML)??""}else return});ve(k=>h?(P.forEach(te=>{Y(k)&&k.includes(te??"")?s&&(k=Y(k)?k.filter(ke=>ke!==te):void 0):k=[...Y(k)?k:[],te]}),k):P[0])},[p,h,c,a]),ye=n.useCallback(e=>{ue(s=>Y(s)?s.includes(e)?s.filter(P=>P!==e):[...s,e]:e),_e(e)},[_e,ue]),Ge=n.useCallback(e=>{e.stopPropagation(),ue([]),ve(void 0)},[ve,ue]),{isOpen:u,onOpen:Te,onClose:E}=ut({isOpen:I,defaultIsOpen:j,onOpen:f,onClose:F}),V=n.useCallback(()=>{b.disabled||b.readOnly||i||je||Te()},[b,i,je,Te]),Oe=n.useCallback(()=>{let e=p.value(R);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";ye(s),l&&E(),t&&ee()},[l,p,R,t,ye,E,ee]),Re=n.useCallback(()=>{u||(V(),G())},[u,G,V]),Ae=n.useCallback(()=>{u||(V(),G())},[u,G,V]),Le=n.useCallback(e=>{const s=Ze(e);et(re.current,s)||r&&u&&E()},[r,u,E]),Ne=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),b.disabled||b.readOnly)return;const C={ArrowDown:Z?()=>ee():u?void 0:me(V,G),ArrowUp:Z?()=>Se():u?void 0:me(V,Ve),Space:Z?Oe:u?void 0:me(V,G),Enter:Z?Oe:u?void 0:me(V,G),Home:u?de:void 0,End:u?fe:void 0,Escape:m?E:void 0}[e.key];C&&(e.preventDefault(),e.stopPropagation(),C())},[b.disabled,b.readOnly,Z,u,V,G,Ve,Oe,de,fe,m,E,ee,Se]);dt({ref:re,handler:E,enabled:u&&r}),n.useEffect(()=>{if(!h||!t&&tt(d))return;const e=w.length>0&&w.length===p.count(),s=w.length===d;e||s?(E(),De(!0)):De(!1)},[t,w,p,h,E,d]),st(()=>{u||_(-1)},[u]),nt(()=>{z.current.forEach(e=>clearTimeout(e)),z.current.clear()});const Ke=n.useCallback(e=>({closeOnBlur:r,openDelay:D,closeDelay:M,isLazy:K,lazyBehavior:O,animation:$,duration:oe,offset:le,gutter:U,preventOverflow:X,flip:ce,matchWidth:he,boundary:ae,eventListeners:q,strategy:Ce,placement:N,modifiers:W,...e,trigger:"never",closeOnButton:!1,isOpen:u,onOpen:V,onClose:E}),[r,D,M,K,O,$,oe,le,U,X,ce,he,ae,q,Ce,N,W,u,V,E]),ze=n.useCallback((e={},s=null)=>({ref:xe(re,s),...ie,...e,...b,onClick:se(e.onClick,T.onClick,Re),onBlur:se(e.onBlur,T.onBlur,Le)}),[ie,b,Le,Re,T]),Ye=n.useCallback(({"aria-label":e,...s}={},C=null)=>{var P,k;return e??(e=c??`Select ${h?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:xe(Fe,C),tabIndex:0,...Ie,...s,"data-active":be(u),"data-placeholder":be(h?!(J!=null&&J.length):J===void 0),"aria-controls":(P=we.current)==null?void 0:P.id,"aria-activedescendant":(k=p.value(R))==null?void 0:k.node.id,"aria-expanded":u,onFocus:se(s.onFocus,T.onFocus,Ae),onKeyDown:se(s.onKeyDown,T.onKeyDown,Ne)}},[p,Ie,R,u,h,J,c,T,Ae,Ne]);return{descendants:p,value:w,label:J,focusedIndex:R,placeholder:c,placeholderInOptions:a,omitSelectedValues:t,closeOnSelect:l,isOpen:u,containerRef:re,fieldRef:Fe,listRef:we,optionProps:y,formControlProps:b,onChangeLabel:_e,onChange:ye,onClear:Ge,onOpen:V,onClose:E,onFocusFirst:de,onFocusLast:fe,onFocusSelected:ge,onFocusNext:ee,onFocusPrev:Se,setFocusedIndex:_,getPopoverProps:Ke,getContainerProps:ze,getFieldProps:Ye}},ht=()=>{const{listRef:o,focusedIndex:c}=H(),l=Ue(),a=n.useRef(-1),t=l.value(c);n.useEffect(()=>{if(!o.current||!t||a.current===t.index)return;const S=o.current,x=t.node,v=S.clientHeight,y=S.scrollTop,I=y+v,j=x.clientHeight,f=x.offsetTop,F=f+j,r=y<=f&&F<=I,m=a.current<t.index;r||(F<=v?o.current.scrollTo({top:0}):m?o.current.scrollTo({top:F-v}):o.current.scrollTo({top:f+1})),a.current=t.index},[o,t]);const d=n.useId();return{getListProps:n.useCallback((S={},x=null)=>({id:d,ref:xe(o,x),role:"listbox",tabIndex:-1,position:"relative",...S}),[d,o])}},Ct=({label:o,...c})=>{const{value:l,omitSelectedValues:a}=H(),t=Y(l),d=Ue(),i=d.values(),x=(t&&a?d.values(({node:r})=>l.includes(r.dataset.value??"")):[]).map(({index:r})=>r),y=!i.filter(({node:r,index:m})=>{var D;return((D=r.parentElement)==null?void 0:D.dataset.label)===o&&!x.includes(m)}).length,[I,j]=He(c,Me),f=n.useCallback((r={},m=null)=>({ref:m,...r,...I,style:y?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[I,y]),F=n.useCallback(({"aria-label":r,...m}={},D=null)=>(r??(r=o),{"aria-label":r,ref:D,role:"group",...m,...j,"data-label":o}),[j,o]);return{label:o,getContainerProps:f,getGroupProps:F}},vt=(o,c)=>{const{fieldRef:l,value:a,placeholder:t,placeholderInOptions:d,omitSelectedValues:i,closeOnSelect:S,focusedIndex:x,optionProps:v,onChange:y,onChangeLabel:I,onFocusNext:j,onClose:f,setFocusedIndex:F}=H();let{icon:r,isDisabled:m,isFocusable:D,closeOnSelect:M,children:K,value:O,...$}={...v,...c};const oe=!!m&&!D,le=n.useRef(null),{index:U,register:X,descendants:ce}=bt({disabled:oe}),ae=ce.values().slice(0,U),q=Y(a),N=!(q?!1:ae.some(({node:b})=>b.dataset.value===(O??"")))&&(q?a.includes(O??""):(O??"")===a),W=U===x;t&&U>0&&d&&!O&&console.warn(`${q?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const T=n.useCallback(b=>{if(b.preventDefault(),b.stopPropagation(),m){l.current&&l.current.focus();return}if(!mt(b.currentTarget)){l.current&&l.current.focus();return}F(U),y(O??""),l.current&&l.current.focus(),(M??S)&&f(),i&&j()},[m,F,U,y,O,l,M,S,f,i,j]);n.useEffect(()=>{N&&I(O??"",!1)},[O,N,I]);const Pe=n.useCallback((b={})=>{const ie={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:xe(le,o,X),...$,...b,tabIndex:-1,style:i&&N?ie:void 0,"data-value":O??"","data-focus":be(W),"data-disabled":be(m),"aria-checked":Be(N),"aria-disabled":Be(m),onClick:se($.onClick,b.onClick,T)}},[O,$,m,W,N,i,T,o,X]);return{isSelected:N,isFocused:W,customIcon:r,children:K,getOptionProps:Pe}},gt=ne(({className:o,children:c,__css:l,...a},t)=>{const{styles:d}=H(),i={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...d.icon,...l},x=lt(c).map(v=>n.cloneElement(v,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return g.jsx(L.div,{ref:t,className:Q("ui-select__icon",o),__css:i,...a,children:ct(c)?x:g.jsx(qe,{})})}),Bt=({className:o,children:c,...l})=>{const a=n.useRef(null),{styles:t}=H(),d=l.disabled,i=$e({ref:a,isDisabled:d,...l});return g.jsx(gt,{"aria-label":"Clear value",className:Q("ui-select__clear-icon",o),__css:t.clearIcon,...i,children:c??g.jsx(We,{w:"0.5em",h:"0.5em"})})},Ht=ne(({className:o,w:c,width:l,minW:a,minWidth:t,maxW:d,maxWidth:i,contentProps:S,header:x,footer:v,children:y,...I},j)=>{var r,m,D,M,K,O;const{styles:f}=H(),{getListProps:F}=ht();return l??(l=c),l??(l=((r=f.list)==null?void 0:r.width)??((m=f.list)==null?void 0:m.w)),t??(t=a),t??(t=((D=f.list)==null?void 0:D.minWidth)??((M=f.list)==null?void 0:M.minW)),i??(i=d),i??(i=((K=f.list)==null?void 0:K.maxWidth)??((O=f.list)==null?void 0:O.maxW)),g.jsxs(at,{as:"div",className:"ui-select__content",width:l,minWidth:t,maxWidth:i,__css:{...f.content,width:l,minWidth:t,maxWidth:i},...S,children:[x?g.jsx(L.div,{className:"ui-select__header",__css:{...f.header},children:x}):null,g.jsx(L.ul,{className:Q("ui-select__list",o),__css:{...f.list},...F(I,j),children:y}),v?g.jsx(L.div,{className:"ui-select__footer",__css:{...f.footer},children:v}):null]})}),Mt=ne(({className:o,color:c,h:l,height:a,minH:t,minHeight:d,children:i,...S},x)=>{const{styles:v}=H(),{label:y,getContainerProps:I,getGroupProps:j}=Ct(S);return l??(l=a),t??(t=d),g.jsxs(L.li,{className:Q("ui-select__item","ui-select__item--group",o),__css:{w:"100%",h:"fit-content",color:c},...I(),children:[g.jsx(L.span,{className:"ui-select__item__group-label",__css:v.groupLabel,lineClamp:1,children:y}),g.jsx(L.ul,{...j({},x),className:"ui-select__item__group",__css:{h:l,minH:t,...v.group},children:i})]})}),Ut=ne(({id:o,className:c,icon:l,...a},t)=>{const{styles:d}=H(),{isSelected:i,customIcon:S,children:x,getOptionProps:v}=vt(t,a);o??(o=n.useId()),l??(l=S);const y={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...d.item};return g.jsxs(L.li,{id:o,className:Q("ui-select__item",c),__css:y,...v(),children:[l!==null?g.jsx(St,{opacity:i?1:0,children:l||g.jsx(_t,{})}):null,g.jsx(L.span,{style:{flex:1},"data-label":!0,children:x})]})}),St=ne(({className:o,...c},l)=>{const{styles:a}=H(),t={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...a.itemIcon};return g.jsx(L.span,{ref:l,className:Q("ui-select__item__icon",o),__css:t,...c})}),_t=()=>g.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:g.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});export{Ut as O,At as S,Mt as a,Lt as b,gt as c,Ht as d,H as e,Bt as f,Nt as u};
