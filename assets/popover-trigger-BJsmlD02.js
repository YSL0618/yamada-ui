import{j as k}from"./extends-CwFRzn3r.js";import{r as n}from"./index-BwDkhjyp.js";import{C as ce}from"./close-button-TCaPA0pi.js";import{f as le}from"./forward-ref-BWI-Phbn.js";import{o as ae,a as H,h as u,z as fe,af as S,X as b,c as Z,p as me,ai as pe,b as de,Y as ve}from"./factory-BPGpAF5Z.js";import{s as L}from"./slide-fade-BEHgxEuP.js";import{s as ge}from"./scale-fade-Cv307av9.js";import{m as Pe}from"./forward-ref-scR1bmHx.js";import{m as Ce}from"./factory-CKjLh6Qg.js";import{b as ye}from"./index-CjlbPsry.js";import{u as he,a as xe}from"./index-BSZzY47h.js";import{u as be,a as Be,b as _e}from"./index-YIL2lgfe.js";import{u as Re}from"./index-BN4Uieo8.js";import{a as Te}from"./use-component-style-vGTU0kmU.js";import{o as we}from"./theme-provider-HQUvgn6k.js";const[Ee,U]=ae({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),$=f=>{const[l,r]=Te("Popover",f),{animation:B="scale",autoFocus:d=!0,children:_,closeDelay:m=200,closeOnBlur:v=!0,closeOnButton:R=!0,closeOnEsc:M=!0,duration:T,initialFocusRef:z,isLazy:X,lazyBehavior:O="unmount",openDelay:D=200,relatedRef:C,restoreFocus:Y=!0,trigger:c="click",...A}=we(r),{isOpen:o,onClose:s,onOpen:h,onToggle:j}=he(r),w=n.useRef(null),x=n.useRef(null),p=n.useRef(null),{present:I,onAnimationComplete:a}=ye({ref:p,isOpen:o}),g=n.useRef(void 0),K=n.useRef(void 0),E=n.useRef(!1),q=n.useRef(!1);o&&(q.current=!0);const{forceUpdate:G,referenceRef:N,transformOrigin:J,getPopperProps:te}=Re({...A,enabled:o});n.useEffect(()=>()=>{g.current&&clearTimeout(g.current),K.current&&clearTimeout(K.current)},[]),be({ref:x,enabled:o}),Be(p,{focusRef:x,shouldFocus:Y&&(c==="click"||c==="contextmenu"),visible:o}),_e(p,{focusRef:z,shouldFocus:d&&(c==="click"||c==="contextmenu"),visible:o});const Q=xe({enabled:X,isSelected:I,mode:O,wasSelected:q.current}),ne=n.useCallback((e={},F=null)=>{const i={...e,ref:H(p,F),style:{...e.style,transformOrigin:J},children:Q?e.children:null,tabIndex:-1,onBlur:u(e.onBlur,t=>{const P=S(t),y=b(p.current,P),ie=b(x.current,P),ue=C!=null&&C.current?b(C.current,P):!1;o&&v&&(!y&&!ie&&!ue)&&s()}),onKeyDown:u(e.onKeyDown,t=>{M&&t.key==="Escape"&&s()})};return c==="hover"&&(i.onMouseEnter=u(e.onMouseEnter,()=>{E.current=!0}),i.onMouseLeave=u(e.onMouseLeave,t=>{t.nativeEvent.relatedTarget!==null&&(E.current=!1,v&&setTimeout(s,m))})),i},[m,v,M,o,s,Q,J,c,C]),W=n.useCallback(e=>{w.current==null&&N(e)},[N]),re=n.useCallback((e={},F=null)=>{const i={...e,ref:H(x,F,W)};return c==="click"&&(i.onClick=u(e.onClick,j),i.onBlur=u(e.onBlur,t=>{const P=S(t),y=!b(p.current,P);o&&v&&y&&s()})),c==="contextmenu"&&(i.onContextMenu=u(e.onContextMenu,t=>{t.preventDefault(),h()}),i.onBlur=u(e.onBlur,t=>{const P=S(t),y=!b(p.current,P);o&&v&&y&&s()})),c==="hover"&&(i.onFocus=u(e.onFocus,()=>{g.current===void 0&&h()}),i.onBlur=u(e.onBlur,t=>{const P=S(t),y=!b(p.current,P);o&&v&&y&&s()}),i.onKeyDown=u(e.onKeyDown,t=>{t.key==="Escape"&&s()}),i.onMouseEnter=u(e.onMouseEnter,()=>{E.current=!0,g.current=window.setTimeout(h,D)}),i.onMouseLeave=u(e.onMouseLeave,()=>{E.current=!1,g.current&&(clearTimeout(g.current),g.current=void 0),K.current=window.setTimeout(()=>{E.current||s()},m)})),i},[m,v,o,W,s,h,j,D,c]),se=n.useCallback((e={},F=null)=>({...e,ref:H(F,w,N)}),[w,N]);return k.jsx(Ee,{value:{animation:B,closeOnButton:R,duration:T,forceUpdate:G,isOpen:o,styles:l,getAnchorProps:se,getPopoverProps:ne,getPopperProps:te,getTriggerProps:re,onAnimationComplete:a,onClose:s},children:fe(_,{forceUpdate:G,isOpen:o,onClose:s})})};$.displayName="Popover";$.__ui__="Popover";const V=le(({onClick:f,...l},r)=>{const{styles:B,onClose:d}=U(),_={position:"absolute",...B.closeButton};return k.jsx(ce,{ref:r,className:Z("ui-popover__close-button"),size:"sm",onClick:u(f,m=>{m.stopPropagation(),d==null||d()}),__css:_,...l})});V.displayName="PopoverCloseButton";V.__ui__="PopoverCloseButton";const Fe=(f="scale",l)=>{const r={duration:l,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(f){case"scale":return{...ge,custom:{...r,scale:.95}};case"top":return{...L,custom:{...r,offsetX:0,offsetY:-16}};case"right":return{...L,custom:{...r,offsetX:16,offsetY:0}};case"left":return{...L,custom:{...r,offsetX:-16,offsetY:0}};case"bottom":return{...L,custom:{...r,offsetX:0,offsetY:16}}}},ee=Pe(({as:f="section",className:l,children:r,maxW:B,maxWidth:d,minW:_,minWidth:m,w:v,width:R,z:M,zIndex:T,containerProps:z,__css:X,...O},D)=>{const{animation:C,closeOnButton:Y,duration:c,isOpen:A,styles:o,getPopoverProps:s,getPopperProps:h,onAnimationComplete:j}=U(),w=me(r),[x,...p]=pe(w,V),I=n.useMemo(()=>Ce(f),[f]),a=X??o.container??{},g={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...a};return R??(R=v),R??(R=a.width??a.w),m??(m=_),m??(m=a.minWidth??a.minW),d??(d=B),d??(d=a.maxWidth??a.maxW),T??(T=M),T??(T=a.zIndex??a.z),k.jsx(de.div,{...h({style:{visibility:A?"visible":"hidden"}}),className:"ui-popover",maxWidth:d,minWidth:m,outline:"none",width:R,zIndex:T,...z,children:k.jsxs(I,{className:Z("ui-popover__content",l),...C!=="none"?Fe(C,c):{},...s(O,D),animate:A?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:ve(j,O.onAnimationComplete),__css:g,children:[x??(Y?k.jsx(V,{}):null),p]})})});ee.displayName="PopoverContent";ee.__ui__="PopoverContent";const oe=({children:f})=>{const l=n.Children.only(f),{getTriggerProps:r}=U();return n.cloneElement(l,r(l.props,l.ref))};oe.displayName="PopoverTrigger";oe.__ui__="PopoverTrigger";export{$ as P,oe as a,ee as b,V as c,U as u};
