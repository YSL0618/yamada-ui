import{j as x}from"./extends-CwFRzn3r.js";import{f as le}from"./forward-ref-BWI-Phbn.js";import{o as Bt,p as vt,b as D,c as Q,j as Ht,f as pe,a as He,d as fe,t as zt,h as G,aO as Ut,F as W,z as ht,U as It,a6 as At,V as Gt,A as _t,ae as Jt,W as Kt,S as $t,X as Le}from"./factory-CYpx3TMG.js";import{r as t}from"./index-BwDkhjyp.js";import{b as Wt}from"./popover-content-C9K0DE-R.js";import{u as Xt}from"./index-tU9OGY6h.js";import{u as Yt}from"./index-CFjuI6Rx.js";import{u as qt}from"./index-DHvgXC6C.js";import{c as Qt}from"./index-C1nnoSu4.js";import{u as Zt}from"./index-CIt0OHe7.js";import{c as es,a as ts}from"./icon-FPUxZQsz.js";import{u as ss,f as os}from"./form-control-DTumWR9y.js";const{DescendantsContextProvider:Ps,useDescendantsContext:Qe,useDescendants:ns,useDescendant:ls}=Qt(),[ws,F]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),Ze=le(({className:o,children:n,__css:l,...a},r)=>{const{styles:d}=F(),p={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...d.icon,...l},h=vt(n).map(y=>t.cloneElement(y,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return x.jsx(D.div,{ref:r,className:Q("ui-autocomplete__icon",o),__css:p,...a,children:Ht(n)?h:x.jsx(es,{})})});Ze.displayName="AutocompleteIcon";Ze.__ui__="AutocompleteIcon";const kt=({className:o,children:n,...l})=>{const a=t.useRef(null),{styles:r}=F(),d=l.disabled,p=Zt({ref:a,isDisabled:d,...l});return x.jsx(Ze,{"aria-label":"Clear value",className:Q("ui-autocomplete__icon--clear",o),__css:r.clearIcon,...p,children:n??x.jsx(ts,{w:"0.5em",h:"0.5em"})})};kt.displayName="AutocompleteClearIcon";kt.__ui__="AutocompleteClearIcon";const Ae=le(({className:o,...n},l)=>{const{styles:a}=F(),r={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...a.itemIcon};return x.jsx(D.span,{ref:l,className:Q("ui-autocomplete__item__icon",o),__css:r,...n})});Ae.displayName="AutocompleteItemIcon";Ae.__ui__="AutocompleteItemIcon";const is=o=>{var n;return Ut(o)&&!!((n=o==null?void 0:o.getAttribute("role"))!=null&&n.startsWith("option"))},as=o=>{var be;const{value:n,omitSelectedValues:l,onChange:a,onChangeLabel:r,focusedIndex:d,setFocusedIndex:p,onClose:i,closeOnSelect:h,optionProps:y,inputRef:f,onFocusNext:v}=F(),P=t.useId();let{icon:C,isDisabled:w,isFocusable:I,closeOnSelect:A,children:E,value:j,...H}={...y,...o};const ie=!!w&&!I,T=t.useRef(null),{index:X,register:me,descendants:ke}=ls({disabled:ie}),Se=ke.values().slice(0,X),xe=W(n),Y=!(xe?!1:Se.some(({node:z})=>z.dataset.value===(j??"")))&&(xe?n.includes(j??""):(j??"")===n),Ce="target"in(((be=T.current)==null?void 0:be.dataset)??{}),ae=X===d,ge=t.useCallback(z=>{if(z.stopPropagation(),w){f.current&&f.current.focus();return}if(!is(z.currentTarget)){f.current&&f.current.focus();return}p(X),a(j??""),f.current&&f.current.focus(),(A??h)&&i(),l&&v(X)},[v,l,w,j,p,X,a,A,h,i,f]);pe(()=>{Y&&r(j??"",{runOmit:!1})},[j]);const Oe=t.useCallback((z={},Pe=null)=>{const we={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:He(T,Pe,me),id:P,role:"option",...H,...z,tabIndex:-1,style:!Ce||l&&Y?we:void 0,"data-target":fe(!0),"data-value":j??"","data-focus":fe(ae),"data-disabled":fe(w),"aria-checked":Y,"aria-disabled":zt(w),onClick:G(H.onClick,z.onClick,ge)}},[P,j,H,w,ae,Y,Ce,l,ge,me]);return{isSelected:Y,isFocused:ae,customIcon:C,children:E,getOptionProps:Oe}},cs=()=>{const{isHit:o,onCreate:n}=F();return{getCreateProps:t.useCallback((a={},r=null)=>({ref:r,...a,tabIndex:-1,style:o?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0,"data-focus":fe(!o),onClick:G(a.onClick,n)}),[o,n])}},rs=()=>{const{isHit:o,isEmpty:n}=F();return{getEmptyProps:t.useCallback((a={},r=null)=>({ref:r,...a,tabIndex:-1,style:o&&!n?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[o,n])}},St=le(({className:o,icon:n,children:l,...a},r)=>{const{inputValue:d,styles:p}=F(),{getCreateProps:i}=cs();l??(l=d);const h={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...p.item};return x.jsxs(D.li,{className:Q("ui-autocomplete__item--create",o),__css:h,...i(a,r),children:[n!==null?x.jsx(Ae,{children:n||x.jsx(et,{})}):null,n?x.jsx(D.span,{style:{pointerEvents:"none",flex:1},lineClamp:1,children:ht(l,d)}):ht(l,d)]})});St.displayName="AutocompleteCreate";St.__ui__="AutocompleteCreate";const et=()=>x.jsx("svg",{viewBox:"0 0 45.402 45.402",width:"1em",height:"1em",children:x.jsx("path",{fill:"currentColor",d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"})});et.displayName="PlusIcon";et.__ui__="PlusIcon";const Ot=le(({className:o,icon:n,children:l,...a},r)=>{const{emptyMessage:d,styles:p}=F(),{getEmptyProps:i}=rs();l??(l=d);const h={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",pointerEvents:"none",...p.item};return x.jsxs(D.li,{className:Q("ui-autocomplete__item--empty",o),__css:h,...i(a,r),children:[n!==null?x.jsx(Ae,{children:n||x.jsx(tt,{})}):null,n?x.jsx(D.span,{style:{pointerEvents:"none",flex:1},lineClamp:1,children:l}):l]})});Ot.displayName="AutocompleteEmpty";Ot.__ui__="AutocompleteEmpty";const tt=()=>x.jsx("svg",{viewBox:"0 0 448 512",width:"1em",height:"1em",children:x.jsx("path",{fill:"currentColor",d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"})});tt.displayName="MinusIcon";tt.__ui__="MinusIcon";const us=()=>{const o=t.useId(),{focusedIndex:n,isOpen:l,listRef:a,rebirthOptions:r}=F(),d=Qe(),p=t.useRef(-1),i=d.value(n),h=t.useCallback(()=>{l||r(!1)},[l,r]);t.useEffect(()=>{if(!a.current||!i||p.current===i.index)return;const f=a.current,v=i.node,P=f.clientHeight,C=f.scrollTop,w=C+P,I=v.clientHeight,A=v.offsetTop,E=A+I,j=C<=A&&E<=w,H=p.current<i.index;j||(E<=P?a.current.scrollTo({top:0}):H?a.current.scrollTo({top:E-P}):a.current.scrollTo({top:A+1})),p.current=i.index},[a,i]),pe(()=>{l||(p.current=-1)},[l]);const y=t.useCallback((f={},v=null)=>({as:"ul",ref:He(a,v),role:"listbox",tabIndex:-1,position:"relative",id:f.id??o,...f}),[a,o]);return{onAnimationComplete:h,getListProps:y}},Pt=le(({className:o,w:n,width:l,minW:a,minWidth:r,maxW:d,maxWidth:p,contentProps:i,header:h,footer:y,children:f,...v},P)=>{var A,E,j,H,ie,T;const{styles:C}=F(),{onAnimationComplete:w,getListProps:I}=us();return l??(l=n),l??(l=((A=C.list)==null?void 0:A.width)??((E=C.list)==null?void 0:E.w)),r??(r=a),r??(r=((j=C.list)==null?void 0:j.minWidth)??((H=C.list)==null?void 0:H.minW)),p??(p=d),p??(p=((ie=C.list)==null?void 0:ie.maxWidth)??((T=C.list)==null?void 0:T.maxW)),x.jsxs(Wt,{as:"div",className:"ui-autocomplete__popover",width:l,minWidth:r,maxWidth:p,__css:{...C.content,width:l,minWidth:r,maxWidth:p},...i,onAnimationComplete:G(i==null?void 0:i.onAnimationComplete,w),children:[h?x.jsx(D.div,{className:"ui-autocomplete__header",__css:{...C.header},children:h}):null,x.jsx(D.ul,{className:Q("ui-autocomplete__list",o),__css:{...C.list},...I(v,P),children:f}),y?x.jsx(D.div,{className:"ui-autocomplete__footer",__css:{...C.footer},children:y}):null]})});Pt.displayName="AutocompleteList";Pt.__ui__="AutocompleteList";const Be=le(({className:o,icon:n,...l},a)=>{const{styles:r}=F(),{isSelected:d,customIcon:p,children:i,getOptionProps:h}=as(l);n??(n=p);const y={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...r.item};return x.jsxs(D.li,{className:Q("ui-autocomplete__item",o),__css:y,...h({},a),children:[n!==null?x.jsx(Ae,{opacity:d?1:0,children:n||x.jsx(st,{})}):null,x.jsx(D.span,{style:{flex:1},"data-label":!0,children:i})]})});Be.displayName="AutocompleteOption";Be.__ui__="AutocompleteOption";const st=()=>x.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:x.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});st.displayName="CheckIcon";st.__ui__="CheckIcon";const ds=({label:o,...n})=>{const{value:l,omitSelectedValues:a}=F(),r=W(l),d=Qe(),p=d.values(),h=(r&&a?d.values(({node:I})=>l.includes(I.dataset.value??"")):[]).map(({index:I})=>I),f=!p.filter(({node:I,index:A})=>{var E;return((E=I.parentElement)==null?void 0:E.dataset.label)===o&&!h.includes(A)&&"target"in I.dataset}).length,[v,P]=It(n,At),C=t.useCallback((I={},A=null)=>({ref:A,...I,...v,style:f?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0,"data-label":o,role:"autocomplete-group-container"}),[v,f,o]),w=t.useCallback((I={},A=null)=>({ref:A,...I,...P,"data-label":o,role:"autocomplete-group"}),[P,o]);return{label:o,getContainerProps:C,getGroupProps:w}},ot=le(({className:o,color:n,h:l,height:a,minH:r,minHeight:d,children:p,labelProps:i,...h},y)=>{const{styles:f}=F(),{label:v,getContainerProps:P,getGroupProps:C}=ds(h);return l??(l=a),r??(r=d),x.jsxs(D.li,{className:Q("ui-autocomplete__item","ui-autocomplete__item--group",o),__css:{w:"100%",h:"fit-content",color:n},...P(),children:[x.jsx(D.span,{className:"ui-autocomplete__item__group-label",__css:f.groupLabel,lineClamp:1,...i,children:v}),x.jsx(D.ul,{...C({},y),className:"ui-autocomplete__item__group",__css:{h:l,minH:r,...f.group},children:p})]})});ot.displayName="AutocompleteOptionGroup";ot.__ui__="AutocompleteOptionGroup";const yt={ｶﾞ:"ガ",ｷﾞ:"ギ",ｸﾞ:"グ",ｹﾞ:"ゲ",ｺﾞ:"ゴ",ｻﾞ:"ザ",ｼﾞ:"ジ",ｽﾞ:"ズ",ｾﾞ:"ゼ",ｿﾞ:"ゾ",ﾀﾞ:"ダ",ﾁﾞ:"ヂ",ﾂﾞ:"ヅ",ﾃﾞ:"デ",ﾄﾞ:"ド",ﾊﾞ:"バ",ﾋﾞ:"ビ",ﾌﾞ:"ブ",ﾍﾞ:"ベ",ﾎﾞ:"ボ",ﾊﾟ:"パ",ﾋﾟ:"ピ",ﾌﾟ:"プ",ﾍﾟ:"ペ",ﾎﾟ:"ポ",ｳﾞ:"ヴ",ﾜﾞ:"ヷ",ｦﾞ:"ヺ",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｷ:"キ",ｸ:"ク",ｹ:"ケ",ｺ:"コ",ｻ:"サ",ｼ:"シ",ｽ:"ス",ｾ:"セ",ｿ:"ソ",ﾀ:"タ",ﾁ:"チ",ﾂ:"ツ",ﾃ:"テ",ﾄ:"ト",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾋ:"ヒ",ﾌ:"フ",ﾍ:"ヘ",ﾎ:"ホ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ｦ:"ヲ",ﾝ:"ン",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｯ:"ッ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ","｡":"。","､":"、",ｰ:"ー","｢":"「","｣":"」","･":"・"},ps=o=>{o=o.replace(/[！-～]/g,l=>String.fromCharCode(l.charCodeAt(0)-65248));const n=new RegExp("("+Object.keys(yt).join("|")+")","g");return o=o.replace(n,l=>yt[l]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),o=o.toUpperCase(),o},fs=o=>{const n=l=>l.map(a=>{const{isDisabled:r,isFocusable:d}=a;if(!(r&&!d))return"items"in a?n(a.items??[]):a}).filter(Boolean);return n(o).flat(1/0)},js=o=>{const{value:n,defaultValue:l,onChange:a,onCreate:r,onSearch:d,closeOnSelect:p=!0,omitSelectedValues:i=!1,maxSelectValues:h,allowCreate:y=!1,allowFree:f=!1,insertPositionItem:v="first",emptyMessage:P="No results found",format:C=ps,optionProps:w,placeholder:I,onKeyDown:A,isOpen:E,defaultIsOpen:j,onOpen:H,onClose:ie,closeOnBlur:T=!0,closeOnEsc:X=!0,openDelay:me,closeDelay:ke,isLazy:ze,lazyBehavior:Se,animation:xe,duration:Ue=.2,offset:Y,gutter:Ce,preventOverflow:ae,flip:ge,matchWidth:Oe=!0,boundary:be,eventListeners:z,strategy:Pe,placement:we="bottom-start",modifiers:nt,items:he,children:lt,...ce}=ss(o),{"aria-readonly":ms,onFocus:it,...L}=Gt(ce,os),[at,wt]=It(ce,At),{id:jt}=ce,_=ns(),Ge=t.useRef(null),ct=t.useRef(null),Z=t.useRef(null),ee=t.useRef(new Set([])),Je=t.useRef(!1),je=t.useRef(void 0),[te,rt]=t.useState(he?JSON.parse(JSON.stringify(he)):void 0),[k,Ee]=Xt({value:n,defaultValue:l,onChange:a}),[Ke,Ne]=t.useState(void 0),[N,re]=t.useState(""),[J,S]=t.useState(-1),[se,ut]=t.useState(!1),[ue,dt]=t.useState(!0),{isOpen:g,onOpen:pt,onClose:R}=Yt({isOpen:E,defaultIsOpen:j,onOpen:H,onClose:ie}),_e=J>-1,$e=J===-2&&y,b=W(k),Ve=b?!k.length:!k,[ye,ft]=t.useMemo(()=>W(v)?v:[v,"first"],[v]);y&&!_t(lt)&&console.warn(`${b?"MultiAutocomplete":"Autocomplete"}: ${b?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const K=_.enabledValues(({node:e})=>b&&k.includes(e.dataset.value??"")).map(({index:e})=>e),U=_.enabledValues(({node:e,index:s})=>"target"in e.dataset&&!K.includes(s)),Et=vt(lt),De=t.useMemo(()=>te==null?void 0:te.map((e,s)=>{if("value"in e){const{label:c,value:m,...u}=e;return x.jsx(Be,{value:m,...u,children:c},s)}else if("items"in e){const{label:c,items:m=[],...u}=e;return x.jsx(ot,{label:c,...u,children:m.map(({label:O,value:B,...ne},Lt)=>x.jsx(Be,{value:B,...ne,children:O},Lt))},s)}}),[te]),oe=!Et.length&&!(De!=null&&De.length),V=t.useCallback(()=>{L.disabled||L.readOnly||!y&&(oe||se)||(pt(),Z.current&&Z.current.focus())},[y,L,se,oe,pt]),de=t.useCallback(()=>{const e=setTimeout(()=>{if(oe||se)return;const s=_.enabledFirstValue(({node:c})=>"target"in c.dataset);if(s)if(!b||!i)S(s.index);else if(K.includes(s.index)){const c=U[0];S(c.index)}else S(s.index)});ee.current.add(e)},[_,U,se,oe,b,i,K]),Fe=t.useCallback(()=>{const e=setTimeout(()=>{if(oe||se)return;const s=_.enabledLastValue(({node:c})=>"target"in c.dataset);if(s)if(!b||!i)S(s.index);else if(K.includes(s.index)){const c=U.reverse()[0];S(c.index)}else S(s.index)});ee.current.add(e)},[_,U,se,oe,b,i,K]),We=t.useCallback(()=>{const e=setTimeout(()=>{const c=_.enabledValues().find(({node:m})=>b?k.includes(m.dataset.value??""):m.dataset.value===k);c&&S(c.index)});ee.current.add(e)},[_,b,k]),ve=t.useCallback((e=J)=>{const s=setTimeout(()=>{const c=_.enabledNextValue(e,({node:m})=>"target"in m.dataset);if(c)if(!b||!i)S(c.index);else if(K.includes(c.index)){const m=U.find(({index:u})=>c.index<u)??U[0];S(m.index)}else S(c.index)});ee.current.add(s)},[_,U,J,b,i,K]),Xe=t.useCallback((e=J)=>{const s=setTimeout(()=>{const c=_.enabledPrevValue(e,({node:m})=>"target"in m.dataset);if(c)if(!b||!i)S(c.index);else if(K.includes(c.index)){const m=U.reverse().find(({index:u})=>u<c.index)??U[0];S(m.index)}else S(c.index)});ee.current.add(s)},[_,U,J,b,i,K]),q=Ve||i?de:We,mt=Ve||i?Fe:We,Ye=t.useCallback(e=>{const s=_.values();let c=!1,m=!1;s.forEach(({node:u,index:O})=>{if(C(u.textContent??"").includes(e)){c=!0;const B="disabled"in u.dataset;u.dataset.target="",!m&&!B&&(m=!0,S(O))}else delete u.dataset.target}),dt(c)},[_,C]),$=t.useCallback((e=!0)=>{_.values().forEach(({node:c})=>{c.dataset.target=""}),e&&de(),dt(!0)},[_,de]),Re=t.useCallback(e=>{const s=_.enabledValues();return(W(e)?e:[e]).map(u=>{const{node:O}=s.find(({node:B})=>B.dataset.value===u)??{};if(O){const B=Array.from(O.children).find(ne=>ne.getAttribute("data-label")!==null);return(B==null?void 0:B.textContent)??void 0}else return f?u:void 0}).filter(Boolean)},[f,_]),Ie=t.useCallback((e,{forceUpdate:s,runOmit:c=!0}={})=>{const m=Re(e);!s&&!m.length||Ne(u=>b?(m.forEach(O=>{W(u)&&u.includes(O??"")?c&&(u=W(u)?u.filter(ne=>ne!==O):void 0):u=[...W(u)?u:[],O]}),u):m[0])},[Re,b]),M=t.useCallback((e,{forceUpdate:s,runRebirth:c=!0}={})=>{Ee(u=>{let O;return W(u)?u.includes(e)?O=u.filter(ne=>ne!==e):O=[...u,e]:O=e,je.current=O,O});const m=_.values().filter(({node:u})=>C(u.textContent??"").includes(e)).length>0;Ie(e,{forceUpdate:s}),(f||m)&&re(""),b&&c&&$(!1)},[f,b,Ie,$,Ee,_,C]),qe=t.useCallback(()=>{let e=_.value(J);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";M(s),p&&R(),i&&ve()},[p,_,J,i,M,R,ve]),Nt=t.useCallback(e=>{g||V(),d==null||d(e);const s=e.target.value,c=C(s);c?Ye(c):$(),re(s)},[g,V,C,d,Ye,$]),Vt=t.useCallback(()=>{Je.current=!0},[]),Dt=t.useCallback(()=>{Je.current=!1},[]),Me=t.useCallback(()=>{if(!ct.current)return;const e={label:N,value:N};let s=[];if(te&&(s=[...te]),ye==="first")s=[e,...s];else if(ye==="last")s=[...s,e];else{const m=s.findIndex(({label:O})=>O===ye),u=s[m];m!==-1&&"items"in u?(ft==="first"?u.items=[e,...u.items??[]]:u.items=[...u.items??[],e],s[m]=u):console.warn(`${b?"MultiAutocomplete":"Autocomplete"}: '${ye}' specified in insertPositionItem does not exist in the option group.`)}rt(s),M(N),$(!1);const c=fs(s).findIndex(({value:m})=>m===N);S(c),r==null||r(e,s)},[N,te,ye,M,$,r,ft,b]),xt=t.useCallback(()=>{g?Z.current&&Z.current.focus():(V(),q())},[g,q,V]),Te=t.useCallback(()=>{g||(V(),q())},[g,q,V]),Ct=t.useCallback(e=>{const s=Jt(e);Kt(Ge.current,s)||!T&&ue||(f&&N&&M(N,{runRebirth:!1}),re(""),g&&R())},[T,ue,g,N,f,R,M]),gt=t.useCallback(()=>{b?M(k[k.length-1]):M("",{forceUpdate:!0}),g||Te()},[b,g,M,Te,k]),Ft=t.useCallback(e=>{e.stopPropagation(),je.current=[],Ee([]),Ne(void 0),re(""),$(),g&&Z.current&&Z.current.focus()},[g,Ne,re,Ee,$]),bt=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),L.disabled||L.readOnly||Je.current)return;const s=Ke===N||!N.length,m={ArrowDown:_e?()=>ve():g?void 0:Le(V,q),ArrowUp:_e?()=>Xe():g?void 0:Le(V,mt),Space:$e?Me:_e?qe:g?void 0:Le(V,q),Enter:$e?Me:_e?qe:g?f&&b?()=>{N&&M(N),S(0)}:void 0:Le(V,q),Home:g?de:void 0,End:g?Fe:void 0,Escape:X?R:void 0,Backspace:!Ve&&s?gt:void 0}[e.key];m&&(e.preventDefault(),e.stopPropagation(),m(e))},[f,L,Ke,N,V,_e,b,q,ve,mt,Xe,$e,Me,qe,g,de,Fe,X,R,Ve,gt,M]);t.useEffect(()=>{if(!b||!i&&_t(h))return;const e=k.length>0&&k.length===_.count(),s=k.length===h;e||s?(R(),ut(!0)):ut(!1)},[i,k,_,b,R,h]),t.useEffect(()=>{if(b){if(JSON.stringify(je.current??[])===JSON.stringify(k??[]))return;const e=Re(k);Ne(e)}else{if(je.current===k)return;Ie(k,{runOmit:!1})}},[b,k,Ie,Re]),pe(()=>{g||f||(S(-1),re(""))},[g]),pe(()=>{ue||S(-2)},[ue]),pe(()=>{rt(he?JSON.parse(JSON.stringify(he)):void 0)},[he]),$t(()=>{ee.current.forEach(e=>clearTimeout(e)),ee.current.clear()}),qt({ref:Ge,handler:R,enabled:g&&(T||!ue)});const Rt=t.useCallback(e=>({closeOnBlur:T,openDelay:me,closeDelay:ke,isLazy:ze,lazyBehavior:Se,animation:xe,duration:Ue,offset:Y,gutter:Ce,preventOverflow:ae,flip:ge,matchWidth:Oe,boundary:be,eventListeners:z,strategy:Pe,placement:we,modifiers:nt,...e,trigger:"never",closeOnButton:!1,isOpen:g,onOpen:V,onClose:R}),[T,me,ke,ze,Se,xe,Ue,Y,Ce,ae,ge,Oe,be,z,Pe,we,nt,g,V,R]),Mt=t.useCallback((e={},s=null)=>({ref:He(Ge,s),...at,...e,...L,onClick:G(e.onClick,ce.onClick,xt),onBlur:G(e.onBlur,ce.onBlur,Ct)}),[at,L,Ct,xt,ce]),Tt=t.useCallback((e={},s=null)=>({ref:s,tabIndex:-1,...e,...L,placeholder:I,"data-active":fe(g),"aria-expanded":fe(g),onFocus:G(e.onFocus,it,Te),onKeyDown:G(e.onKeyDown,A,bt)}),[L,I,g,it,Te,A,bt]);return{id:jt,descendants:_,value:k,label:Ke,inputValue:N,isHit:ue,isEmpty:oe,computedChildren:De,focusedIndex:J,omitSelectedValues:i,closeOnSelect:p,allowCreate:y,allowFree:f,emptyMessage:P,isOpen:g,isAllSelected:se,listRef:ct,inputRef:Z,optionProps:w,formControlProps:L,setFocusedIndex:S,onChangeLabel:Ie,onChange:M,onSearch:Nt,onCreate:Me,onClear:Ft,onCompositionStart:Vt,onCompositionEnd:Dt,pickOptions:Ye,rebirthOptions:$,onOpen:V,onClose:R,onFocusFirst:de,onFocusLast:Fe,onFocusSelected:We,onFocusNext:ve,onFocusPrev:Xe,getPopoverProps:Rt,getContainerProps:Mt,getFieldProps:Tt,inputProps:wt}},Es=()=>{const{id:o,inputRef:n,onSearch:l,onCompositionStart:a,onCompositionEnd:r,isAllSelected:d,formControlProps:p,inputProps:i,isOpen:h,focusedIndex:y,listRef:f}=F(),{value:v}=Qe();return pe(()=>{d&&n.current&&n.current.blur()},[d]),{getInputProps:t.useCallback((C={},w=null)=>{var I,A;return{ref:He(n,w),...p,role:"combobox","aria-haspopup":"listbox","aria-autocomplete":"list","aria-expanded":h,"aria-activedescendant":(I=v(y))==null?void 0:I.node.id,"aria-controls":(A=f.current)==null?void 0:A.id,autoCapitalize:"none",autoComplete:"off",spellCheck:"false",...i,...C,id:o,cursor:p.readOnly?"default":"text",pointerEvents:p.disabled||d?"none":"auto",tabIndex:d?-1:0,onChange:G(C.onChange,l),onCompositionStart:G(C.onCompositionStart,i.onCompositionStart,a),onCompositionEnd:G(C.onCompositionEnd,i.onCompositionEnd,r)}},[f,y,h,i,n,p,o,d,v,l,a,r])}};export{Ps as A,ws as a,Ze as b,Pt as c,St as d,Ot as e,F as f,Es as g,Be as h,ot as i,kt as j,js as u};
