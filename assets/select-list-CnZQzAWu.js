import{j as g}from"./extends-CwFRzn3r.js";import{r as n}from"./index-BwDkhjyp.js";import{f as ne}from"./forward-ref-BWI-Phbn.js";import{l as $e,T as qe,S as Me,a4 as He,Y as We,s as K,ag as Je,U as Qe,q as Xe,f as Ze,R as et,a as xe,h as se,d as be,x as Pe,am as tt,V as me,b as N,c as Q,t as st,j as nt}from"./factory-BjF4_dRw.js";import{u as ot}from"./index-BjUO4q1E.js";import{c as lt,a as ct}from"./icon-Dq9f0XvE.js";import{u as at}from"./index-BaNhddRa.js";import{c as it}from"./index-Dy1RW4Oq.js";import{u as rt}from"./index-BM_Ccg1d.js";import{u as ut}from"./index-CWXuA_sE.js";import{u as dt,f as ft}from"./form-control-wNB_sh9j.js";import{b as pt}from"./popover-content-Brt-pbKo.js";const mt=c=>{var o;return tt(c)&&!!((o=c==null?void 0:c.getAttribute("role"))!=null&&o.startsWith("option"))},{DescendantsContextProvider:At,useDescendantsContext:Ue,useDescendants:xt,useDescendant:bt}=it(),[Lt,H]=$e({strict:!1,name:"SelectContext"}),Nt=c=>{const{placeholder:o,closeOnSelect:l=!0,placeholderInOptions:u=!0,omitSelectedValues:s=!1,maxSelectValues:a,isEmpty:i,value:O,defaultValue:k,onChange:v,optionProps:x,isOpen:P,defaultIsOpen:j,onOpen:p,onClose:T,closeOnBlur:r=!0,closeOnEsc:d=!0,openDelay:I,closeDelay:R,isLazy:z,lazyBehavior:_,animation:$,duration:oe=.2,offset:le,gutter:U,preventOverflow:X,flip:ce,matchWidth:he=!0,boundary:ae,eventListeners:q,strategy:Ce,placement:B="bottom-start",modifiers:W,...V}=dt(c),{"aria-readonly":Ie,...b}=qe(V,ft),[ie,je]=Me(We(V,["aria-readonly"]),He),m=xt(),[A,S]=n.useState(-1),[De,Fe]=n.useState(!1),re=n.useRef(null),we=n.useRef(null),Ee=n.useRef(null),Y=n.useRef(new Set([])),[F,ue]=at({value:O,defaultValue:k,onChange:v}),[J,ve]=n.useState(void 0),Z=A>-1,h=K(F),Ve=(h?!F.length:!F)&&!(o&&u),M=m.values(({node:e})=>h&&F.includes(e.dataset.value??"")).map(({index:e})=>e),L=m.enabledValues(({index:e})=>!M.includes(e)),de=n.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledFirstValue();if(t)if(!h||!s)S(t.index);else if(M.includes(t.index)){const C=L[0];S(C.index)}else S(t.index)});Y.current.add(e)},[m,L,h,s,M]),fe=n.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledLastValue();if(t)if(!h||!s)S(t.index);else if(M.includes(t.index)){const C=L.reverse()[0];S(C.index)}else S(t.index)});Y.current.add(e)},[m,L,h,s,M]),ge=n.useCallback(()=>{const e=setTimeout(()=>{const C=m.enabledValues().find(({node:D})=>h?F.includes(D.dataset.value??""):D.dataset.value===F);C&&S(C.index)});Y.current.add(e)},[m,h,F]),ee=n.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledNextValue(A);if(t)if(!h||!s)S(t.index);else if(M.includes(t.index)){const C=L.find(({index:D})=>t.index<D)??L[0];S(C.index)}else S(t.index)});Y.current.add(e)},[m,L,A,h,s,M,S]),Se=n.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledPrevValue(A);if(t)if(!h||!s)S(t.index);else if(M.includes(t.index)){const C=L.reverse().find(({index:D})=>D<t.index)??L[0];S(C.index)}else S(t.index)});Y.current.add(e)},[m,L,A,h,s,M,S]),G=Ve||s?de:ge,Te=Ve||s?fe:ge,_e=n.useCallback((e,t=!0)=>{const C=m.values();if(!C.length)return;const D=C.filter(({node:y})=>y.dataset.value===e).map(({node:y,index:te})=>{if(!(o&&u)||te!==0){const pe=Array.from(y.children).find(ke=>ke.getAttribute("data-label")!==null);return(pe==null?void 0:pe.innerHTML)??""}else return});ve(y=>h?(D.forEach(te=>{K(y)&&y.includes(te??"")?t&&(y=K(y)?y.filter(ke=>ke!==te):void 0):y=[...K(y)?y:[],te]}),y):D[0])},[m,h,o,u]),ye=n.useCallback(e=>{ue(t=>K(t)?t.includes(e)?t.filter(D=>D!==e):[...t,e]:e),_e(e)},[_e,ue]),Ge=n.useCallback(e=>{e.stopPropagation(),ue([]),ve(void 0)},[ve,ue]),{isOpen:f,onOpen:Re,onClose:w}=rt({isOpen:P,defaultIsOpen:j,onOpen:p,onClose:T}),E=n.useCallback(()=>{b.disabled||b.readOnly||i||De||Re()},[b,i,De,Re]),Oe=n.useCallback(()=>{let e=m.value(A);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";ye(t),l&&w(),s&&ee()},[l,m,A,s,ye,w,ee]),Ae=n.useCallback(()=>{f||(E(),G())},[f,G,E]),Le=n.useCallback(()=>{f||(E(),G())},[f,G,E]),Ne=n.useCallback(e=>{const t=Je(e);Qe(re.current,t)||r&&f&&w()},[r,f,w]),Be=n.useCallback(e=>{if(e.key===" "&&(e.key=e.code),b.disabled||b.readOnly)return;const C={ArrowDown:Z?()=>ee():f?void 0:me(E,G),ArrowUp:Z?()=>Se():f?void 0:me(E,Te),Space:Z?Oe:f?void 0:me(E,G),Enter:Z?Oe:f?void 0:me(E,G),Home:f?de:void 0,End:f?fe:void 0,Escape:d?w:void 0}[e.key];C&&(e.preventDefault(),e.stopPropagation(),C())},[b.disabled,b.readOnly,Z,f,E,G,Te,Oe,de,fe,d,w,ee,Se]);ut({ref:re,handler:w,enabled:f&&r}),n.useEffect(()=>{if(!h||!s&&Xe(a))return;const e=F.length>0&&F.length===m.count(),t=F.length===a;e||t?(w(),Fe(!0)):Fe(!1)},[s,F,m,h,w,a]),Ze(()=>{f||S(-1)},[f]),et(()=>{Y.current.forEach(e=>clearTimeout(e)),Y.current.clear()});const Ke=n.useCallback(e=>({closeOnBlur:r,openDelay:I,closeDelay:R,isLazy:z,lazyBehavior:_,animation:$,duration:oe,offset:le,gutter:U,preventOverflow:X,flip:ce,matchWidth:he,boundary:ae,eventListeners:q,strategy:Ce,placement:B,modifiers:W,...e,trigger:"never",closeOnButton:!1,isOpen:f,onOpen:E,onClose:w}),[r,I,R,z,_,$,oe,le,U,X,ce,he,ae,q,Ce,B,W,f,E,w]),ze=n.useCallback((e={},t=null)=>({ref:xe(re,t),...ie,...e,...b,onClick:se(e.onClick,V.onClick,Ae),onBlur:se(e.onBlur,V.onBlur,Ne)}),[ie,b,Ne,Ae,V]),Ye=n.useCallback(({"aria-label":e,...t}={},C=null)=>{var D,y;return e??(e=o??`Select ${h?"one or more options.":"an option."}`),{"aria-label":e,role:"combobox",ref:xe(we,C),tabIndex:0,...je,...t,"data-active":be(f),"data-placeholder":be(h?!(J!=null&&J.length):J===void 0),"aria-controls":(D=Ee.current)==null?void 0:D.id,"aria-activedescendant":(y=m.value(A))==null?void 0:y.node.id,"aria-expanded":f,onFocus:se(t.onFocus,V.onFocus,Le),onKeyDown:se(t.onKeyDown,V.onKeyDown,Be)}},[m,je,A,f,h,J,o,V,Le,Be]);return{descendants:m,value:F,label:J,focusedIndex:A,placeholder:o,placeholderInOptions:u,omitSelectedValues:s,closeOnSelect:l,isOpen:f,containerRef:re,fieldRef:we,listRef:Ee,optionProps:x,formControlProps:b,onChangeLabel:_e,onChange:ye,onClear:Ge,onOpen:E,onClose:w,onFocusFirst:de,onFocusLast:fe,onFocusSelected:ge,onFocusNext:ee,onFocusPrev:Se,setFocusedIndex:S,getPopoverProps:Ke,getContainerProps:ze,getFieldProps:Ye}},ht=()=>{const{value:c,listRef:o,focusedIndex:l}=H(),u=Ue(),s=n.useRef(-1),a=u.value(l),i=K(c);n.useEffect(()=>{if(!o.current||!a||s.current===a.index)return;const v=o.current,x=a.node,P=v.clientHeight,j=v.scrollTop,p=j+P,T=x.clientHeight,r=x.offsetTop,d=r+T,I=j<=r&&d<=p,R=s.current<a.index;I||(d<=P?o.current.scrollTo({top:0}):R?o.current.scrollTo({top:d-P}):o.current.scrollTo({top:r+1})),s.current=a.index},[o,a]);const O=n.useId();return{getListProps:n.useCallback((v={},x=null)=>({id:O,ref:xe(o,x),role:"listbox","aria-multiselectable":Pe(i),tabIndex:-1,position:"relative",...v}),[O,i,o])}},Ct=({label:c,...o})=>{const{value:l,omitSelectedValues:u}=H(),s=K(l),a=Ue(),i=a.values(),k=(s&&u?a.values(({node:r})=>l.includes(r.dataset.value??"")):[]).map(({index:r})=>r),x=!i.filter(({node:r,index:d})=>{var I;return((I=r.parentElement)==null?void 0:I.dataset.label)===c&&!k.includes(d)}).length,[P,j]=Me(o,He),p=n.useCallback((r={},d=null)=>({ref:d,...r,...P,style:x?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[P,x]),T=n.useCallback(({"aria-label":r,...d}={},I=null)=>(r??(r=c),{"aria-label":r,ref:I,role:"group",...d,...j,"data-label":c}),[j,c]);return{label:c,getContainerProps:p,getGroupProps:T}},vt=(c,o)=>{const{fieldRef:l,value:u,placeholder:s,placeholderInOptions:a,omitSelectedValues:i,closeOnSelect:O,focusedIndex:k,optionProps:v,onChange:x,onChangeLabel:P,onFocusNext:j,onClose:p,setFocusedIndex:T}=H();let{icon:r,isDisabled:d,isFocusable:I,closeOnSelect:R,children:z,value:_,...$}={...v,...o};const oe=!!d&&!I,le=n.useRef(null),{index:U,register:X,descendants:ce}=bt({disabled:oe}),ae=ce.values().slice(0,U),q=K(u),B=!(q?!1:ae.some(({node:b})=>b.dataset.value===(_??"")))&&(q?u.includes(_??""):(_??"")===u),W=U===k;s&&U>0&&a&&!_&&console.warn(`${q?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const V=n.useCallback(b=>{if(b.preventDefault(),b.stopPropagation(),d){l.current&&l.current.focus();return}if(!mt(b.currentTarget)){l.current&&l.current.focus();return}T(U),x(_??""),l.current&&l.current.focus(),(R??O)&&p(),i&&j()},[d,T,U,x,_,l,R,O,p,i,j]);n.useEffect(()=>{B&&P(_??"",!1)},[_,B,P]);const Ie=n.useCallback((b={})=>{const ie={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{role:"option",ref:xe(le,c,X),...$,...b,tabIndex:-1,style:i&&B?ie:void 0,"data-value":_??"","data-focus":be(W),"data-disabled":be(d),"aria-checked":Pe(B),"aria-disabled":Pe(d),onClick:se($.onClick,b.onClick,V)}},[_,$,d,W,B,i,V,c,X]);return{isSelected:B,isFocused:W,customIcon:r,children:z,getOptionProps:Ie}},Bt=ne(({id:c,className:o,icon:l,...u},s)=>{const{styles:a}=H(),{isSelected:i,customIcon:O,children:k,getOptionProps:v}=vt(s,u);c??(c=n.useId()),l??(l=O);const x={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...a.item};return g.jsxs(N.li,{id:c,className:Q("ui-select__item",o),__css:x,...v(),children:[l!==null?g.jsx(gt,{opacity:i?1:0,children:l||g.jsx(St,{})}):null,g.jsx(N.span,{style:{flex:1},"data-label":!0,children:k})]})}),gt=ne(({className:c,...o},l)=>{const{styles:u}=H(),s={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...u.itemIcon};return g.jsx(N.span,{ref:l,className:Q("ui-select__item__icon",c),__css:s,...o})}),St=()=>g.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:g.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Mt=ne(({className:c,color:o,h:l,height:u,minH:s,minHeight:a,children:i,labelProps:O,...k},v)=>{const{styles:x}=H(),{label:P,getContainerProps:j,getGroupProps:p}=Ct(k);return l??(l=u),s??(s=a),g.jsxs(N.li,{className:Q("ui-select__item","ui-select__item--group",c),__css:{w:"100%",h:"fit-content",color:o},...j(),children:[g.jsx(N.span,{className:"ui-select__item__group-label",__css:x.groupLabel,lineClamp:1,...O,children:P}),g.jsx(N.ul,{...p({},v),className:"ui-select__item__group",__css:{h:l,minH:s,...x.group},children:i})]})}),_t=ne(({className:c,children:o,__css:l,...u},s)=>{const{styles:a}=H(),i={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...a.icon,...l},k=st(o).map(v=>n.cloneElement(v,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return g.jsx(N.div,{ref:s,className:Q("ui-select__icon",c),__css:i,...u,children:nt(o)?k:g.jsx(lt,{})})}),Ht=({className:c,children:o,...l})=>{const u=n.useRef(null),{styles:s}=H(),a=l.disabled,i=ot({ref:u,isDisabled:a,...l});return g.jsx(_t,{"aria-label":"Clear value",className:Q("ui-select__clear-icon",c),__css:s.clearIcon,...i,children:o??g.jsx(ct,{w:"0.5em",h:"0.5em"})})},Ut=ne(({className:c,w:o,width:l,minW:u,minWidth:s,maxW:a,maxWidth:i,contentProps:O,header:k,footer:v,children:x,...P},j)=>{var r,d,I,R,z,_;const{styles:p}=H(),{getListProps:T}=ht();return l??(l=o),l??(l=((r=p.list)==null?void 0:r.width)??((d=p.list)==null?void 0:d.w)),s??(s=u),s??(s=((I=p.list)==null?void 0:I.minWidth)??((R=p.list)==null?void 0:R.minW)),i??(i=a),i??(i=((z=p.list)==null?void 0:z.maxWidth)??((_=p.list)==null?void 0:_.maxW)),g.jsxs(pt,{as:"div",className:"ui-select__content",width:l,minWidth:s,maxWidth:i,__css:{...p.content,width:l,minWidth:s,maxWidth:i},...O,children:[k?g.jsx(N.div,{className:"ui-select__header",__css:{...p.header},children:k}):null,g.jsx(N.ul,{className:Q("ui-select__list",c),__css:{...p.list},...T(P,j),children:x}),v?g.jsx(N.div,{className:"ui-select__footer",__css:{...p.footer},children:v}):null]})});export{Bt as O,At as S,Mt as a,Lt as b,_t as c,Ut as d,H as e,Ht as f,Nt as u};
