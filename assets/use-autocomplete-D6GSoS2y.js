import{j as d}from"./jsx-runtime-CfatFE5O.js";import{f as ue}from"./forward-ref-D13m8o2p.js";import{A as Gt,g as At,b as N,c as ee,p as Jt,J as Be,a0 as Kt,o as Ut,a as ke,C as Ie,d as Ce,h as W,au as Wt,P as re,I as vt,n as Ae,L as It,af as kt,a2 as $t,aq as qt,a3 as Yt,u as Qt,a1 as Xt,a4 as Te}from"./factory-Bqmz9C5P.js";import{r as t}from"./index-ClcD9ViR.js";import{b as Zt}from"./popover-trigger-CaVm9NYE.js";import{u as eo}from"./index-D-iNr3rb.js";import{u as to}from"./index-DcJSUYRC.js";import{u as oo}from"./index-D0QjGqiR.js";import{c as so}from"./index-CieLuCnG.js";import{u as no}from"./index-DxQD85Cv.js";import{c as lo,a as ao}from"./icon-DeZ7GCXS.js";import{u as co,f as io}from"./form-control-DNngTyAT.js";const{DescendantsContextProvider:Do,useDescendant:ro,useDescendants:uo,useDescendantsContext:Pt}=so(),[Ro,V]=Gt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),tt=ue(({className:n,children:o,__css:l,...c},u)=>{const{styles:i}=V(),p={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...i.icon,...l},C=At(o).map(y=>t.cloneElement(y,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return d.jsx(N.div,{ref:u,className:ee("ui-autocomplete__icon",n),__css:p,...c,children:Jt(o)?C:d.jsx(lo,{})})});tt.displayName="AutocompleteIcon";tt.__ui__="AutocompleteIcon";const St=({className:n,children:o,...l})=>{const c=t.useRef(null),{styles:u}=V(),i=no({ref:c,...l});return d.jsx(tt,{className:ee("ui-autocomplete__icon--clear",n),"aria-label":"Clear value",__css:u.clearIcon,...i,children:o??d.jsx(ao,{h:"0.5em",w:"0.5em"})})};St.displayName="AutocompleteClearIcon";St.__ui__="AutocompleteClearIcon";const Pe=ue(({className:n,...o},l)=>{const{styles:c}=V(),u={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...c.itemIcon};return d.jsx(N.span,{ref:l,className:ee("ui-autocomplete__item__icon",n),__css:u,...o})});Pe.displayName="AutocompleteItemIcon";Pe.__ui__="AutocompleteItemIcon";const po=n=>{var o;return Wt(n)&&!!((o=n.getAttribute("role"))!=null&&o.startsWith("option"))},mo=n=>{var je;const{closeOnSelect:o,focusedIndex:l,inputRef:c,omitSelectedValues:u,setFocusedIndex:i,value:p,optionProps:m,onChange:C,onClose:y,onFocusNext:D}=V(),G=t.useId(),A=t.useRef(null),{id:f=G,children:P,closeOnSelect:L,isDisabled:H,disabled:S=H,isFocusable:b,focusable:v=b,icon:O,value:R,...$}={...m,...n},Se=!!S&&!v,{descendants:we,index:Q,register:de}=ro({disabled:Se}),Oe=we.values().slice(0,Q),I=re(p),he="target"in(((je=A.current)==null?void 0:je.dataset)??{}),pe=Q===l,J=t.useMemo(()=>{let M=R;return Be(R)&&(Kt(P)||Ut(P)?M=P.toString():console.warn(`${I?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),M??""},[P,I,R]),X=Oe.some(({node:M})=>M.dataset.value===J),te=!X&&(I?p.includes(J):J===p),ge=t.useCallback(M=>{if(M.stopPropagation(),S||!po(M.currentTarget)){c.current&&c.current.focus();return}X||i(Q),C(J),c.current&&c.current.focus(),(L??o)&&y(),u&&D(Q)},[X,D,u,S,J,i,Q,C,L,o,y,c]),Ge=t.useCallback((M={},Je=null)=>{const oe=!he||u&&te,Ee={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ke(A,Je,de),role:"option",...$,...M,id:f,style:oe?Ee:void 0,"aria-disabled":Ie(S),"aria-hidden":Ie(oe),"aria-selected":te,"data-disabled":Ce(S),"data-duplicated":Ce(X),"data-focus":Ce(pe),"data-target":Ce(!0),"data-value":J,tabIndex:-1,onClick:W($.onClick,M.onClick,ge)}},[f,X,J,$,S,pe,te,he,u,ge,de]);return{target:he,children:P,customIcon:O,focused:pe,omitSelectedValues:u,selected:te,getOptionProps:Ge}},fo=()=>{const{hit:n,onCreate:o}=V();return{getCreateProps:t.useCallback((c={},u=null)=>({ref:u,role:"option",...c,style:n?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":Ie(n),"data-focus":Ce(!n),tabIndex:-1,onClick:W(c.onClick,o)}),[n,o])}},xo=()=>{const{empty:n,hit:o}=V();return{getEmptyProps:t.useCallback((c={},u=null)=>{const i=o&&!n;return{ref:u,role:"presentation",...c,style:i?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":Ie(i),tabIndex:-1}},[o,n])}},wt=ue(({className:n,children:o,icon:l,...c},u)=>{const{inputValue:i,styles:p}=V(),{getCreateProps:m}=fo();o??(o=i);const C={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...p.item};return d.jsxs(N.div,{className:ee("ui-autocomplete__item--create",n),__css:C,...m(c,u),children:[l!==null?d.jsx(Pe,{children:l||d.jsx(ot,{})}):null,l?d.jsx(N.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:vt(o,i)}):vt(o,i)]})});wt.displayName="AutocompleteCreate";wt.__ui__="AutocompleteCreate";const ot=()=>d.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:d.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});ot.displayName="AutocompletePlusIcon";ot.__ui__="AutocompletePlusIcon";const Ot=ue(({className:n,children:o,icon:l,...c},u)=>{const{emptyMessage:i,styles:p}=V(),{getEmptyProps:m}=xo();o??(o=i);const C={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...p.item};return d.jsxs(N.div,{className:ee("ui-autocomplete__item--empty",n),__css:C,...m(c,u),children:[l!==null?d.jsx(Pe,{children:l||d.jsx(st,{})}):null,l?d.jsx(N.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:o}):o]})});Ot.displayName="AutocompleteEmpty";Ot.__ui__="AutocompleteEmpty";const st=()=>d.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:d.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});st.displayName="AutocompleteMinusIcon";st.__ui__="AutocompleteMinusIcon";const Co=()=>{const{focusedIndex:n,open:o,rebirthOptions:l,value:c}=V(),u=Pt(),i=t.useRef(null),p=t.useRef(-1),m=u.value(n),C=re(c),y=t.useCallback(()=>{o||l(!1)},[o,l]);t.useEffect(()=>{if(!i.current||!m||p.current===m.index)return;const A=i.current,f=m.node,P=A.clientHeight,L=A.scrollTop,H=L+P,S=f.clientHeight,b=f.offsetTop,v=b+S,O=L<=b&&v<=H,R=p.current<m.index;O||(v<=P?i.current.scrollTo({top:0}):R?i.current.scrollTo({top:v-P}):i.current.scrollTo({top:b+1})),p.current=m.index},[i,m]),Ae(()=>{o||(p.current=-1)},[o]);const D=t.useCallback((A={},f=null)=>({ref:f,"aria-multiselectable":Ie(C),role:"listbox",...A,onAnimationComplete:W(A.onAnimationComplete,y)}),[C,y]),G=t.useCallback((A={},f=null)=>({ref:ke(i,f),position:"relative",tabIndex:-1,...A}),[i]);return{getContainerProps:D,getListProps:G}},jt=ue(({className:n,children:o,footer:l,header:c,maxW:u,maxWidth:i=u,minW:p,minWidth:m=p,w:C,width:y=C,contentProps:D,...G},A)=>{var H,S,b,v,O,R;const{styles:f}=V(),{getContainerProps:P,getListProps:L}=Co();return y??(y=((H=f.list)==null?void 0:H.width)??((S=f.list)==null?void 0:S.w)),m??(m=((b=f.list)==null?void 0:b.minWidth)??((v=f.list)==null?void 0:v.minW)),i??(i=((O=f.list)==null?void 0:O.maxWidth)??((R=f.list)==null?void 0:R.maxW)),d.jsxs(Zt,{as:"div",className:"ui-autocomplete__popover",maxWidth:i,minWidth:m,width:y,__css:f.content,...P(D),children:[c?d.jsx(N.header,{className:"ui-autocomplete__header",__css:f.header,children:c}):null,d.jsx(N.div,{className:ee("ui-autocomplete__list",n),__css:f.list,...L(G,A),children:o}),l?d.jsx(N.footer,{className:"ui-autocomplete__footer",__css:f.footer,children:l}):null]})});jt.displayName="AutocompleteList";jt.__ui__="AutocompleteList";const He=ue(({className:n,icon:o,...l},c)=>{const{styles:u}=V(),{children:i,customIcon:p,selected:m,getOptionProps:C}=mo(l);o??(o=p);const y={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...u.item};return d.jsxs(N.div,{className:ee("ui-autocomplete__item",n),__css:y,...C({},c),children:[o!==null?d.jsx(Pe,{opacity:m?1:0,children:o||d.jsx(nt,{})}):null,d.jsx(N.span,{style:{flex:1},"data-label":!0,children:i})]})});He.displayName="AutocompleteOption";He.__ui__="AutocompleteOption";const nt=()=>d.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:d.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});nt.displayName="AutocompleteCheckIcon";nt.__ui__="AutocompleteCheckIcon";const ho=({label:n,...o})=>{const{omitSelectedValues:l,value:c}=V(),u=Pt(),i=t.useRef(null),p=t.useId(),m=u.values(),D=(re(c)&&l?u.values(({node:b})=>c.includes(b.dataset.value??"")):[]).map(({index:b})=>b),A=!m.filter(({index:b,node:v})=>{var O;return((O=v.parentElement)==null?void 0:O.dataset.label)===n&&!D.includes(b)&&"target"in v.dataset}).length,[f,P]=It(o,kt),L=t.useCallback((b={},v=null)=>{var R;const O={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:v,"aria-labelledby":(R=i.current)==null?void 0:R.id,role:"group",...b,...f,style:A?O:void 0}},[f,A]),H=t.useCallback(({id:b,...v}={},O=null)=>({id:b??p,ref:ke(O,i),role:"presentation",...v}),[p]),S=t.useCallback((b={},v=null)=>({ref:v,...b,...P,"data-label":n}),[P,n]);return{label:n,getContainerProps:L,getGroupProps:S,getLabelProps:H}},lt=ue(({className:n,children:o,color:l,h:c,height:u=c,minH:i,minHeight:p=i,labelProps:m,...C},y)=>{const{styles:D}=V(),{label:G,getContainerProps:A,getGroupProps:f,getLabelProps:P}=ho(C);return d.jsxs(N.section,{className:ee("ui-autocomplete__item","ui-autocomplete__item--group",n),__css:{color:l,h:"fit-content",w:"100%"},...A(),children:[d.jsx(N.header,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:D.groupLabel,...P(m),children:G}),d.jsx(N.div,{...f({},y),className:"ui-autocomplete__item__group",height:u,minHeight:p,__css:D.group,children:o})]})});lt.displayName="AutocompleteOptionGroup";lt.__ui__="AutocompleteOptionGroup";const yt={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},go=n=>{n=n.replace(/[！-～]/g,l=>String.fromCharCode(l.charCodeAt(0)-65248));const o=new RegExp("("+Object.keys(yt).join("|")+")","g");return n=n.replace(o,l=>yt[l]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),n=n.toUpperCase(),n},bo=n=>{const o=l=>l.map(c=>{const{disabled:u,focusable:i}=c;if(!(u&&!i))return"items"in c?o(c.items??[]):c}).filter(Boolean);return o(n).flat(1/0)},Fo=n=>{var _t;const{allowCreate:o=!1,allowFree:l=!1,animation:c,boundary:u,children:i,closeDelay:p,closeOnBlur:m=!0,closeOnEsc:C=!0,closeOnSelect:y=!0,defaultIsOpen:D,defaultOpen:G,defaultValue:A,duration:f=.2,emptyMessage:P="No results found",eventListeners:L,flip:H,format:S=go,gutter:b,insertPositionItem:v="first",isLazy:O,isOpen:R,items:$,lazy:Se,lazyBehavior:we,matchWidth:Q=!0,maxSelectValues:de,modifiers:ze,offset:Oe,omitSelectedValues:I=!1,open:he,openDelay:pe,placeholder:J,placement:X="bottom-start",preventOverflow:te,strategy:ge,value:Ge,optionProps:je,onChange:M,onClose:Je,onCreate:oe,onKeyDown:Ee,onOpen:Et,onSearch:Ne,...be}=co(n),g=uo(),Ke=t.useRef(null),se=t.useRef(null),ne=t.useRef(new Set([])),Ue=t.useRef(!1),at=t.useRef(void 0),[le,ct]=t.useState($?JSON.parse(JSON.stringify($)):void 0),[w,Ve]=eo({defaultValue:A,value:Ge,onChange:M}),[We,$e]=t.useState(void 0),[j,me]=t.useState(""),[K,k]=t.useState(-1),[ae,it]=t.useState(!1),[fe,rt]=t.useState(!0),{open:x,onClose:T,onOpen:ut}=to({defaultIsOpen:D,defaultOpen:G,isOpen:R,open:he,onClose:Je,onOpen:Et}),{"aria-readonly":_o,onFocus:dt,...z}=$t(be,io),[pt,Nt]=It(be,kt),_e=K>-1,qe=K===-2&&o,h=re(w),De=h?!w.length:!w,[ve,mt]=t.useMemo(()=>re(v)?v:[v,"first"],[v]);o&&!Be(i)&&console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: ${h?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const q=g.enabledValues(({node:e})=>h&&w.includes(e.dataset.value??"")).map(({index:e})=>e),U=g.enabledValues(({index:e,node:s})=>"target"in s.dataset&&!q.includes(e)),ft=(_t=g.value(K))==null?void 0:_t.node.id,Vt=At(i),Re=t.useMemo(()=>le==null?void 0:le.map((e,s)=>{if("value"in e){const{label:a,value:r,..._}=e;return d.jsx(He,{value:r,..._,children:a},s)}else if("items"in e){const{items:a=[],label:r,..._}=e;return d.jsx(lt,{label:r,..._,children:a.map(({label:F,value:ie,...et},zt)=>d.jsx(He,{value:ie,...et,children:F},zt))},s)}}).filter(Boolean),[le]),ce=!Vt.length&&!(Re!=null&&Re.length),E=t.useCallback(()=>{z.disabled||z.readOnly||!o&&(ce||ae)||(ut(),se.current&&se.current.focus())},[o,z,ae,ce,ut]),xe=t.useCallback(()=>{const e=setTimeout(()=>{if(ce||ae)return;const s=g.enabledFirstValue(({node:a})=>"target"in a.dataset);if(s)if(!h||!I)k(s.index);else if(q.includes(s.index)){const a=U[0];k((a==null?void 0:a.index)??-1)}else k(s.index)});ne.current.add(e)},[g,U,ae,ce,h,I,q]),Fe=t.useCallback(()=>{const e=setTimeout(()=>{if(ce||ae)return;const s=g.enabledLastValue(({node:a})=>"target"in a.dataset);if(s)if(!h||!I)k(s.index);else if(q.includes(s.index)){const a=U.reverse()[0];k((a==null?void 0:a.index)??-1)}else k(s.index)});ne.current.add(e)},[g,U,ae,ce,h,I,q]),Ye=t.useCallback(()=>{const e=setTimeout(()=>{const a=g.enabledValues().find(({node:r})=>h?w.includes(r.dataset.value??""):r.dataset.value===w);a&&k(a.index)});ne.current.add(e)},[g,h,w]),ye=t.useCallback((e=K)=>{const s=setTimeout(()=>{const a=g.enabledNextValue(e,({node:r})=>"target"in r.dataset);if(a)if(!h||!I)k(a.index);else if(q.includes(a.index)){const r=U.find(({index:_})=>a.index<_)??U[0];k((r==null?void 0:r.index)??-1)}else k(a.index)});ne.current.add(s)},[g,U,K,h,I,q]),Qe=t.useCallback((e=K)=>{const s=setTimeout(()=>{const a=g.enabledPrevValue(e,({node:r})=>"target"in r.dataset);if(a)if(!h||!I)k(a.index);else if(q.includes(a.index)){const r=U.reverse().find(({index:_})=>_<a.index)??U[0];k((r==null?void 0:r.index)??-1)}else k(a.index)});ne.current.add(s)},[g,U,K,h,I,q]),Z=De||I?xe:Ye,xt=De||I?Fe:Ye,Xe=t.useCallback(e=>{const s=g.values();let a=!1,r=!1;s.forEach(({index:_,node:F})=>{if(S(F.textContent??"").includes(e)){a=!0;const ie="disabled"in F.dataset;F.dataset.target="",!r&&!ie&&(r=!0,k(_))}else delete F.dataset.target}),rt(a)},[g,S]),Y=t.useCallback((e=!0)=>{g.values().forEach(({node:a})=>{a.dataset.target=""}),e&&xe(),rt(!0)},[g,xe]),Dt=t.useCallback(e=>{const s=g.values();if(!s.length)return;const r=(re(e)?e:[e]).map(_=>{const{node:F}=s.find(({node:ie})=>ie.dataset.value===_)??{};if(F){const{textContent:ie}=Array.from(F.children).find(et=>et.getAttribute("data-label")!==null)??{};return ie}else return l?_:void 0}).filter(_=>!Be(_));$e(h?r:r[0])},[l,g,h]),B=t.useCallback((e,s=!0)=>{Ve(a=>{let r;return re(a)?a.includes(e)?r=a.filter(F=>F!==e):r=[...a,e]:r=e,at.current=r,r}),me(""),h&&s&&Y(!1)},[h,Y,Ve]),Ze=t.useCallback(()=>{let e=g.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";B(s),y&&T(),I&&ye()},[y,g,K,I,B,T,ye]),Rt=t.useCallback(e=>{x||E(),Ne==null||Ne(e);const s=e.target.value,a=S(s);a?Xe(a):Y(),me(s)},[x,E,S,Ne,Xe,Y]),Ft=t.useCallback(()=>{Ue.current=!0},[]),Lt=t.useCallback(()=>{Ue.current=!1},[]),Le=t.useCallback(()=>{const e={label:j,value:j};let s=[];if(le&&(s=[...le]),ve==="first")s=[e,...s];else if(ve==="last")s=[...s,e];else{const r=s.findIndex(({label:F})=>F===ve),_=s[r];r!==-1&&_&&"items"in _?(mt==="first"?_.items=[e,..._.items??[]]:_.items=[..._.items??[],e],s[r]=_):console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: '${ve}' specified in insertPositionItem does not exist in the option group.`)}ct(s),B(j),Y(!1);const a=bo(s).findIndex(({value:r})=>r===j);k(a),oe==null||oe(e,s)},[j,le,ve,B,Y,oe,mt,h]),Ct=t.useCallback(()=>{x?se.current&&se.current.focus():(E(),Z())},[x,Z,E]),Me=t.useCallback(()=>{x||(E(),Z())},[x,Z,E]),ht=t.useCallback(e=>{const s=qt(e);Yt(Ke.current,s)||!m&&fe||(l&&j&&B(j,!1),me(""),x&&T())},[m,fe,x,j,l,T,B]),gt=t.useCallback(()=>{B(h?w[w.length-1]:""),x||Me()},[h,x,B,Me,w]),Mt=t.useCallback(e=>{e.stopPropagation(),at.current=[],Ve([]),$e(void 0),me(""),Y(),x&&se.current&&se.current.focus()},[x,$e,me,Ve,Y]),bt=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),z.disabled||z.readOnly||Ue.current)return;const s=We===j||!j.length,r={ArrowDown:_e?()=>ye():x?void 0:Te(E,Z),ArrowUp:_e?()=>Qe():x?void 0:Te(E,xt),Backspace:!De&&s?gt:void 0,End:x?Fe:void 0,Enter:qe?Le:_e?Ze:x?l&&h?()=>{j&&B(j),k(0)}:void 0:Te(E,Z),Escape:C?T:void 0,Home:x?xe:void 0,Space:qe?Le:_e?Ze:x?void 0:Te(E,Z)}[e.key];r&&(e.preventDefault(),e.stopPropagation(),r(e))},[l,z,We,j,E,_e,h,Z,ye,xt,Qe,qe,Le,Ze,x,xe,Fe,C,T,De,gt,B]);t.useEffect(()=>{if(!h||!I&&Be(de))return;const e=w.length>0&&w.length===g.count(),s=w.length===de;e||s?(T(),it(!0)):it(!1)},[I,w,g,h,T,de]),Qt(()=>{Dt(w)},[w]),Ae(()=>{x||l||(k(-1),me(""))},[x]),Ae(()=>{fe||k(-2)},[fe]),Ae(()=>{ct($?JSON.parse(JSON.stringify($)):void 0)},[$]),Xt(()=>{ne.current.forEach(e=>clearTimeout(e)),ne.current.clear()}),oo({ref:Ke,enabled:x&&(m||!fe),handler:T});const Tt=t.useCallback(e=>({animation:c,boundary:u,closeDelay:p,closeOnBlur:m,duration:f,eventListeners:L,flip:H,gutter:b,isLazy:O,lazy:Se,lazyBehavior:we,matchWidth:Q,modifiers:ze,offset:Oe,openDelay:pe,placement:X,preventOverflow:te,strategy:ge,...e,closeOnButton:!1,open:x,trigger:"never",onClose:T,onOpen:E}),[m,pe,p,Se,O,we,c,f,Oe,b,te,H,Q,u,L,ge,X,ze,x,E,T]),Bt=t.useCallback((e={},s=null)=>({ref:ke(Ke,s),...pt,...e,...z,onBlur:W(e.onBlur,be.onBlur,ht),onClick:W(e.onClick,be.onClick,Ct)}),[pt,z,ht,Ct,be]),Ht=t.useCallback((e={},s=null)=>({ref:s,"aria-activedescendant":ft,"aria-autocomplete":"list","aria-haspopup":"listbox",role:"combobox",tabIndex:-1,...e,...z,"data-active":Ce(x),placeholder:J,onFocus:W(e.onFocus,dt,Me),onKeyDown:W(e.onKeyDown,Ee,bt)}),[ft,z,J,x,dt,Me,Ee,bt]);return{allowCreate:o,allowFree:l,allSelected:ae,children:i??Re,closeOnSelect:y,descendants:g,empty:ce,emptyMessage:P,focusedIndex:K,hit:fe,inputRef:se,inputValue:j,label:We,omitSelectedValues:I,open:x,pickOptions:Xe,rebirthOptions:Y,setFocusedIndex:k,value:w,formControlProps:z,getContainerProps:Bt,getFieldProps:Ht,getPopoverProps:Tt,inputProps:Nt,optionProps:je,onChange:B,onClear:Mt,onClose:T,onCompositionEnd:Lt,onCompositionStart:Ft,onCreate:Le,onFocusFirst:xe,onFocusLast:Fe,onFocusNext:ye,onFocusPrev:Qe,onFocusSelected:Ye,onOpen:E,onSearch:Rt}},Lo=()=>{const{allSelected:n,inputRef:o,formControlProps:l,inputProps:c,onCompositionEnd:u,onCompositionStart:i,onSearch:p}=V();return Ae(()=>{n&&o.current&&o.current.blur()},[n]),{getInputProps:t.useCallback((C={},y=null)=>({ref:ke(o,y),...l,autoCapitalize:"none",autoComplete:"off",spellCheck:"false",tabIndex:n?-1:0,...c,...C,cursor:l.readOnly?"default":"text",pointerEvents:l.disabled||n?"none":"auto",onChange:W(C.onChange,p),onCompositionEnd:W(C.onCompositionEnd,c.onCompositionEnd,u),onCompositionStart:W(C.onCompositionStart,c.onCompositionStart,i)}),[c,o,l,n,p,i,u])}};export{Do as A,Ro as a,tt as b,jt as c,wt as d,Ot as e,V as f,Lo as g,He as h,lt as i,St as j,Fo as u};
