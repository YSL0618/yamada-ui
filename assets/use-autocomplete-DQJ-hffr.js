import{j as C}from"./extends-CwFRzn3r.js";import{f as oe}from"./forward-ref-BWI-Phbn.js";import{l as Et,t as gt,b as D,c as Y,j as Vt,f as de,a as Me,d as pe,x as Dt,h as z,am as Ft,s as $,B as ft,S as bt,a4 as ht,T as Rt,q as mt,ag as Nt,U as Tt,R as Mt,V as Te}from"./factory-CPqzzHTm.js";import{r as t}from"./index-BwDkhjyp.js";import{b as Bt}from"./popover-content-DU7dP830.js";import{u as Lt}from"./index-DWlkt5Zz.js";import{u as Ht}from"./index-C_k6bTeh.js";import{u as Ut}from"./index-Bo59xzDQ.js";import{c as zt}from"./index-BqvrmGIG.js";import{u as Jt}from"./index-BEfMoi0_.js";import{c as Kt,a as Gt}from"./icon-DRhEyT4F.js";import{u as $t,f as qt}from"./form-control-Jh-MfcNu.js";const{DescendantsContextProvider:Ss,useDescendantsContext:We,useDescendants:Wt,useDescendant:Yt}=zt(),[ks,F]=Et({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),Qt=oe(({className:l,children:n,__css:o,...d},r)=>{const{styles:a}=F(),p={position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",cursor:"pointer",...a.icon,...o},v=gt(n).map(h=>t.cloneElement(h,{focusable:!1,"aria-hidden":!0,style:{maxWidth:"1em",maxHeight:"1em",color:"currentColor"}}));return C.jsx(D.div,{ref:r,className:Y("ui-autocomplete__icon",l),__css:p,...d,children:Vt(n)?v:C.jsx(Kt,{})})}),As=({className:l,children:n,...o})=>{const d=t.useRef(null),{styles:r}=F(),a=o.disabled,p=Jt({ref:d,isDisabled:a,...o});return C.jsx(Qt,{"aria-label":"Clear value",className:Y("ui-autocomplete__icon--clear",l),__css:r.clearIcon,...p,children:n??C.jsx(Gt,{w:"0.5em",h:"0.5em"})})},Ye=oe(({className:l,...n},o)=>{const{styles:d}=F(),r={flexShrink:0,display:"inline-flex",justifyContent:"center",alignItems:"center",fontSize:"0.85em",...d.itemIcon};return C.jsx(D.span,{ref:o,className:Y("ui-autocomplete__item__icon",l),__css:r,...n})}),Xt=l=>{var n;return Ft(l)&&!!((n=l==null?void 0:l.getAttribute("role"))!=null&&n.startsWith("option"))},Zt=l=>{var ge;const{value:n,omitSelectedValues:o,onChange:d,onChangeLabel:r,focusedIndex:a,setFocusedIndex:p,onClose:c,closeOnSelect:v,optionProps:h,inputRef:f,onFocusNext:_}=F();let{icon:w,isDisabled:m,isFocusable:T,closeOnSelect:y,children:S,value:k,...L}={...h,...l};const le=!!m&&!T,Q=t.useRef(null),{index:j,register:fe,descendants:_e}=Yt({disabled:le}),Se=_e.values().slice(0,j),me=$(n),q=!(me?!1:Se.some(({node:H})=>H.dataset.value===(k??"")))&&(me?n.includes(k??""):(k??"")===n),xe="target"in(((ge=Q.current)==null?void 0:ge.dataset)??{}),ie=j===a,Ce=t.useCallback(H=>{if(H.stopPropagation(),m){f.current&&f.current.focus();return}if(!Xt(H.currentTarget)){f.current&&f.current.focus();return}p(j),d(k??""),f.current&&f.current.focus(),(y??v)&&c(),o&&_(j)},[_,o,m,k,p,j,d,y,v,c,f]);de(()=>{q&&r(k??"",{runOmit:!1})},[k]);const ke=t.useCallback((H={},Ae=null)=>{const Oe={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};return{ref:Me(Q,Ae,fe),id:t.useId(),role:"option",...L,...H,tabIndex:-1,style:!xe||o&&q?Oe:void 0,"data-target":pe(!0),"data-value":k??"","data-focus":pe(ie),"data-disabled":pe(m),"aria-checked":q,"aria-disabled":Dt(m),onClick:z(L.onClick,H.onClick,Ce)}},[k,L,m,ie,q,xe,o,Ce,fe]);return{isSelected:q,isFocused:ie,customIcon:w,children:S,getOptionProps:ke}},es=()=>{const{isHit:l,onCreate:n}=F();return{getCreateProps:t.useCallback((d={},r=null)=>({ref:r,...d,tabIndex:-1,style:l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0,"data-focus":pe(!l),onClick:z(d.onClick,n)}),[l,n])}},ts=()=>{const{isHit:l,isEmpty:n}=F();return{getEmptyProps:t.useCallback((d={},r=null)=>({ref:r,...d,tabIndex:-1,style:l&&!n?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0}),[l,n])}},Os=oe(({className:l,icon:n,children:o,...d},r)=>{const{inputValue:a,styles:p}=F(),{getCreateProps:c}=es();o??(o=a);const v={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...p.item};return C.jsxs(D.li,{className:Y("ui-autocomplete__item--create",l),__css:v,...c(d,r),children:[n!==null?C.jsx(Ye,{children:n||C.jsx(ss,{})}):null,n?C.jsx(D.span,{style:{pointerEvents:"none",flex:1},lineClamp:1,children:ft(o,a)}):ft(o,a)]})}),ss=()=>C.jsx("svg",{viewBox:"0 0 45.402 45.402",width:"1em",height:"1em",children:C.jsx("path",{fill:"currentColor",d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"})}),Ps=oe(({className:l,icon:n,children:o,...d},r)=>{const{emptyMessage:a,styles:p}=F(),{getEmptyProps:c}=ts();o??(o=a);const v={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",pointerEvents:"none",...p.item};return C.jsxs(D.li,{className:Y("ui-autocomplete__item--empty",l),__css:v,...c(d,r),children:[n!==null?C.jsx(Ye,{children:n||C.jsx(ns,{})}):null,n?C.jsx(D.span,{style:{pointerEvents:"none",flex:1},lineClamp:1,children:o}):o]})}),ns=()=>C.jsx("svg",{viewBox:"0 0 448 512",width:"1em",height:"1em",children:C.jsx("path",{fill:"currentColor",d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"})}),os=()=>{const{focusedIndex:l,isOpen:n,listRef:o,rebirthOptions:d}=F(),r=We(),a=t.useRef(-1),p=r.value(l),c=t.useCallback(()=>{n||d(!1)},[n,d]);t.useEffect(()=>{if(!o.current||!p||a.current===p.index)return;const h=o.current,f=p.node,_=h.clientHeight,w=h.scrollTop,m=w+_,T=f.clientHeight,y=f.offsetTop,S=y+T,k=w<=y&&S<=m,L=a.current<p.index;k||(S<=_?o.current.scrollTo({top:0}):L?o.current.scrollTo({top:S-_}):o.current.scrollTo({top:y+1})),a.current=p.index},[o,p]),de(()=>{n||(a.current=-1)},[n]);const v=t.useCallback((h={},f=null)=>({as:"ul",ref:Me(o,f),role:"listbox",tabIndex:-1,position:"relative",id:h.id||t.useId(),...h}),[o]);return{onAnimationComplete:c,getListProps:v}},ws=oe(({className:l,w:n,width:o,minW:d,minWidth:r,maxW:a,maxWidth:p,contentProps:c,header:v,footer:h,children:f,..._},w)=>{var S,k,L,le,Q,j;const{styles:m}=F(),{onAnimationComplete:T,getListProps:y}=os();return o??(o=n),o??(o=((S=m.list)==null?void 0:S.width)??((k=m.list)==null?void 0:k.w)),r??(r=d),r??(r=((L=m.list)==null?void 0:L.minWidth)??((le=m.list)==null?void 0:le.minW)),p??(p=a),p??(p=((Q=m.list)==null?void 0:Q.maxWidth)??((j=m.list)==null?void 0:j.maxW)),C.jsxs(Bt,{as:"div",className:"ui-autocomplete__popover",width:o,minWidth:r,maxWidth:p,__css:{...m.content,width:o,minWidth:r,maxWidth:p},...c,onAnimationComplete:z(c==null?void 0:c.onAnimationComplete,T),children:[v?C.jsx(D.div,{className:"ui-autocomplete__header",__css:{...m.header},children:v}):null,C.jsx(D.ul,{className:Y("ui-autocomplete__list",l),__css:{...m.list},...y(_,w),children:f}),h?C.jsx(D.div,{className:"ui-autocomplete__footer",__css:{...m.footer},children:h}):null]})}),xt=oe(({className:l,icon:n,...o},d)=>{const{styles:r}=F(),{isSelected:a,customIcon:p,children:c,getOptionProps:v}=Zt(o);n??(n=p);const h={textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,gap:"0.75rem",...r.item};return C.jsxs(D.li,{className:Y("ui-autocomplete__item",l),__css:h,...v({},d),children:[n!==null?C.jsx(Ye,{opacity:a?1:0,children:n||C.jsx(ls,{})}):null,C.jsx(D.span,{style:{flex:1},"data-label":!0,children:c})]})}),ls=()=>C.jsx("svg",{viewBox:"0 0 14 14",width:"1em",height:"1em",children:C.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),is=({label:l,...n})=>{const{value:o,omitSelectedValues:d}=F(),r=$(o),a=We(),p=a.values(),v=(r&&d?a.values(({node:y})=>o.includes(y.dataset.value??"")):[]).map(({index:y})=>y),f=!p.filter(({node:y,index:S})=>{var k;return((k=y.parentElement)==null?void 0:k.dataset.label)===l&&!v.includes(S)&&"target"in y.dataset}).length,[_,w]=bt(n,ht),m=t.useCallback((y={},S=null)=>({ref:S,...y,..._,style:f?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"}:void 0,"data-label":l,role:"autocomplete-group-container"}),[_,f,l]),T=t.useCallback((y={},S=null)=>({ref:S,...y,...w,"data-label":l,role:"autocomplete-group"}),[w,l]);return{label:l,getContainerProps:m,getGroupProps:T}},as=oe(({className:l,color:n,h:o,height:d,minH:r,minHeight:a,children:p,...c},v)=>{const{styles:h}=F(),{label:f,getContainerProps:_,getGroupProps:w}=is(c);return o??(o=d),r??(r=a),C.jsxs(D.li,{className:Y("ui-autocomplete__item","ui-autocomplete__item--group",l),__css:{w:"100%",h:"fit-content",color:n},..._(),children:[C.jsx(D.span,{className:"ui-autocomplete__item__group-label",__css:h.groupLabel,lineClamp:1,children:f}),C.jsx(D.ul,{...w({},v),className:"ui-autocomplete__item__group",__css:{h:o,minH:r,...h.group},children:p})]})}),Ct={ｶﾞ:"ガ",ｷﾞ:"ギ",ｸﾞ:"グ",ｹﾞ:"ゲ",ｺﾞ:"ゴ",ｻﾞ:"ザ",ｼﾞ:"ジ",ｽﾞ:"ズ",ｾﾞ:"ゼ",ｿﾞ:"ゾ",ﾀﾞ:"ダ",ﾁﾞ:"ヂ",ﾂﾞ:"ヅ",ﾃﾞ:"デ",ﾄﾞ:"ド",ﾊﾞ:"バ",ﾋﾞ:"ビ",ﾌﾞ:"ブ",ﾍﾞ:"ベ",ﾎﾞ:"ボ",ﾊﾟ:"パ",ﾋﾟ:"ピ",ﾌﾟ:"プ",ﾍﾟ:"ペ",ﾎﾟ:"ポ",ｳﾞ:"ヴ",ﾜﾞ:"ヷ",ｦﾞ:"ヺ",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｷ:"キ",ｸ:"ク",ｹ:"ケ",ｺ:"コ",ｻ:"サ",ｼ:"シ",ｽ:"ス",ｾ:"セ",ｿ:"ソ",ﾀ:"タ",ﾁ:"チ",ﾂ:"ツ",ﾃ:"テ",ﾄ:"ト",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾋ:"ヒ",ﾌ:"フ",ﾍ:"ヘ",ﾎ:"ホ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ｦ:"ヲ",ﾝ:"ン",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｯ:"ッ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ","｡":"。","､":"、",ｰ:"ー","｢":"「","｣":"」","･":"・"},cs=l=>{l=l.replace(/[！-～]/g,o=>String.fromCharCode(o.charCodeAt(0)-65248));const n=new RegExp("("+Object.keys(Ct).join("|")+")","g");return l=l.replace(n,o=>Ct[o]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),l=l.toUpperCase(),l},rs=l=>{const n=o=>o.map(d=>{const{isDisabled:r,isFocusable:a}=d;if(!(r&&!a))return"items"in d?n(d.items??[]):d}).filter(Boolean);return n(l).flat(1/0)},js=l=>{const{value:n,defaultValue:o,onChange:d,onCreate:r,onSearch:a,closeOnSelect:p=!0,omitSelectedValues:c=!1,maxSelectValues:v,allowCreate:h=!1,allowFree:f=!1,insertPositionItem:_="first",emptyMessage:w="No results found",format:m=cs,optionProps:T,placeholder:y,onKeyDown:S,isOpen:k,defaultIsOpen:L,onOpen:le,onClose:Q,closeOnBlur:j=!0,closeOnEsc:fe=!0,openDelay:_e,closeDelay:Be,isLazy:Se,lazyBehavior:me,animation:Le,duration:q=.2,offset:xe,gutter:ie,preventOverflow:Ce,flip:ke,matchWidth:ge=!0,boundary:H,eventListeners:Ae,strategy:Oe,placement:Qe="bottom-start",modifiers:Xe,items:be,children:Ze,...ae}=$t(l),{"aria-readonly":us,onFocus:et,...M}=Rt(ae,qt),[tt,vt]=bt(ae,ht),{id:yt}=ae,I=Wt(),He=t.useRef(null),st=t.useRef(null),X=t.useRef(null),Z=t.useRef(new Set([])),Ue=t.useRef(!1),Pe=t.useRef(void 0),[ee,nt]=t.useState(be?JSON.parse(JSON.stringify(be)):void 0),[A,we]=Lt({value:n,defaultValue:o,onChange:d}),[ze,je]=t.useState(void 0),[E,ce]=t.useState(""),[J,O]=t.useState(-1),[te,ot]=t.useState(!1),[re,lt]=t.useState(!0),{isOpen:g,onOpen:it,onClose:R}=Ht({isOpen:k,defaultIsOpen:L,onOpen:le,onClose:Q}),he=J>-1,Je=J===-2&&h,b=$(A),Ee=b?!A.length:!A,[ve,at]=t.useMemo(()=>$(_)?_:[_,"first"],[_]);h&&!mt(Ze)&&console.warn(`${b?"MultiAutocomplete":"Autocomplete"}: ${b?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const K=I.enabledValues(({node:e})=>b&&A.includes(e.dataset.value??"")).map(({index:e})=>e),U=I.enabledValues(({node:e,index:s})=>"target"in e.dataset&&!K.includes(s)),It=gt(Ze),Ve=t.useMemo(()=>ee==null?void 0:ee.map((e,s)=>{if("value"in e){const{label:i,value:x,...u}=e;return C.jsx(xt,{value:x,...u,children:i},s)}else if("items"in e){const{label:i,items:x=[],...u}=e;return C.jsx(as,{label:i,...u,children:x.map(({label:P,value:B,...ne},jt)=>C.jsx(xt,{value:B,...ne,children:P},jt))},s)}}),[ee]),se=!It.length&&!(Ve!=null&&Ve.length),V=t.useCallback(()=>{M.disabled||M.readOnly||!h&&(se||te)||(it(),X.current&&X.current.focus())},[h,M,te,se,it]),ue=t.useCallback(()=>{const e=setTimeout(()=>{if(se||te)return;const s=I.enabledFirstValue(({node:i})=>"target"in i.dataset);if(s)if(!b||!c)O(s.index);else if(K.includes(s.index)){const i=U[0];O(i.index)}else O(s.index)});Z.current.add(e)},[I,U,te,se,b,c,K]),De=t.useCallback(()=>{const e=setTimeout(()=>{if(se||te)return;const s=I.enabledLastValue(({node:i})=>"target"in i.dataset);if(s)if(!b||!c)O(s.index);else if(K.includes(s.index)){const i=U.reverse()[0];O(i.index)}else O(s.index)});Z.current.add(e)},[I,U,te,se,b,c,K]),Ke=t.useCallback(()=>{const e=setTimeout(()=>{const i=I.enabledValues().find(({node:x})=>b?A.includes(x.dataset.value??""):x.dataset.value===A);i&&O(i.index)});Z.current.add(e)},[I,b,A]),ye=t.useCallback((e=J)=>{const s=setTimeout(()=>{const i=I.enabledNextValue(e,({node:x})=>"target"in x.dataset);if(i)if(!b||!c)O(i.index);else if(K.includes(i.index)){const x=U.find(({index:u})=>i.index<u)??U[0];O(x.index)}else O(i.index)});Z.current.add(s)},[I,U,J,b,c,K]),Ge=t.useCallback((e=J)=>{const s=setTimeout(()=>{const i=I.enabledPrevValue(e,({node:x})=>"target"in x.dataset);if(i)if(!b||!c)O(i.index);else if(K.includes(i.index)){const x=U.reverse().find(({index:u})=>u<i.index)??U[0];O(x.index)}else O(i.index)});Z.current.add(s)},[I,U,J,b,c,K]),W=Ee||c?ue:Ke,ct=Ee||c?De:Ke,$e=t.useCallback(e=>{const s=I.values();let i=!1,x=!1;s.forEach(({node:u,index:P})=>{if(m(u.textContent??"").includes(e)){i=!0;const B="disabled"in u.dataset;u.dataset.target="",!x&&!B&&(x=!0,O(P))}else delete u.dataset.target}),lt(i)},[I,m]),G=t.useCallback((e=!0)=>{I.values().forEach(({node:i})=>{i.dataset.target=""}),e&&ue(),lt(!0)},[I,ue]),Fe=t.useCallback(e=>{const s=I.enabledValues();return($(e)?e:[e]).map(u=>{const{node:P}=s.find(({node:B})=>B.dataset.value===u)??{};if(P){const B=Array.from(P.children).find(ne=>ne.getAttribute("data-label")!==null);return(B==null?void 0:B.textContent)??void 0}else return f?u:void 0}).filter(Boolean)},[f,I]),Ie=t.useCallback((e,{forceUpdate:s,runOmit:i=!0}={})=>{const x=Fe(e);!s&&!x.length||je(u=>b?(x.forEach(P=>{$(u)&&u.includes(P??"")?i&&(u=$(u)?u.filter(ne=>ne!==P):void 0):u=[...$(u)?u:[],P]}),u):x[0])},[Fe,b]),N=t.useCallback((e,{forceUpdate:s,runRebirth:i=!0}={})=>{we(u=>{let P;return $(u)?u.includes(e)?P=u.filter(ne=>ne!==e):P=[...u,e]:P=e,Pe.current=P,P});const x=I.values().filter(({node:u})=>m(u.textContent??"").includes(e)).length>0;Ie(e,{forceUpdate:s}),(f||x)&&ce(""),b&&i&&G(!1)},[f,b,Ie,G,we,I,m]),qe=t.useCallback(()=>{let e=I.value(J);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const s=e.node.dataset.value??"";N(s),p&&R(),c&&ye()},[p,I,J,c,N,R,ye]),_t=t.useCallback(e=>{g||V(),a==null||a(e);const s=e.target.value,i=m(s);i?$e(i):G(),ce(s)},[g,V,m,a,$e,G]),St=t.useCallback(()=>{Ue.current=!0},[]),kt=t.useCallback(()=>{Ue.current=!1},[]),Re=t.useCallback(()=>{if(!st.current)return;const e={label:E,value:E};let s=[];if(ee&&(s=[...ee]),ve==="first")s=[e,...s];else if(ve==="last")s=[...s,e];else{const x=s.findIndex(({label:P})=>P===ve),u=s[x];x!==-1&&"items"in u?(at==="first"?u.items=[e,...u.items??[]]:u.items=[...u.items??[],e],s[x]=u):console.warn(`${b?"MultiAutocomplete":"Autocomplete"}: '${ve}' specified in insertPositionItem does not exist in the option group.`)}nt(s),N(E),G(!1);const i=rs(s).findIndex(({value:x})=>x===E);O(i),r==null||r(e,s)},[E,ee,ve,N,G,r,at,b]),rt=t.useCallback(()=>{g?X.current&&X.current.focus():(V(),W())},[g,W,V]),Ne=t.useCallback(()=>{g||(V(),W())},[g,W,V]),ut=t.useCallback(e=>{const s=Nt(e);Tt(He.current,s)||!j&&re||(f&&E&&N(E,{runRebirth:!1}),ce(""),g&&R())},[j,re,g,E,f,R,N]),dt=t.useCallback(()=>{b?N(A[A.length-1]):N("",{forceUpdate:!0}),g||Ne()},[b,g,N,Ne,A]),At=t.useCallback(e=>{e.stopPropagation(),Pe.current=[],we([]),je(void 0),ce(""),G(),g&&X.current&&X.current.focus()},[g,je,ce,we,G]),pt=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),M.disabled||M.readOnly||Ue.current)return;const s=ze===E||!E.length,x={ArrowDown:he?()=>ye():g?void 0:Te(V,W),ArrowUp:he?()=>Ge():g?void 0:Te(V,ct),Space:Je?Re:he?qe:g?void 0:Te(V,W),Enter:Je?Re:he?qe:g?f&&b?()=>{E&&N(E),O(0)}:void 0:Te(V,W),Home:g?ue:void 0,End:g?De:void 0,Escape:fe?R:void 0,Backspace:!Ee&&s?dt:void 0}[e.key];x&&(e.preventDefault(),e.stopPropagation(),x(e))},[f,M,ze,E,V,he,b,W,ye,ct,Ge,Je,Re,qe,g,ue,De,fe,R,Ee,dt,N]);t.useEffect(()=>{if(!b||!c&&mt(v))return;const e=A.length>0&&A.length===I.count(),s=A.length===v;e||s?(R(),ot(!0)):ot(!1)},[c,A,I,b,R,v]),t.useEffect(()=>{if(b){if(JSON.stringify(Pe.current??[])===JSON.stringify(A??[]))return;const e=Fe(A);je(e)}else{if(Pe.current===A)return;Ie(A,{runOmit:!1})}},[b,A,Ie,Fe]),de(()=>{g||f||(O(-1),ce(""))},[g]),de(()=>{re||O(-2)},[re]),de(()=>{nt(be?JSON.parse(JSON.stringify(be)):void 0)},[be]),Mt(()=>{Z.current.forEach(e=>clearTimeout(e)),Z.current.clear()}),Ut({ref:He,handler:R,enabled:g&&(j||!re)});const Ot=t.useCallback(e=>({closeOnBlur:j,openDelay:_e,closeDelay:Be,isLazy:Se,lazyBehavior:me,animation:Le,duration:q,offset:xe,gutter:ie,preventOverflow:Ce,flip:ke,matchWidth:ge,boundary:H,eventListeners:Ae,strategy:Oe,placement:Qe,modifiers:Xe,...e,trigger:"never",closeOnButton:!1,isOpen:g,onOpen:V,onClose:R}),[j,_e,Be,Se,me,Le,q,xe,ie,Ce,ke,ge,H,Ae,Oe,Qe,Xe,g,V,R]),Pt=t.useCallback((e={},s=null)=>({ref:Me(He,s),...tt,...e,...M,onClick:z(e.onClick,ae.onClick,rt),onBlur:z(e.onBlur,ae.onBlur,ut)}),[tt,M,ut,rt,ae]),wt=t.useCallback((e={},s=null)=>({ref:s,tabIndex:-1,...e,...M,placeholder:y,"data-active":pe(g),"aria-expanded":pe(g),onFocus:z(e.onFocus,et,Ne),onKeyDown:z(e.onKeyDown,S,pt)}),[M,y,g,et,Ne,S,pt]);return{id:yt,descendants:I,value:A,label:ze,inputValue:E,isHit:re,isEmpty:se,computedChildren:Ve,focusedIndex:J,omitSelectedValues:c,closeOnSelect:p,allowCreate:h,allowFree:f,emptyMessage:w,isOpen:g,isAllSelected:te,listRef:st,inputRef:X,optionProps:T,formControlProps:M,setFocusedIndex:O,onChangeLabel:Ie,onChange:N,onSearch:_t,onCreate:Re,onClear:At,onCompositionStart:St,onCompositionEnd:kt,pickOptions:$e,rebirthOptions:G,onOpen:V,onClose:R,onFocusFirst:ue,onFocusLast:De,onFocusSelected:Ke,onFocusNext:ye,onFocusPrev:Ge,getPopoverProps:Ot,getContainerProps:Pt,getFieldProps:wt,inputProps:vt}},Es=()=>{const{id:l,inputRef:n,onSearch:o,onCompositionStart:d,onCompositionEnd:r,isAllSelected:a,formControlProps:p,inputProps:c,isOpen:v,focusedIndex:h,listRef:f}=F(),{value:_}=We();return de(()=>{a&&n.current&&n.current.blur()},[a]),{getInputProps:t.useCallback((m={},T=null)=>{var y,S;return{ref:Me(n,T),...p,role:"combobox","aria-haspopup":"listbox","aria-autocomplete":"list","aria-expanded":v,"aria-activedescendant":(y=_(h))==null?void 0:y.node.id,"aria-controls":(S=f.current)==null?void 0:S.id,autoCapitalize:"none",autoComplete:"off",spellCheck:"false",...c,...m,id:l,cursor:p.readOnly?"default":"text",pointerEvents:p.disabled||a?"none":"auto",tabIndex:a?-1:0,onChange:z(m.onChange,o),onCompositionStart:z(m.onCompositionStart,c.onCompositionStart,d),onCompositionEnd:z(m.onCompositionEnd,c.onCompositionEnd,r)}},[f,h,v,c,n,p,l,a,_,o,d,r])}};export{Ss as A,ks as a,Qt as b,ws as c,Os as d,Ps as e,F as f,Es as g,xt as h,as as i,As as j,js as u};
