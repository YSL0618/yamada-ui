import{r}from"./index-BwDkhjyp.js";import{j as M}from"./extends-CwFRzn3r.js";import{b as se}from"./index-Dd5uuyt0.js";import{u as ie,a as ue}from"./index-LwUC2h1G.js";import{u as le,a as ce,b as ae}from"./index-DP8J_kCj.js";import{u as fe}from"./index-ry0nKyvs.js";import{o as me,a as N,h as l,z as de,aj as S,W as B,c as Z,p as pe,am as ve,b as ge,X as Pe}from"./factory-BFmlPmGv.js";import{a as Ce}from"./use-component-style-EAJDzyrD.js";import{o as he}from"./theme-provider-BxuddooS.js";import{C as be}from"./close-button-C2kve5KL.js";import{f as xe}from"./forward-ref-BWI-Phbn.js";import{s as V}from"./slide-fade-fVtXuNem.js";import{s as ye}from"./scale-fade-DU3hSrG9.js";import{m as Re}from"./forward-ref-scR1bmHx.js";import{m as Be}from"./factory-DrzA6EUf.js";const[Te,H]=me({strict:!1,name:"PopoverContext"}),Ye=m=>{const[a,s]=Ce("Popover",m),{children:T,initialFocusRef:g,restoreFocus:P=!0,autoFocus:w=!0,closeOnBlur:f=!0,closeOnEsc:D=!0,closeOnButton:E=!0,trigger:c="click",openDelay:x=200,closeDelay:y=200,isLazy:j,lazyBehavior:z="unmount",animation:A="scale",duration:X,relatedRef:C,...I}=he(s),{isOpen:t,onOpen:h,onClose:i,onToggle:_}=ie(s),F=r.useRef(null),R=r.useRef(null),d=r.useRef(null),{present:K,onAnimationComplete:e}=se({isOpen:t,ref:d}),p=r.useRef(void 0),Y=r.useRef(void 0),k=r.useRef(!1),U=r.useRef(!1);t&&(U.current=!0);const{referenceRef:L,getPopperProps:$,forceUpdate:W,transformOrigin:q}=fe({...I,enabled:t});r.useEffect(()=>()=>{p.current&&clearTimeout(p.current),Y.current&&clearTimeout(Y.current)},[]),le({enabled:t,ref:R}),ce(d,{focusRef:R,visible:t,shouldFocus:P&&(c==="click"||c==="contextmenu")}),ae(d,{focusRef:g,visible:t,shouldFocus:w&&(c==="click"||c==="contextmenu")});const G=ue({wasSelected:U.current,enabled:j,mode:z,isSelected:K}),ee=r.useCallback((o={},O=null)=>{const u={...o,style:{...o.style,transformOrigin:q},ref:N(d,O),children:G?o.children:null,tabIndex:-1,onKeyDown:l(o.onKeyDown,n=>{D&&n.key==="Escape"&&i()}),onBlur:l(o.onBlur,n=>{const v=S(n),b=B(d.current,v),ne=B(R.current,v),re=C!=null&&C.current?B(C.current,v):!1;t&&f&&(!b&&!ne&&!re)&&i()})};return c==="hover"&&(u.onMouseEnter=l(o.onMouseEnter,()=>{k.current=!0}),u.onMouseLeave=l(o.onMouseLeave,n=>{n.nativeEvent.relatedTarget!==null&&(k.current=!1,f&&setTimeout(i,y))})),u},[y,f,D,t,i,G,q,c,C]),J=r.useCallback(o=>{F.current==null&&L(o)},[L]),oe=r.useCallback((o={},O=null)=>{const u={...o,ref:N(R,O,J)};return c==="click"&&(u.onClick=l(o.onClick,_),u.onBlur=l(o.onBlur,n=>{const v=S(n),b=!B(d.current,v);t&&f&&b&&i()})),c==="contextmenu"&&(u.onContextMenu=l(o.onContextMenu,n=>{n.preventDefault(),h()}),u.onBlur=l(o.onBlur,n=>{const v=S(n),b=!B(d.current,v);t&&f&&b&&i()})),c==="hover"&&(u.onFocus=l(o.onFocus,()=>{p.current===void 0&&h()}),u.onBlur=l(o.onBlur,n=>{const v=S(n),b=!B(d.current,v);t&&f&&b&&i()}),u.onKeyDown=l(o.onKeyDown,n=>{n.key==="Escape"&&i()}),u.onMouseEnter=l(o.onMouseEnter,()=>{k.current=!0,p.current=window.setTimeout(h,x)}),u.onMouseLeave=l(o.onMouseLeave,()=>{k.current=!1,p.current&&(clearTimeout(p.current),p.current=void 0),Y.current=window.setTimeout(()=>{k.current||i()},y)})),u},[y,f,t,J,i,h,_,x,c]),te=r.useCallback((o={},O=null)=>({...o,ref:N(O,F,L)}),[F,L]);return M.jsx(Te,{value:{isOpen:t,onClose:i,closeOnButton:E,onAnimationComplete:e,forceUpdate:W,getTriggerProps:oe,getAnchorProps:te,getPopperProps:$,getPopoverProps:ee,animation:A,duration:X,styles:a},children:de(T,{isOpen:t,onClose:i,forceUpdate:W})})},Ne=({children:m})=>{const a=r.Children.only(m),{getTriggerProps:s}=H();return r.cloneElement(a,s(a.props,a.ref))},Q=xe(({onClick:m,...a},s)=>{const{styles:T,onClose:g}=H(),P={position:"absolute",...T.closeButton};return M.jsx(be,{ref:s,className:Z("ui-popover__close-button"),__css:P,onClick:l(m,w=>{w.stopPropagation(),g==null||g()}),size:"sm",...a})}),we=(m="scale",a)=>{const s={reverse:!0,duration:a,enter:{visibility:"visible"},transitionEnd:{exit:{visibility:"hidden"}}};switch(m){case"scale":return{...ye,custom:{...s,scale:.95}};case"top":return{...V,custom:{...s,offsetX:0,offsetY:-16}};case"right":return{...V,custom:{...s,offsetX:16,offsetY:0}};case"left":return{...V,custom:{...s,offsetX:-16,offsetY:0}};case"bottom":return{...V,custom:{...s,offsetX:0,offsetY:16}}}},He=Re(({as:m="section",className:a,containerProps:s,children:T,w:g,width:P,minW:w,minWidth:f,maxW:D,maxWidth:E,z:c,zIndex:x,__css:y,...j},z)=>{const{isOpen:A,closeOnButton:X,getPopperProps:C,getPopoverProps:I,onAnimationComplete:t,animation:h,duration:i,styles:_}=H(),F=pe(T),[R,...d]=ve(F,Q),K=r.useMemo(()=>Be(m),[m]),e=y??_.container??{},p={position:"relative",w:"100%",display:"flex",flexDirection:"column",outline:0,...e};return P??(P=g),P??(P=(e==null?void 0:e.width)??(e==null?void 0:e.w)),f??(f=w),f??(f=(e==null?void 0:e.minWidth)??(e==null?void 0:e.minW)),E??(E=D),E??(E=(e==null?void 0:e.maxWidth)??(e==null?void 0:e.maxW)),x??(x=c),x??(x=(e==null?void 0:e.zIndex)??(e==null?void 0:e.z)),M.jsx(ge.div,{...C({style:{visibility:A?"visible":"hidden"}}),className:"ui-popover",outline:"none",width:P,minWidth:f,maxWidth:E,zIndex:x,...s,children:M.jsxs(K,{className:Z("ui-popover__content",a),...h!=="none"?we(h,i):{},...I(j,z),initial:"exit",animate:A?"enter":"exit",exit:"exit",onAnimationComplete:Pe(t,j.onAnimationComplete),__css:p,children:[R??(X?M.jsx(Q,{}):null),d]})})});export{Ye as P,Ne as a,He as b,Q as c,H as u};
