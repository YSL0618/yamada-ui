import{j as v}from"./extends-CwFRzn3r.js";import{r as s}from"./index-BwDkhjyp.js";import{f as le}from"./forward-ref-BWI-Phbn.js";import{o as Ze,W as et,V as Ge,a6 as Ke,$ as tt,F as Y,af as st,X as nt,A as ot,f as lt,S as ct,a as Ce,h as oe,d as he,t as ke,aP as at,Y as xe,b as M,c as J,p as it,j as rt}from"./factory-BPGpAF5Z.js";import{u as ut}from"./index-DYLohKMc.js";import{c as dt,a as pt}from"./icon-BYVaiKtb.js";import{u as ft}from"./index-CJwZPsS_.js";import{c as mt}from"./index-oQ85FuiM.js";import{u as xt}from"./index-BSZzY47h.js";import{u as Ct}from"./index-DjrrK_0S.js";import{u as ht,f as _t}from"./form-control-CY2fHU0c.js";import{b as bt}from"./popover-trigger-BJsmlD02.js";const gt=a=>{var n;return at(a)&&!!((n=a.getAttribute("role"))!=null&&n.startsWith("option"))},{DescendantsContextProvider:Mt,useDescendant:vt,useDescendants:St,useDescendantsContext:Ue}=mt(),[Ht,U]=Ze({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),Gt=a=>{const{animation:n,boundary:o,closeDelay:r,closeOnBlur:l=!0,closeOnEsc:c=!0,closeOnSelect:x=!0,defaultIsOpen:b,defaultValue:I,duration:f=.2,eventListeners:C,flip:g,gutter:j,isEmpty:u,isLazy:N,isOpen:d,lazyBehavior:S,matchWidth:h=!0,maxSelectValues:T,modifiers:k,offset:H,omitSelectedValues:y=!1,openDelay:ce,placeholder:z,placeholderInOptions:R=!0,placement:Q="bottom-start",preventOverflow:_e,strategy:ae,value:Z,optionProps:De,onChange:$,onClose:ee,onOpen:ie,...A}=ht(a),{"aria-readonly":G,...w}=et(A,_t),[re,we]=Ge(tt(A,["aria-readonly"]),Ke),m=St(),[L,O]=s.useState(-1),[Fe,Ee]=s.useState(!1),ue=s.useRef(null),Ve=s.useRef(null),Ne=s.useRef(null),X=s.useRef(new Set([])),[F,de]=ft({defaultValue:I,value:Z,onChange:$}),[q,be]=s.useState(void 0),te=L>-1,_=Y(F),Te=(_?!F.length:!F)&&!(z&&R),K=m.values(({node:e})=>_&&F.includes(e.dataset.value??"")).map(({index:e})=>e),B=m.enabledValues(({index:e})=>!K.includes(e)),pe=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledFirstValue();if(t)if(!_||!y)O(t.index);else if(K.includes(t.index)){const i=B[0];O((i==null?void 0:i.index)??-1)}else O(t.index)});X.current.add(e)},[m,B,_,y,K]),fe=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledLastValue();if(t)if(!_||!y)O(t.index);else if(K.includes(t.index)){const i=B.reverse()[0];O((i==null?void 0:i.index)??-1)}else O(t.index)});X.current.add(e)},[m,B,_,y,K]),ge=s.useCallback(()=>{const e=setTimeout(()=>{const i=m.enabledValues().find(({node:D})=>_?F.includes(D.dataset.value??""):D.dataset.value===F);i&&O(i.index)});X.current.add(e)},[m,_,F]),se=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledNextValue(L);if(t)if(!_||!y)O(t.index);else if(K.includes(t.index)){const i=B.find(({index:D})=>t.index<D)??B[0];O((i==null?void 0:i.index)??-1)}else O(t.index)});X.current.add(e)},[m,B,L,_,y,K,O]),ve=s.useCallback(()=>{const e=setTimeout(()=>{const t=m.enabledPrevValue(L);if(t)if(!_||!y)O(t.index);else if(K.includes(t.index)){const i=B.reverse().find(({index:D})=>D<t.index)??B[0];O((i==null?void 0:i.index)??-1)}else O(t.index)});X.current.add(e)},[m,B,L,_,y,K,O]),W=Te||y?pe:ge,Re=Te||y?fe:ge,Se=s.useCallback((e,t=!0)=>{const i=m.values();if(!i.length)return;const D=i.filter(({node:P})=>P.dataset.value===e).map(({index:P,node:ne})=>{if(!(z&&R)||P!==0){const me=Array.from(ne.children).find(Ie=>Ie.getAttribute("data-label")!==null);return(me==null?void 0:me.innerHTML)??""}else return});be(P=>_?(D.forEach(ne=>{Y(P)&&P.includes(ne??"")?t&&(P=Y(P)?P.filter(Ie=>Ie!==ne):void 0):P=[...Y(P)?P:[],ne]}),P):D[0])},[m,_,z,R]),ye=s.useCallback(e=>{de(t=>Y(t)?t.includes(e)?t.filter(D=>D!==e):[...t,e]:e),Se(e)},[Se,de]),Xe=s.useCallback(e=>{e.stopPropagation(),de([]),be(void 0)},[be,de]),{isOpen:p,onClose:E,onOpen:Ae}=xt({defaultIsOpen:b,isOpen:d,onClose:ee,onOpen:ie}),V=s.useCallback(()=>{w.disabled||w.readOnly||u||Fe||Ae()},[w,u,Fe,Ae]),Oe=s.useCallback(()=>{let e=m.value(L);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";ye(t),x&&E(),y&&se()},[x,m,L,y,ye,E,se]),Le=s.useCallback(()=>{p||(V(),W())},[p,W,V]),Be=s.useCallback(()=>{p||(V(),W())},[p,W,V]),Me=s.useCallback(e=>{const t=st(e);nt(ue.current,t)||l&&p&&E()},[l,p,E]),He=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),w.disabled||w.readOnly)return;const i={ArrowDown:te?()=>se():p?void 0:xe(V,W),ArrowUp:te?()=>ve():p?void 0:xe(V,Re),End:p?fe:void 0,Enter:te?Oe:p?void 0:xe(V,W),Escape:c?E:void 0,Home:p?pe:void 0,Space:te?Oe:p?void 0:xe(V,W)}[e.key];i&&(e.preventDefault(),e.stopPropagation(),i())},[w.disabled,w.readOnly,te,p,V,W,Re,Oe,pe,fe,c,E,se,ve]);Ct({ref:ue,enabled:p&&l,handler:E}),s.useEffect(()=>{if(!_||!y&&ot(T))return;const e=F.length>0&&F.length===m.count(),t=F.length===T;e||t?(E(),Ee(!0)):Ee(!1)},[y,F,m,_,E,T]),lt(()=>{p||O(-1)},[p]),ct(()=>{X.current.forEach(e=>clearTimeout(e)),X.current.clear()});const qe=s.useCallback(e=>({animation:n,boundary:o,closeDelay:r,closeOnBlur:l,duration:f,eventListeners:C,flip:g,gutter:j,isLazy:N,lazyBehavior:S,matchWidth:h,modifiers:k,offset:H,openDelay:ce,placement:Q,preventOverflow:_e,strategy:ae,...e,closeOnButton:!1,isOpen:p,trigger:"never",onClose:E,onOpen:V}),[l,ce,r,N,S,n,f,H,j,_e,g,h,o,C,ae,Q,k,p,V,E]),Je=s.useCallback((e={},t=null)=>({ref:Ce(ue,t),...re,...e,...w,onBlur:oe(e.onBlur,A.onBlur,Me),onClick:oe(e.onClick,A.onClick,Le)}),[re,w,Me,Le,A]),Qe=s.useCallback(({"aria-label":e,...t}={},i=null)=>{var D,P;return e??(e=z??`Select ${_?"one or more options.":"an option."}`),{ref:Ce(Ve,i),"aria-label":e,role:"combobox",tabIndex:0,...we,...t,"aria-activedescendant":(D=m.value(L))==null?void 0:D.node.id,"aria-controls":(P=Ne.current)==null?void 0:P.id,"aria-expanded":p,"data-active":he(p),"data-placeholder":he(_?!(q!=null&&q.length):q===void 0),onFocus:oe(t.onFocus,A.onFocus,Be),onKeyDown:oe(t.onKeyDown,A.onKeyDown,He)}},[m,we,L,p,_,q,z,A,Be,He]);return{closeOnSelect:x,containerRef:ue,descendants:m,fieldRef:Ve,focusedIndex:L,isOpen:p,label:q,listRef:Ne,omitSelectedValues:y,placeholder:z,placeholderInOptions:R,setFocusedIndex:O,value:F,formControlProps:w,getContainerProps:Je,getFieldProps:Qe,getPopoverProps:qe,optionProps:De,onChange:ye,onChangeLabel:Se,onClear:Xe,onClose:E,onFocusFirst:pe,onFocusLast:fe,onFocusNext:se,onFocusPrev:ve,onFocusSelected:ge,onOpen:V}},yt=()=>{const{focusedIndex:a,listRef:n,value:o}=U(),r=Ue(),l=s.useRef(-1),c=r.value(a),x=Y(o);s.useEffect(()=>{if(!n.current||!c||l.current===c.index)return;const f=n.current,C=c.node,g=f.clientHeight,j=f.scrollTop,u=j+g,N=C.clientHeight,d=C.offsetTop,S=d+N,h=j<=d&&S<=u,T=l.current<c.index;h||(S<=g?n.current.scrollTo({top:0}):T?n.current.scrollTo({top:S-g}):n.current.scrollTo({top:d+1})),l.current=c.index},[n,c]);const b=s.useId();return{getListProps:s.useCallback((f={},C=null)=>({id:b,ref:Ce(n,C),"aria-multiselectable":ke(x),position:"relative",role:"listbox",tabIndex:-1,...f}),[b,x,n])}},Ot=({label:a,...n})=>{const{omitSelectedValues:o,value:r}=U(),l=Y(r),c=Ue(),x=c.values(),I=(l&&o?c.values(({node:d})=>r.includes(d.dataset.value??"")):[]).map(({index:d})=>d),C=!x.filter(({index:d,node:S})=>{var h;return((h=S.parentElement)==null?void 0:h.dataset.label)===a&&!I.includes(d)}).length,[g,j]=Ge(n,Ke),u=s.useCallback((d={},S=null)=>({ref:S,...d,...g,style:C?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0}),[g,C]),N=s.useCallback(({"aria-label":d,...S}={},h=null)=>(d??(d=a),{ref:h,"aria-label":d,role:"group",...S,...j,"data-label":a}),[j,a]);return{label:a,getContainerProps:u,getGroupProps:N}},It=a=>{const{closeOnSelect:n,fieldRef:o,focusedIndex:r,omitSelectedValues:l,placeholder:c,placeholderInOptions:x,setFocusedIndex:b,value:I,optionProps:f,onChange:C,onChangeLabel:g,onClose:j,onFocusNext:u}=U();let{children:N,closeOnSelect:d,icon:S,isDisabled:h,isFocusable:T,value:k,...H}={...f,...a};const y=!!h&&!T,ce=s.useRef(null),{descendants:z,index:R,register:Q}=vt({disabled:y}),ae=z.values().slice(0,R),Z=Y(I),$=!(Z?!1:ae.some(({node:G})=>G.dataset.value===(k??"")))&&(Z?I.includes(k??""):(k??"")===I),ee=R===r;c&&R>0&&x&&!k&&console.warn(`${Z?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set 'placeholderInOptions' to false.`);const ie=s.useCallback(G=>{if(G.preventDefault(),G.stopPropagation(),h){o.current&&o.current.focus();return}if(!gt(G.currentTarget)){o.current&&o.current.focus();return}b(R),C(k??""),o.current&&o.current.focus(),(d??n)&&j(),l&&u()},[h,b,R,C,k,o,d,n,j,l,u]);s.useEffect(()=>{$&&g(k??"",!1)},[k,$,g]);const A=s.useCallback((G={},w=null)=>{const re={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:Ce(ce,w,Q),role:"option",...H,...G,style:l&&$?re:void 0,"aria-checked":ke($),"aria-disabled":ke(h),"data-disabled":he(h),"data-focus":he(ee),"data-value":k??"",tabIndex:-1,onClick:oe(H.onClick,G.onClick,ie)}},[k,H,h,ee,$,l,ie,Q]);return{children:N,customIcon:S,isFocused:ee,isSelected:$,getOptionProps:A}},ze=le(({id:a,className:n,icon:o,...r},l)=>{const{styles:c}=U(),{children:x,customIcon:b,isSelected:I,getOptionProps:f}=It(r),C=s.useId();a??(a=C),o??(o=b);const g={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...c.item};return v.jsxs(M.li,{id:a,className:J("ui-select__item",n),__css:g,...f({},l),children:[o!==null?v.jsx(Pe,{opacity:I?1:0,children:o||v.jsx(kt,{})}):null,v.jsx(M.span,{style:{flex:1},"data-label":!0,children:x})]})});ze.displayName="Option";ze.__ui__="Option";const Pe=le(({className:a,...n},o)=>{const{styles:r}=U(),l={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...r.itemIcon};return v.jsx(M.span,{ref:o,className:J("ui-select__item__icon",a),__css:l,...n})});Pe.displayName="OptionIcon";Pe.__ui__="OptionIcon";const kt=()=>v.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:v.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),$e=le(({className:a,children:n,color:o,h:r,height:l,minH:c,minHeight:x,labelProps:b,...I},f)=>{const{styles:C}=U(),{label:g,getContainerProps:j,getGroupProps:u}=Ot(I);return r??(r=l),c??(c=x),v.jsxs(M.li,{className:J("ui-select__item","ui-select__item--group",a),__css:{color:o,h:"fit-content",w:"100%"},...j(),children:[v.jsx(M.span,{className:"ui-select__item__group-label",lineClamp:1,__css:C.groupLabel,...b,children:g}),v.jsx(M.ul,{...u({},f),className:"ui-select__item__group",__css:{h:r,minH:c,...C.group},children:n})]})});$e.displayName="OptionGroup";$e.__ui__="OptionGroup";const je=le(({className:a,children:n,__css:o,...r},l)=>{const{styles:c}=U(),x={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...c.icon,...o},I=it(n).map(f=>s.cloneElement(f,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return v.jsx(M.div,{ref:l,className:J("ui-select__icon",a),__css:x,...r,children:rt(n)?I:v.jsx(dt,{})})});je.displayName="SelectIcon";je.__ui__="SelectIcon";const We=({className:a,children:n,...o})=>{const r=s.useRef(null),{styles:l}=U(),c=o.disabled,x=ut({ref:r,isDisabled:c,...o});return v.jsx(je,{className:J("ui-select__clear-icon",a),"aria-label":"Clear value",__css:l.clearIcon,...x,children:n??v.jsx(pt,{h:"0.5em",w:"0.5em"})})};We.displayName="SelectClearIcon";We.__ui__="SelectClearIcon";const Ye=le(({className:a,children:n,footer:o,header:r,maxW:l,maxWidth:c,minW:x,minWidth:b,w:I,width:f,contentProps:C,...g},j)=>{var d,S,h,T,k,H;const{styles:u}=U(),{getListProps:N}=yt();return f??(f=I),f??(f=((d=u.list)==null?void 0:d.width)??((S=u.list)==null?void 0:S.w)),b??(b=x),b??(b=((h=u.list)==null?void 0:h.minWidth)??((T=u.list)==null?void 0:T.minW)),c??(c=l),c??(c=((k=u.list)==null?void 0:k.maxWidth)??((H=u.list)==null?void 0:H.maxW)),v.jsxs(bt,{as:"div",className:"ui-select__content",maxWidth:c,minWidth:b,width:f,__css:{...u.content,maxWidth:c,minWidth:b,width:f},...C,children:[r?v.jsx(M.div,{className:"ui-select__header",__css:{...u.header},children:r}):null,v.jsx(M.ul,{className:J("ui-select__list",a),__css:{...u.list},...N(g,j),children:n}),o?v.jsx(M.div,{className:"ui-select__footer",__css:{...u.footer},children:o}):null]})});Ye.displayName="SelectList";Ye.__ui__="SelectList";export{ze as O,Mt as S,$e as a,Ht as b,je as c,Ye as d,U as e,We as f,Gt as u};
