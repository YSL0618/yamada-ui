import{r as g}from"./index-BwDkhjyp.js";import{p as _,F as b,u as E,a as S,G as M}from"./factory-DBrfn43w.js";const v=t=>t.sort((c,u)=>{const r=c.compareDocumentPosition(u);return r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS?1:((r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)&&console.warn("Cannot sort the given nodes."),0)}),V=(t,c,u)=>{let r=t+1;return u&&r>=c&&(r=0),r},m=(t,c,u)=>{let r=t-1;return u&&r<0&&(r=c),r},y=()=>{const t=new Map,c=e=>{t.forEach(n=>{const s=e.indexOf(n.node);n.index=s,n.node.dataset.index=n.index.toString()})},u=(e,n)=>{if(!e||t.has(e))return;const s=Array.from(t.keys()).concat(e),a=v(s);n!=null&&n.disabled&&(n.disabled=!!n.disabled);const N={index:-1,node:e,...n};t.set(e,N),c(a)},r=e=>{if(e!=null)return M(e)?u(e):n=>u(n,e)},d=e=>{if(e==null)return;t.delete(e);const n=v(Array.from(t.keys()));c(n)},D=()=>t.clear(),o=e=>f(e).length,I=e=>x(e).length,T=e=>{var n;return e?((n=t.get(e))==null?void 0:n.index)??-1:-1},C=(e,n)=>e==null?-1:x(n).findIndex(s=>s.node.isSameNode(e)),f=e=>{const n=Array.from(t.values());return e?n.filter(e).sort((s,a)=>s.index-a.index):n.sort((s,a)=>s.index-a.index)},x=e=>f(e).filter(({disabled:n})=>!n),l=(e,n)=>{if(o(n)!==0)return f(n)[e]},i=(e,n)=>{if(I(n)!==0)return x(n)[e]};return{count:o,destroy:D,enabledCount:I,enabledFirstValue:e=>i(0,e),enabledIndexOf:C,enabledLastValue:e=>i(x(e).length-1,e),enabledNextValue:(e,n,s=!0)=>{const a=l(e);if(!a)return;const N=C(a.node,n),O=V(N,I(n),s);return i(O,n)},enabledPrevValue:(e,n,s=!0)=>{const a=l(e);if(!a)return;const N=C(a.node,n),O=m(N,I(n)-1,s);return i(O,n)},enabledValue:i,enabledValues:x,firstValue:e=>l(0,e),indexOf:T,lastValue:e=>l(t.size-1,e),nextValue:(e,n,s=!0)=>{const a=V(e,o(n),s);return l(a,n)},prevValue:(e,n,s=!0)=>{const a=m(e,o(n)-1,s);return l(a,n)},register:r,unregister:d,value:l,values:f}},h=()=>{const t=g.useRef(y());return E(()=>()=>t.current.destroy()),t.current},[A,P]=_({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsContextProvider"}),L=t=>{const c=P(),[u,r]=g.useState(-1),d=g.useRef(null);E(()=>()=>{d.current&&c.unregister(d.current)},[]),E(()=>{if(!d.current)return;const o=Number(d.current.dataset.index);u!=o&&!Number.isNaN(o)&&r(o)});const D=t?b(c.register(t)):b(c.register);return{descendants:c,enabledIndex:c.enabledIndexOf(d.current,t==null?void 0:t.filter),index:u,register:S(D,d)}},j=()=>({DescendantsContextProvider:b(A),useDescendant:t=>L(t),useDescendants:()=>h(),useDescendantsContext:()=>b(P())});export{j as c};
