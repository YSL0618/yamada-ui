import{j as m}from"./jsx-runtime-CfatFE5O.js";import{f as ie}from"./forward-ref-D13m8o2p.js";import{p as Bt,a as R,c as Z,q as vt,j as Ht,J as ae,E as Be,a4 as zt,g as Gt,aq as $t,h as J,d as xe,w as Ie,b as ke,C as bt,f as Ae,Y as yt,a9 as At,Z as Jt,am as Kt,_ as Ut,$ as Te,u as qt,X as Yt}from"./factory-BPYpkDor.js";import{r as t}from"./index-ClcD9ViR.js";import{b as Wt}from"./popover-trigger-BK228ndd.js";import{u as Xt}from"./index-5_K1p_ZM.js";import{u as Zt}from"./index-CZjm_Dlq.js";import{u as Qt}from"./index-B6_HQi_x.js";import{c as es}from"./index-LBOEXu_2.js";import{u as ts}from"./index-B-CNuTHF.js";import{c as ss,a as os}from"./icon-DT11Nal8.js";import{c as ns,f as ls}from"./form-control-BcwAaE7G.js";const{DescendantsContextProvider:js,useDescendant:as,useDescendants:is,useDescendantsContext:Qe}=es(),[Es,M]=Bt({name:"AutocompleteContext",errorMessage:`useAutocompleteContext returned is 'undefined'. Seems you forgot to wrap the components in "<Autocomplete />" or "<MultiAutocomplete />"`}),et=ie(({className:l,children:o,__css:s,...a},u)=>{const{styles:c}=M(),d={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...c.icon,...s},x=vt(o).map(b=>t.cloneElement(b,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return m.jsx(R.div,{ref:u,className:Z("ui-autocomplete__icon",l),__css:d,...a,children:Ht(o)?x:m.jsx(ss,{})})});et.displayName="AutocompleteIcon";et.__ui__="AutocompleteIcon";const It=({className:l,children:o,...s})=>{const a=t.useRef(null),{styles:u}=M(),c=s.disabled,d=ts({ref:a,isDisabled:c,...s});return m.jsx(et,{className:Z("ui-autocomplete__icon--clear",l),"aria-label":"Clear value",__css:u.clearIcon,...d,children:o??m.jsx(os,{h:"0.5em",w:"0.5em"})})};It.displayName="AutocompleteClearIcon";It.__ui__="AutocompleteClearIcon";const Se=ie(({className:l,...o},s)=>{const{styles:a}=M(),u={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...a.itemIcon};return m.jsx(R.span,{ref:s,className:Z("ui-autocomplete__item__icon",l),__css:u,...o})});Se.displayName="AutocompleteItemIcon";Se.__ui__="AutocompleteItemIcon";const cs=l=>{var o;return $t(l)&&!!((o=l.getAttribute("role"))!=null&&o.startsWith("option"))},rs=l=>{var je;const{closeOnSelect:o,focusedIndex:s,inputRef:a,omitSelectedValues:u,setFocusedIndex:c,value:d,optionProps:p,onChange:x,onClose:b,onFocusNext:P}=M(),G=t.useId(),k=t.useRef(null);let{id:f,children:I,closeOnSelect:N,disabled:A,focusable:w,icon:C,isDisabled:S,isFocusable:D,value:_,...ce}={...p,...l};A??(A=S),w??(w=D);const Pe=!!A&&!w,{descendants:Ce,index:Y,register:ge}=as({disabled:Pe}),Oe=Ce.values().slice(0,Y),he=ae(d),W=Oe.some(({node:T})=>T.dataset.value===(_??"")),Q=!W&&(he?d.includes(_??""):(_??"")===d),re="target"in(((je=k.current)==null?void 0:je.dataset)??{}),be=Y===s;f??(f=G),Be(_)&&(zt(I)||Gt(I)?_=I.toString():console.warn(`${he?"MultiAutocomplete":"Autocomplete"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`));const we=t.useCallback(T=>{if(T.stopPropagation(),A||!cs(T.currentTarget)){a.current&&a.current.focus();return}W||c(Y),x(_??""),a.current&&a.current.focus(),(N??o)&&b(),u&&P(Y)},[W,P,u,A,_,c,Y,x,N,o,b,a]),ze=t.useCallback((T={},Ee=null)=>{const Ne=!re||u&&Q,ue={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ke(k,Ee,ge),role:"option",...ce,...T,id:f,style:Ne?ue:void 0,"aria-disabled":Ie(A),"aria-hidden":Ie(Ne),"aria-selected":Q,"data-disabled":xe(A),"data-duplicated":xe(W),"data-focus":xe(be),"data-target":xe(!0),"data-value":_??"",tabIndex:-1,onClick:J(ce.onClick,T.onClick,we)}},[f,W,_,ce,A,be,Q,re,u,we,ge]);return{children:I,customIcon:C,isFocused:be,isSelected:Q,isTarget:re,omitSelectedValues:u,getOptionProps:ze}},us=()=>{const{isHit:l,onCreate:o}=M();return{getCreateProps:t.useCallback((a={},u=null)=>({ref:u,role:"option",...a,style:l?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":Ie(l),"data-focus":xe(!l),tabIndex:-1,onClick:J(a.onClick,o)}),[l,o])}},ds=()=>{const{isEmpty:l,isHit:o}=M();return{getEmptyProps:t.useCallback((a={},u=null)=>{const c=o&&!l;return{ref:u,role:"presentation",...a,style:c?{border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"}:void 0,"aria-hidden":Ie(c),tabIndex:-1}},[o,l])}},kt=ie(({className:l,children:o,icon:s,...a},u)=>{const{inputValue:c,styles:d}=M(),{getCreateProps:p}=us();o??(o=c);const x={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return m.jsxs(R.div,{className:Z("ui-autocomplete__item--create",l),__css:x,...p(a,u),children:[s!==null?m.jsx(Se,{children:s||m.jsx(tt,{})}):null,s?m.jsx(R.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:bt(o,c)}):bt(o,c)]})});kt.displayName="AutocompleteCreate";kt.__ui__="AutocompleteCreate";const tt=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 45.402 45.402",width:"1em",children:m.jsx("path",{d:"M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141   c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27   c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435   c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z",fill:"currentColor"})});tt.displayName="AutocompletePlusIcon";tt.__ui__="AutocompletePlusIcon";const St=ie(({className:l,children:o,icon:s,...a},u)=>{const{emptyMessage:c,styles:d}=M(),{getEmptyProps:p}=ds();o??(o=c);const x={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,pointerEvents:"none",textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...d.item};return m.jsxs(R.div,{className:Z("ui-autocomplete__item--empty",l),__css:x,...p(a,u),children:[s!==null?m.jsx(Se,{children:s||m.jsx(st,{})}):null,s?m.jsx(R.span,{style:{flex:1,pointerEvents:"none"},lineClamp:1,children:o}):o]})});St.displayName="AutocompleteEmpty";St.__ui__="AutocompleteEmpty";const st=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 448 512",width:"1em",children:m.jsx("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z",fill:"currentColor"})});st.displayName="AutocompleteMinusIcon";st.__ui__="AutocompleteMinusIcon";const ps=()=>{const{focusedIndex:l,isOpen:o,listRef:s,rebirthOptions:a,value:u}=M(),c=Qe(),d=t.useId(),p=t.useRef(-1),x=c.value(l),b=ae(u),P=t.useCallback(()=>{o||a(!1)},[o,a]);return t.useEffect(()=>{if(!s.current||!x||p.current===x.index)return;const k=s.current,f=x.node,I=k.clientHeight,N=k.scrollTop,A=N+I,w=f.clientHeight,C=f.offsetTop,S=C+w,D=N<=C&&S<=A,_=p.current<x.index;D||(S<=I?s.current.scrollTo({top:0}):_?s.current.scrollTo({top:S-I}):s.current.scrollTo({top:C+1})),p.current=x.index},[s,x]),Ae(()=>{o||(p.current=-1)},[o]),{getListProps:t.useCallback(({id:k,...f}={},I=null)=>({id:k??d,ref:ke(s,I),"aria-multiselectable":Ie(b),position:"relative",role:"listbox",tabIndex:-1,...f}),[s,d,b]),onAnimationComplete:P}},Pt=ie(({className:l,children:o,footer:s,header:a,maxW:u,maxWidth:c,minW:d,minWidth:p,w:x,width:b,contentProps:P,...G},k)=>{var A,w,C,S,D,_;const{styles:f}=M(),{getListProps:I,onAnimationComplete:N}=ps();return b??(b=x),b??(b=((A=f.list)==null?void 0:A.width)??((w=f.list)==null?void 0:w.w)),p??(p=d),p??(p=((C=f.list)==null?void 0:C.minWidth)??((S=f.list)==null?void 0:S.minW)),c??(c=u),c??(c=((D=f.list)==null?void 0:D.maxWidth)??((_=f.list)==null?void 0:_.maxW)),m.jsxs(Wt,{className:"ui-autocomplete__popover",maxWidth:c,minWidth:p,width:b,__css:{...f.content,maxWidth:c,minWidth:p,width:b},...P,onAnimationComplete:J(P==null?void 0:P.onAnimationComplete,N),children:[a?m.jsx(R.header,{className:"ui-autocomplete__header",__css:{...f.header},children:a}):null,m.jsx(R.div,{className:Z("ui-autocomplete__list",l),__css:{...f.list},...I(G,k),children:o}),s?m.jsx(R.footer,{className:"ui-autocomplete__footer",__css:{...f.footer},children:s}):null]})});Pt.displayName="AutocompleteList";Pt.__ui__="AutocompleteList";const He=ie(({className:l,icon:o,...s},a)=>{const{styles:u}=M(),{children:c,customIcon:d,isSelected:p,getOptionProps:x}=rs(s);o??(o=d);const b={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...u.item};return m.jsxs(R.div,{className:Z("ui-autocomplete__item",l),__css:b,...x({},a),children:[o!==null?m.jsx(Se,{opacity:p?1:0,children:o||m.jsx(ot,{})}):null,m.jsx(R.span,{style:{flex:1},"data-label":!0,children:c})]})});He.displayName="AutocompleteOption";He.__ui__="AutocompleteOption";const ot=()=>m.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:m.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})});ot.displayName="AutocompleteCheckIcon";ot.__ui__="AutocompleteCheckIcon";const ms=({label:l,...o})=>{const{omitSelectedValues:s,value:a}=M(),u=Qe(),c=t.useRef(null),d=t.useId(),p=u.values(),P=(ae(a)&&s?u.values(({node:C})=>a.includes(C.dataset.value??"")):[]).map(({index:C})=>C),k=!p.filter(({index:C,node:S})=>{var D;return((D=S.parentElement)==null?void 0:D.dataset.label)===l&&!P.includes(C)&&"target"in S.dataset}).length,[f,I]=yt(o,At),N=t.useCallback((C={},S=null)=>{var _;const D={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:S,"aria-labelledby":(_=c.current)==null?void 0:_.id,role:"group",...C,...f,style:k?D:void 0}},[f,k]),A=t.useCallback(({id:C,...S}={},D=null)=>({id:C??d,ref:ke(D,c),role:"presentation",...S}),[d]),w=t.useCallback((C={},S=null)=>({ref:S,...C,...I,"data-label":l}),[I,l]);return{label:l,getContainerProps:N,getGroupProps:w,getLabelProps:A}},nt=ie(({className:l,children:o,color:s,h:a,height:u,minH:c,minHeight:d,labelProps:p,...x},b)=>{const{styles:P}=M(),{label:G,getContainerProps:k,getGroupProps:f,getLabelProps:I}=ms(x);return a??(a=u),c??(c=d),m.jsxs(R.section,{className:Z("ui-autocomplete__item","ui-autocomplete__item--group",l),__css:{color:s,h:"fit-content",w:"100%"},...k(),children:[m.jsx(R.header,{className:"ui-autocomplete__item__group-label",lineClamp:1,__css:P.groupLabel,...I(p),children:G}),m.jsx(R.div,{...f({},b),className:"ui-autocomplete__item__group",__css:{h:a,minH:c,...P.group},children:o})]})});nt.displayName="AutocompleteOptionGroup";nt.__ui__="AutocompleteOptionGroup";const _t={"｡":"。","｢":"「","｣":"」","､":"、","･":"・",ｦ:"ヲ",ｦﾞ:"ヺ",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ",ｯ:"ッ",ｰ:"ー",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｳﾞ:"ヴ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｶﾞ:"ガ",ｷ:"キ",ｷﾞ:"ギ",ｸ:"ク",ｸﾞ:"グ",ｹ:"ケ",ｹﾞ:"ゲ",ｺ:"コ",ｺﾞ:"ゴ",ｻ:"サ",ｻﾞ:"ザ",ｼ:"シ",ｼﾞ:"ジ",ｽ:"ス",ｽﾞ:"ズ",ｾ:"セ",ｾﾞ:"ゼ",ｿ:"ソ",ｿﾞ:"ゾ",ﾀ:"タ",ﾀﾞ:"ダ",ﾁ:"チ",ﾁﾞ:"ヂ",ﾂ:"ツ",ﾂﾞ:"ヅ",ﾃ:"テ",ﾃﾞ:"デ",ﾄ:"ト",ﾄﾞ:"ド",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾊﾞ:"バ",ﾊﾟ:"パ",ﾋ:"ヒ",ﾋﾞ:"ビ",ﾋﾟ:"ピ",ﾌ:"フ",ﾌﾞ:"ブ",ﾌﾟ:"プ",ﾍ:"ヘ",ﾍﾞ:"ベ",ﾍﾟ:"ペ",ﾎ:"ホ",ﾎﾞ:"ボ",ﾎﾟ:"ポ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ﾜﾞ:"ヷ",ﾝ:"ン"},fs=l=>{l=l.replace(/[！-～]/g,s=>String.fromCharCode(s.charCodeAt(0)-65248));const o=new RegExp("("+Object.keys(_t).join("|")+")","g");return l=l.replace(o,s=>_t[s]).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜"),l=l.toUpperCase(),l},xs=l=>{const o=s=>s.map(a=>{const{disabled:u,focusable:c}=a;if(!(u&&!c))return"items"in a?o(a.items??[]):a}).filter(Boolean);return o(l).flat(1/0)},Ns=l=>{const{allowCreate:o=!1,allowFree:s=!1,animation:a,boundary:u,children:c,closeDelay:d,closeOnBlur:p=!0,closeOnEsc:x=!0,closeOnSelect:b=!0,defaultIsOpen:P,defaultValue:G,duration:k=.2,emptyMessage:f="No results found",eventListeners:I,flip:N,format:A=fs,gutter:w,insertPositionItem:C="first",isLazy:S,isOpen:D,items:_,lazyBehavior:ce,matchWidth:Pe=!0,maxSelectValues:Ce,modifiers:Y,offset:ge,omitSelectedValues:E=!1,openDelay:Oe,placeholder:he,placement:W="bottom-start",preventOverflow:Q,strategy:re,value:be,optionProps:we,onChange:ze,onClose:je,onCreate:T,onKeyDown:Ee,onOpen:Ne,onSearch:ue,...de}=ns(l),{"aria-readonly":Cs,onFocus:lt,...z}=Jt(de,ls),[at,Ot]=yt(de,At),{id:wt}=de,v=is(),Ge=t.useRef(null),it=t.useRef(null),ee=t.useRef(null),te=t.useRef(new Set([])),$e=t.useRef(!1),ct=t.useRef(void 0),[se,rt]=t.useState(_?JSON.parse(JSON.stringify(_)):void 0),[j,De]=Xt({defaultValue:G,value:be,onChange:ze}),[Je,Ke]=t.useState(void 0),[V,pe]=t.useState(""),[K,O]=t.useState(-1),[oe,ut]=t.useState(!1),[me,dt]=t.useState(!0),{isOpen:g,onClose:B,onOpen:pt}=Zt({defaultIsOpen:P,isOpen:D,onClose:je,onOpen:Ne}),_e=K>-1,Ue=K===-2&&o,h=ae(j),Ve=h?!j.length:!j,[ve,mt]=t.useMemo(()=>ae(C)?C:[C,"first"],[C]);o&&!Be(c)&&console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: ${h?"MultiAutocomplete":"Autocomplete"} internally prefers 'children'. If 'allowCreate' is true, it will not be reflected correctly. If want to reflect, please set 'items' in props.`);const U=v.enabledValues(({node:e})=>h&&j.includes(e.dataset.value??"")).map(({index:e})=>e),$=v.enabledValues(({index:e,node:n})=>"target"in n.dataset&&!U.includes(e)),jt=vt(c),Fe=t.useMemo(()=>se==null?void 0:se.map((e,n)=>{if("value"in e){const{label:i,value:r,...y}=e;return m.jsx(He,{value:r,...y,children:i},n)}else if("items"in e){const{items:i=[],label:r,...y}=e;return m.jsx(nt,{label:r,...y,children:i.map(({label:L,value:le,...Ze},Tt)=>m.jsx(He,{value:le,...Ze,children:L},Tt))},n)}}).filter(Boolean),[se]),ne=!jt.length&&!(Fe!=null&&Fe.length),F=t.useCallback(()=>{z.disabled||z.readOnly||!o&&(ne||oe)||(pt(),ee.current&&ee.current.focus())},[o,z,oe,ne,pt]),fe=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const n=v.enabledFirstValue(({node:i})=>"target"in i.dataset);if(n)if(!h||!E)O(n.index);else if(U.includes(n.index)){const i=$[0];O((i==null?void 0:i.index)??-1)}else O(n.index)});te.current.add(e)},[v,$,oe,ne,h,E,U]),Re=t.useCallback(()=>{const e=setTimeout(()=>{if(ne||oe)return;const n=v.enabledLastValue(({node:i})=>"target"in i.dataset);if(n)if(!h||!E)O(n.index);else if(U.includes(n.index)){const i=$.reverse()[0];O((i==null?void 0:i.index)??-1)}else O(n.index)});te.current.add(e)},[v,$,oe,ne,h,E,U]),qe=t.useCallback(()=>{const e=setTimeout(()=>{const i=v.enabledValues().find(({node:r})=>h?j.includes(r.dataset.value??""):r.dataset.value===j);i&&O(i.index)});te.current.add(e)},[v,h,j]),ye=t.useCallback((e=K)=>{const n=setTimeout(()=>{const i=v.enabledNextValue(e,({node:r})=>"target"in r.dataset);if(i)if(!h||!E)O(i.index);else if(U.includes(i.index)){const r=$.find(({index:y})=>i.index<y)??$[0];O((r==null?void 0:r.index)??-1)}else O(i.index)});te.current.add(n)},[v,$,K,h,E,U]),Ye=t.useCallback((e=K)=>{const n=setTimeout(()=>{const i=v.enabledPrevValue(e,({node:r})=>"target"in r.dataset);if(i)if(!h||!E)O(i.index);else if(U.includes(i.index)){const r=$.reverse().find(({index:y})=>y<i.index)??$[0];O((r==null?void 0:r.index)??-1)}else O(i.index)});te.current.add(n)},[v,$,K,h,E,U]),X=Ve||E?fe:qe,ft=Ve||E?Re:qe,We=t.useCallback(e=>{const n=v.values();let i=!1,r=!1;n.forEach(({index:y,node:L})=>{if(A(L.textContent??"").includes(e)){i=!0;const le="disabled"in L.dataset;L.dataset.target="",!r&&!le&&(r=!0,O(y))}else delete L.dataset.target}),dt(i)},[v,A]),q=t.useCallback((e=!0)=>{v.values().forEach(({node:i})=>{i.dataset.target=""}),e&&fe(),dt(!0)},[v,fe]),Et=t.useCallback(e=>{const n=v.values();if(!n.length)return;const r=(ae(e)?e:[e]).map(y=>{const{node:L}=n.find(({node:le})=>le.dataset.value===y)??{};if(L){const{textContent:le}=Array.from(L.children).find(Ze=>Ze.getAttribute("data-label")!==null)??{};return le}else return s?y:void 0}).filter(y=>!Be(y));Ke(h?r:r[0])},[s,v,h]),H=t.useCallback((e,n=!0)=>{De(i=>{let r;return ae(i)?i.includes(e)?r=i.filter(L=>L!==e):r=[...i,e]:r=e,ct.current=r,r}),pe(""),h&&n&&q(!1)},[h,q,De]),Xe=t.useCallback(()=>{let e=v.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const n=e.node.dataset.value??"";H(n),b&&B(),E&&ye()},[b,v,K,E,H,B,ye]),Nt=t.useCallback(e=>{g||F(),ue==null||ue(e);const n=e.target.value,i=A(n);i?We(i):q(),pe(n)},[g,F,A,ue,We,q]),Dt=t.useCallback(()=>{$e.current=!0},[]),Vt=t.useCallback(()=>{$e.current=!1},[]),Me=t.useCallback(()=>{if(!it.current)return;const e={label:V,value:V};let n=[];if(se&&(n=[...se]),ve==="first")n=[e,...n];else if(ve==="last")n=[...n,e];else{const r=n.findIndex(({label:L})=>L===ve),y=n[r];r!==-1&&y&&"items"in y?(mt==="first"?y.items=[e,...y.items??[]]:y.items=[...y.items??[],e],n[r]=y):console.warn(`${h?"MultiAutocomplete":"Autocomplete"}: '${ve}' specified in insertPositionItem does not exist in the option group.`)}rt(n),H(V),q(!1);const i=xs(n).findIndex(({value:r})=>r===V);O(i),T==null||T(e,n)},[V,se,ve,H,q,T,mt,h]),xt=t.useCallback(()=>{g?ee.current&&ee.current.focus():(F(),X())},[g,X,F]),Le=t.useCallback(()=>{g||(F(),X())},[g,X,F]),Ct=t.useCallback(e=>{const n=Kt(e);Ut(Ge.current,n)||!p&&me||(s&&V&&H(V,!1),pe(""),g&&B())},[p,me,g,V,s,B,H]),gt=t.useCallback(()=>{H(h?j[j.length-1]:""),g||Le()},[h,g,H,Le,j]),Ft=t.useCallback(e=>{e.stopPropagation(),ct.current=[],De([]),Ke(void 0),pe(""),q(),g&&ee.current&&ee.current.focus()},[g,Ke,pe,De,q]),ht=t.useCallback(e=>{if(e.key===" "&&(e.key=e.code),z.disabled||z.readOnly||$e.current)return;const n=Je===V||!V.length,r={ArrowDown:_e?()=>ye():g?void 0:Te(F,X),ArrowUp:_e?()=>Ye():g?void 0:Te(F,ft),Backspace:!Ve&&n?gt:void 0,End:g?Re:void 0,Enter:Ue?Me:_e?Xe:g?s&&h?()=>{V&&H(V),O(0)}:void 0:Te(F,X),Escape:x?B:void 0,Home:g?fe:void 0,Space:Ue?Me:_e?Xe:g?void 0:Te(F,X)}[e.key];r&&(e.preventDefault(),e.stopPropagation(),r(e))},[s,z,Je,V,F,_e,h,X,ye,ft,Ye,Ue,Me,Xe,g,fe,Re,x,B,Ve,gt,H]);t.useEffect(()=>{if(!h||!E&&Be(Ce))return;const e=j.length>0&&j.length===v.count(),n=j.length===Ce;e||n?(B(),ut(!0)):ut(!1)},[E,j,v,h,B,Ce]),qt(()=>{Et(j)},[j]),Ae(()=>{g||s||(O(-1),pe(""))},[g]),Ae(()=>{me||O(-2)},[me]),Ae(()=>{rt(_?JSON.parse(JSON.stringify(_)):void 0)},[_]),Yt(()=>{te.current.forEach(e=>clearTimeout(e)),te.current.clear()}),Qt({ref:Ge,enabled:g&&(p||!me),handler:B});const Rt=t.useCallback(e=>({animation:a,boundary:u,closeDelay:d,closeOnBlur:p,duration:k,eventListeners:I,flip:N,gutter:w,isLazy:S,lazyBehavior:ce,matchWidth:Pe,modifiers:Y,offset:ge,openDelay:Oe,placement:W,preventOverflow:Q,strategy:re,...e,closeOnButton:!1,isOpen:g,trigger:"never",onClose:B,onOpen:F}),[p,Oe,d,S,ce,a,k,ge,w,Q,N,Pe,u,I,re,W,Y,g,F,B]),Mt=t.useCallback((e={},n=null)=>({ref:ke(Ge,n),...at,...e,...z,onBlur:J(e.onBlur,de.onBlur,Ct),onClick:J(e.onClick,de.onClick,xt)}),[at,z,Ct,xt,de]),Lt=t.useCallback((e={},n=null)=>({ref:n,tabIndex:-1,...e,...z,"data-active":xe(g),placeholder:he,onFocus:J(e.onFocus,lt,Le),onKeyDown:J(e.onKeyDown,Ee,ht)}),[z,he,g,lt,Le,Ee,ht]);return{id:wt,allowCreate:o,allowFree:s,children:c??Fe,closeOnSelect:b,descendants:v,emptyMessage:f,focusedIndex:K,inputRef:ee,inputValue:V,isAllSelected:oe,isEmpty:ne,isHit:me,isOpen:g,label:Je,listRef:it,omitSelectedValues:E,pickOptions:We,rebirthOptions:q,setFocusedIndex:O,value:j,formControlProps:z,getContainerProps:Mt,getFieldProps:Lt,getPopoverProps:Rt,inputProps:Ot,optionProps:we,onChange:H,onClear:Ft,onClose:B,onCompositionEnd:Vt,onCompositionStart:Dt,onCreate:Me,onFocusFirst:fe,onFocusLast:Re,onFocusNext:ye,onFocusPrev:Ye,onFocusSelected:qe,onOpen:F,onSearch:Nt}},Ds=()=>{var N,A;const{id:l,focusedIndex:o,inputRef:s,isAllSelected:a,isOpen:u,listRef:c,formControlProps:d,inputProps:p,onCompositionEnd:x,onCompositionStart:b,onSearch:P}=M(),k=(N=Qe().value(o))==null?void 0:N.node.id,f=(A=c.current)==null?void 0:A.id;return Ae(()=>{a&&s.current&&s.current.blur()},[a]),{getInputProps:t.useCallback((w={},C=null)=>({ref:ke(s,C),...d,"aria-activedescendant":k,"aria-autocomplete":"list","aria-controls":f,"aria-expanded":u,"aria-haspopup":"listbox",autoCapitalize:"none",autoComplete:"off",role:"combobox",spellCheck:"false",tabIndex:a?-1:0,...p,...w,id:l,cursor:d.readOnly?"default":"text",pointerEvents:d.disabled||a?"none":"auto",onChange:J(w.onChange,P),onCompositionEnd:J(w.onCompositionEnd,p.onCompositionEnd,x),onCompositionStart:J(w.onCompositionStart,p.onCompositionStart,b)}),[f,k,u,p,s,d,l,a,P,b,x])}};export{js as A,Es as a,M as b,Ds as c,et as d,Pt as e,kt as f,St as g,He as h,nt as i,It as j,Ns as u};
