import{j as n}from"./extends-CwFRzn3r.js";import{u as be}from"./index-423R83gY.js";import{r as p}from"./index-BwDkhjyp.js";import{u as ye,l as ve,S as Pe,k as le,a2 as se,f as oe,h as k,c as H,b as D,r as je,B as we}from"./factory-DfCPDZht.js";import{u as ke,f as Ee}from"./form-control-DrDTnnc0.js";import{e as De,c as re,h as Q,i as Re,r as Ne,p as Me,j as Te,k as Ve,o as Ae}from"./theme-provider-Bw55Thfs.js";import{I as He}from"./icon-button-Cxlm05Fi.js";import{b as Oe}from"./icon-BY9dMEpR.js";import{f as O}from"./forward-ref-BWI-Phbn.js";import{A as Le}from"./alpha-slider-7aERn0IX.js";import{H as Be}from"./hue-slider-Dd9CmAc0.js";import{C as ue}from"./color-swatch-D4dIPN0Z.js";import{I as Fe}from"./input-YkEawIv7.js";import{S as We}from"./saturation-slider-MLotA35C.js";import{a as Ie}from"./use-component-style-D0DGb12b.js";const $e=()=>{const[s,u]=p.useState(!1);ye(()=>{u(typeof window<"u"&&"EyeDropper"in window)},[]);const t=p.useCallback((l={})=>s?new window.EyeDropper().open(l):Promise.resolve(void 0),[s]);return{supported:s,onOpen:t}},ce=(s,u)=>{let[t,l,c,i]=Me(s,u)??[0,0,1,1];return i>1&&(i=1),{h:t,s:l,l:c,a:i}},ie=(s,u)=>{let[t,l,c,i]=Te(s,u)??[255,255,255,1];return t>255&&(t=255),l>255&&(l=255),c>255&&(c=255),i>1&&(i=1),{r:t,g:l,b:c,a:i}},ae=(s,u)=>{const[t,l,c,i]=Ve(s,u);return{h:t,s:l,v:c,a:i}},[ze,W]=ve({name:"ColorSelectorContext",errorMessage:`useColorSelectorContext returned is 'undefined'. Seems you forgot to wrap the components in "<ColorSelector />"`}),Ge=({isInvalid:s,...u})=>{const{id:t,name:l,value:c,defaultValue:i,fallbackValue:o,onChange:d,onChangeStart:C,onChangeEnd:b,format:y,onSwatchClick:g,...x}=ke({isInvalid:s,...u}),[{"aria-readonly":R,required:v,disabled:f,readOnly:S,...L},G]=Pe(x,Ee),q=le(C),U=le(b),{supported:X,onOpen:Z}=$e(),[V,J]=be({value:c,defaultValue:i??o,onChange:d}),m=p.useMemo(()=>y??De(V??"#ffffff"),[V,y]),P=re(V,"#ffffff")(m),I=p.useRef(void 0),B=p.useRef(!1),[A,$]=p.useState(ae(P,o)),{h:E,s:N,v:M,a:z}=A,K=m.endsWith("a"),he=!(f||S),pe=p.useMemo(()=>{if(P.startsWith("hsl")){const{h:e,s:a,l:r,a:h}=ce(P,o);let _=[{label:"H",space:"h",value:Math.round(e),min:0,max:360},{label:"S(%)",space:"s",value:Math.round(a*100),min:0,max:100},{label:"L(%)",space:"l",value:Math.round(r*100),min:0,max:100}];return K&&(_=[..._,{label:"A(%)",space:"a",value:Math.round(h*100),min:0,max:100}]),_}else{const{r:e,g:a,b:r,a:h}=ie(P,o);let _=[{label:"R",space:"r",value:Math.round(e),min:0,max:255},{label:"G",space:"g",value:Math.round(a),min:0,max:255},{label:"B",space:"b",value:Math.round(r),min:0,max:255}];return K&&(_=[..._,{label:"A(%)",space:"a",value:Math.round(h*100),min:0,max:100}]),_}},[P,K,o]),j=p.useCallback(e=>{se(e)?$(ae(e,o)):$(a=>({...a,...e}))},[o]),F=p.useCallback(e=>{window.clearTimeout(I.current),B.current=!0;const{h:a,s:r,v:h,a:_}={...A,...e},T=Q([a,r,h,_],o)(m);T&&q(T)},[q,o,A,m]),w=p.useCallback(e=>{window.clearTimeout(I.current),I.current=window.setTimeout(()=>{B.current=!1},200);let a;if(se(e))a=re(e,o)(m);else{const{h:r,s:h,v:_,a:T}={...A,...e};a=Q([r,h,_,T],o)(m)}a&&U(a)},[U,o,A,m]),te=p.useCallback((e,a)=>{let r=Math.floor(parseFloat(e.target.value));isNaN(r)&&(r=0),["s","l","a"].includes(a)&&(r=r/100);let h;if(P.startsWith("hsl")){const{h:_,s:T,l:Y,a:ee}=Object.assign(ce(P,o),{[a]:r});h=Re([_,T,Y,ee],o)(m)}else{const{r:_,g:T,b:Y,a:ee}=Object.assign(ie(P,o),{[a]:r});h=Ne([_,T,Y,ee],o)(m)}h&&(j(h),w(h))},[P,j,w,o,m]),ne=p.useCallback(async()=>{try{const{sRGBHex:e}=await Z()??{};if(!e)return;j(e),w(e)}catch{}},[Z,j,w]);oe(()=>{const e=Q([E,N,M,z],o)(m);e&&J(e)},[E,N,M,z]),oe(()=>{B.current||c&&$(ae(c,o))},[c]),oe(()=>{if(!m||!V)return;const e=re(V,o)(m);e&&J(e)},[m]);const de=p.useCallback((e={},a=null)=>({...e,ref:a,...L,...G}),[G,L]),fe=p.useCallback((e={},a=null)=>({...L,"aria-readonly":R,...e,id:t,ref:a,type:"hidden",name:l,value:P,required:v,disabled:f,readOnly:S}),[L,R,t,l,P,v,f,S]),me=p.useCallback((e={},a=null)=>({required:v,disabled:f,readOnly:S,isInvalid:s,...e,ref:a,value:[E,N,M],onChange:k(e.onChange,([,r,h])=>j({s:r,v:h})),onChangeStart:k(e.onChangeStart,([,r,h])=>F({s:r,v:h})),onChangeEnd:k(e.onChangeEnd,([,r,h])=>w({s:r,v:h}))}),[v,f,S,s,E,N,M,j,F,w]),Ce=p.useCallback((e={},a=null)=>({required:v,disabled:f,readOnly:S,isInvalid:s,...e,ref:a,value:E,onChange:k(e.onChange,r=>j({h:r})),onChangeStart:k(e.onChangeStart,r=>F({h:r})),onChangeEnd:k(e.onChangeEnd,r=>w({h:r}))}),[v,f,S,s,E,j,F,w]),ge=p.useCallback((e={},a=null)=>({required:v,disabled:f,readOnly:S,isInvalid:s,...e,ref:a,value:z,color:Q([E,N,M,z],o)(m),onChange:k(e.onChange,r=>j({a:r})),onChangeStart:k(e.onChangeStart,r=>F({a:r})),onChangeEnd:k(e.onChangeEnd,r=>w({a:r}))}),[o,v,f,S,s,m,E,N,M,z,j,F,w]),Se=p.useCallback(({space:e,...a},r=null)=>({required:v,disabled:f,readOnly:S,isInvalid:s,...a,ref:r,type:"number",step:1,onChange:k(a.onChange,h=>te(h,e))}),[v,f,S,s,te]),xe=p.useCallback((e={},a=null)=>({disabled:f,"aria-label":"Pick a color",...e,ref:a,onClick:k(e.onClick,ne)}),[f,ne]),_e=p.useCallback(({color:e,...a}={},r=null)=>({"aria-label":`Select ${e} as the color`,disabled:f,readOnly:S,...a,ref:r,color:e,onClick:k(a.onClick,()=>{se(e)&&(g==null||g(e),j(e),w(e))})}),[f,S,g,j,w]);return{value:P,onChange:j,eyeDropperSupported:X,withAlpha:K,isInteractive:he,disabled:f,readOnly:S,channels:pe,getContainerProps:de,getInputProps:fe,getSaturationSliderProps:me,getHueSliderProps:Ce,getAlphaSliderProps:ge,getEyeDropperProps:xe,getChannelProps:Se,getSwatchProps:_e}},qe=O(({className:s,...u},t)=>{const{getEyeDropperProps:l,readOnly:c,size:i,styles:o}=W(),d={h:"auto",minW:"auto",pointerEvents:c?"none":void 0,...o.eyeDropper};return n.jsx(He,{className:H("ui-color-selector__eye-dropper",s),variant:"outline",size:i,__css:d,...l(u,t),children:n.jsx(Ue,{className:"ui-color-selector__eye-dropper__icon"})})}),Ue=({...s})=>n.jsxs(Oe,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[n.jsx("path",{d:"m2 22 1-1h3l9-9"}),n.jsx("path",{d:"M3 21v-3l9-9"}),n.jsx("path",{d:"m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8a2.1 2.1 0 1 1 3-3l.4.4Z"})]}),Ze=O(({className:s,hueSliderRef:u,hueSliderProps:t,alphaSliderRef:l,alphaSliderProps:c,...i},o)=>{let{size:d,withAlpha:C,getHueSliderProps:b,getAlphaSliderProps:y,styles:g}=W();d==="full"&&(d="lg");const x={display:"flex",flexDirection:"column",...g.sliders};return n.jsxs(D.div,{ref:o,className:H("ui-color-selector__sliders",s),__css:x,...i,children:[n.jsx(Be,{size:d,className:"ui-color-selector__hue-slider",__css:{...g.hueSlider},...b(t,u)}),C?n.jsx(Le,{size:d,className:"ui-color-selector__alpha-slider",__css:{...g.alphaSlider},...y(c,l)}):null]})}),Je=O(({className:s,withEyeDropper:u=!0,withResult:t,eyeDropperRef:l,eyeDropperProps:c,hueSliderRef:i,hueSliderProps:o,alphaSliderRef:d,alphaSliderProps:C,...b},y)=>{const{value:g,eyeDropperSupported:x,styles:R}=W(),v={display:"flex",w:"100%",...R.body};return n.jsxs(D.div,{ref:y,className:H("ui-color-selector__body",s),__css:v,...b,children:[n.jsx(Ze,{hueSliderRef:i,hueSliderProps:o,alphaSliderRef:d,alphaSliderProps:C}),u&&x?n.jsx(qe,{ref:l,...c}):null,t?n.jsx(ue,{className:"ui-color-selector__result",color:g,__css:{...R.result}}):null]})}),Ke=O(({className:s,channelProps:u,...t},l)=>{const{withAlpha:c,channels:i,getChannelProps:o,styles:d}=W(),C={display:"grid",gridTemplateColumns:`repeat(${c?"4":"3"}, 1fr)`,...d.channels};return n.jsx(D.div,{ref:l,className:H("ui-color-selector__channels",s),__css:C,...t,children:i.map(({label:b,space:y,value:g,min:x,max:R})=>n.jsx(Qe,{channelLabel:b,...o({...u,space:y,value:g,min:x,max:R})},b))})}),Qe=O(({className:s,channelLabel:u,...t},l)=>{const c=p.useId();let{size:i,disabled:o,readOnly:d,styles:C}=W();i==="full"&&(i="lg");const b={...C.channel};return n.jsxs(D.div,{className:H("ui-color-selector__channel",s),children:[u?n.jsx(D.label,{htmlFor:c,style:{cursor:o?"not-allowed":void 0},__css:{display:"block",pointerEvents:d?"none":void 0,...C.channelLabel},children:u}):null,n.jsx(Fe,{ref:l,id:c,size:i,__css:b,...t})]})}),Xe=O(({className:s,swatchesLabel:u,swatches:t,swatchesContainerProps:l,swatchProps:c,swatchesColumns:i,...o},d)=>{const{getSwatchProps:C,readOnly:b,styles:y}=W(),g={display:"grid",gridTemplateColumns:je(i,x=>x!=null?`repeat(${x}, minmax(0, 1fr))`:void 0),...y.swatches};return t!=null&&t.length?n.jsxs(D.div,{...l,children:[u?n.jsx(D.p,{className:"ui-color-selector__swatches__label",__css:{...y.swatchesLabel},children:u}):null,n.jsx(D.div,{ref:d,className:H("ui-color-selector__swatches",s),__css:g,...o,children:t.map(x=>n.jsx(ue,{as:"button",__css:{boxSize:"100%",pointerEvents:b?"none":void 0,...y.swatch},...C({color:x,...c})},x))})]}):null}),fs=O(({size:s,...u},t)=>{const[l,c]=Ie("ColorSelector",{size:s,...u}),{className:i,children:o,withResult:d=!0,withPicker:C=!0,withChannel:b=!0,swatches:y,swatchesColumns:g=7,inputProps:x,withEyeDropper:R,eyeDropperRef:v,eyeDropperProps:f,saturationSliderRef:S,saturationSliderProps:L,hueSliderRef:G,hueSliderProps:q,alphaSliderRef:U,alphaSliderProps:X,swatchesLabel:Z,swatchProps:V,swatchesProps:J,channelsProps:m,channelProps:P,...I}=Ae(c),{value:B,getContainerProps:A,getInputProps:$,getSaturationSliderProps:E,...N}=Ge(I),M={display:"flex",flexDirection:"column",...l.container};return n.jsx(ze,{value:{styles:l,size:s,value:B,...N},children:n.jsxs(D.div,{ref:t,className:H("ui-color-selector",i),__css:M,...A(),children:[n.jsx(D.input,{...$(x,t)}),C?n.jsx(We,{size:s,className:"ui-color-selector__saturation-slider",__css:{...l.saturationSlider},...E(L,S)}):null,C?n.jsx(Je,{withResult:d,withEyeDropper:R,eyeDropperRef:v,eyeDropperProps:f,hueSliderRef:G,hueSliderProps:q,alphaSliderRef:U,alphaSliderProps:X}):null,C&&b?n.jsx(Ke,{channelProps:P,...m}):null,n.jsx(Xe,{swatchesLabel:Z,swatches:y,swatchesColumns:g,swatchProps:V,...J}),we(o,{value:B})]})})});export{fs as C,Ue as E,$e as u};
