import{j as F}from"./jsx-runtime-CfatFE5O.js";import{C as pe}from"./close-button-BPWfu35m.js";import{f as ve}from"./forward-ref-D13m8o2p.js";import{A as ge,a as U,h as u,I as Pe,aq as N,a3 as R,c as ee,g as Ce,at as ye,b as be,a4 as he}from"./factory-Bqmz9C5P.js";import{s as S}from"./slide-fade-BhjlDBiO.js";import{s as xe}from"./scale-fade-13h1cMen.js";import{m as Re}from"./forward-ref-2BKBy0Yi.js";import{m as Be}from"./factory-Cbq3E2qU.js";import{r as t}from"./index-ClcD9ViR.js";import{b as _e}from"./index-CjWtGFYg.js";import{u as Te,b as we}from"./index-DcJSUYRC.js";import{u as Ee,a as Fe,b as ke}from"./index-Bqglt4Z4.js";import{u as Me}from"./index-C6P-3PHl.js";import{a as De}from"./use-component-style-D7fUVUlo.js";import{o as Oe}from"./theme-provider-Dit74geM.js";const[Ae,V]=ge({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),oe=d=>{const[f,n]=De("Popover",d),{animation:h="scale",autoFocus:B=!0,children:p,closeDelay:v=200,closeOnBlur:a=!0,closeOnButton:L=!0,closeOnEsc:_=!0,duration:K,initialFocusRef:X,isLazy:k,lazy:Y=k,lazyBehavior:M="unmount",openDelay:D=200,relatedRef:C,restoreFocus:O=!0,trigger:c="click",...W}=Oe(n),y=t.useId(),{open:o,onClose:r,onOpen:x,onToggle:A}=Te(n),T=t.useRef(null),s=t.useRef(null),j=t.useRef(null),G=t.useRef(null),g=t.useRef(null),{present:re,onAnimationComplete:se}=_e({ref:g,open:o}),b=t.useRef(void 0),q=t.useRef(void 0),w=t.useRef(!1),J=t.useRef(!1),{forceUpdate:Q,referenceRef:I,transformOrigin:Z,getPopperProps:ie}=Me({...W,enabled:o});o&&(J.current=!0),t.useEffect(()=>()=>{b.current&&clearTimeout(b.current),q.current&&clearTimeout(q.current)},[]),Ee({ref:s,enabled:o}),Fe(g,{focusRef:s,shouldFocus:O&&(c==="click"||c==="contextmenu"),visible:o}),ke(g,{focusRef:X,shouldFocus:B&&(c==="click"||c==="contextmenu"),visible:o});const ue=we({enabled:Y,isSelected:re,mode:M,wasSelected:J.current}),ae=t.useCallback((e={},E=null)=>{var l,P;const i={id:y,"aria-describedby":(l=G.current)==null?void 0:l.id,"aria-hidden":!o,"aria-labelledby":(P=j.current)==null?void 0:P.id,role:"dialog",...e,ref:U(g,E),style:{...e.style,transformOrigin:Z},tabIndex:-1,onBlur:u(e.onBlur,m=>{const H=N(m),fe=R(g.current,H),me=R(s.current,H),de=C!=null&&C.current?R(C.current,H):!1;o&&a&&(!fe&&!me&&!de)&&r()}),onKeyDown:u(e.onKeyDown,m=>{_&&m.key==="Escape"&&r()})};return c==="hover"&&(i.onMouseEnter=u(e.onMouseEnter,()=>{w.current=!0}),i.onMouseLeave=u(e.onMouseLeave,m=>{m.nativeEvent.relatedTarget!==null&&(w.current=!1,a&&setTimeout(r,v))})),i},[v,a,_,o,r,Z,c,C,y]),$=t.useCallback(e=>{T.current==null&&I(e)},[I]),ce=t.useCallback((e={},E=null)=>{const i={"aria-controls":o?y:void 0,"aria-expanded":o,role:"button",...e,ref:U(s,E,$)};return c==="click"&&(i.onClick=u(e.onClick,A),i.onBlur=u(e.onBlur,l=>{const P=N(l),m=!R(g.current,P);o&&a&&m&&r()})),c==="contextmenu"&&(i.onContextMenu=u(e.onContextMenu,l=>{l.preventDefault(),x()}),i.onBlur=u(e.onBlur,l=>{const P=N(l),m=!R(g.current,P);o&&a&&m&&r()})),c==="hover"&&(i.onFocus=u(e.onFocus,()=>{b.current===void 0&&x()}),i.onBlur=u(e.onBlur,l=>{const P=N(l),m=!R(g.current,P);o&&a&&m&&r()}),i.onKeyDown=u(e.onKeyDown,l=>{l.key==="Escape"&&r()}),i.onMouseEnter=u(e.onMouseEnter,()=>{w.current=!0,b.current=window.setTimeout(x,D)}),i.onMouseLeave=u(e.onMouseLeave,()=>{w.current=!1,b.current&&(clearTimeout(b.current),b.current=void 0),q.current=window.setTimeout(()=>{w.current||r()},v)})),i},[v,a,o,$,r,x,A,D,c,y]),le=t.useCallback((e={},E=null)=>({...e,ref:U(E,T,I)}),[T,I]);return F.jsx(Ae,{value:{id:y,animation:h,bodyRef:G,closeOnButton:L,duration:K,forceUpdate:Q,headerRef:j,open:o,shouldRenderContent:ue,styles:f,getAnchorProps:le,getPopoverProps:ae,getPopperProps:ie,getTriggerProps:ce,onAnimationComplete:se,onClose:r},children:Pe(p,{forceUpdate:Q,open:o,onClose:r})})};oe.displayName="Popover";oe.__ui__="Popover";const z=ve(({onClick:d,...f},n)=>{const{id:h,styles:B,onClose:p}=V(),v={position:"absolute",...B.closeButton};return F.jsx(pe,{ref:n,className:ee("ui-popover__close-button"),size:"sm","aria-controls":h,"aria-label":"Close popover",onClick:u(d,a=>{a.stopPropagation(),p==null||p()}),__css:v,...f})});z.displayName="PopoverCloseButton";z.__ui__="PopoverCloseButton";const je=(d="scale",f)=>{const n={duration:f,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(d){case"scale":return{...xe,custom:{...n,scale:.95}};case"top":return{...S,custom:{...n,offsetX:0,offsetY:-16}};case"right":return{...S,custom:{...n,offsetX:16,offsetY:0}};case"left":return{...S,custom:{...n,offsetX:-16,offsetY:0}};case"bottom":return{...S,custom:{...n,offsetX:0,offsetY:16}}}},te=Re(({className:d,children:f,maxW:n,maxWidth:h=n,minW:B,minWidth:p=B,w:v,width:a=v,z:L,zIndex:_=L,containerProps:K,__css:X,...k},Y)=>{const{animation:M,closeOnButton:D,duration:C,open:O,shouldRenderContent:c,styles:W,getPopoverProps:y,getPopperProps:o,onAnimationComplete:r}=V();if(!c)return null;const x=Ce(f),[A,...T]=ye(x,z),s=X??W.container??{},j={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...s};return a??(a=s.width??s.w),p??(p=s.minWidth??s.minW),h??(h=s.maxWidth??s.maxW),_??(_=s.zIndex??s.z),F.jsx(be.div,{...o({style:{visibility:O?"visible":"hidden"}}),className:"ui-popover",maxWidth:h,minWidth:p,outline:"none",width:a,zIndex:_,...K,children:F.jsxs(Be.section,{className:ee("ui-popover__content",d),...M!=="none"?je(M,C):{},...y(k,Y),animate:O?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:he(r,k.onAnimationComplete),__css:j,children:[A??(D?F.jsx(z,{}):null),T]})})});te.displayName="PopoverContent";te.__ui__="PopoverContent";const ne=({children:d})=>{const f=t.Children.only(d),{getTriggerProps:n}=V();return t.cloneElement(f,n(f.props,f.ref))};ne.displayName="PopoverTrigger";ne.__ui__="PopoverTrigger";export{oe as P,ne as a,te as b,z as c,V as u};
